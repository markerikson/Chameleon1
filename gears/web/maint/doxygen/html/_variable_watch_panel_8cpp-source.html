<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Chameleon: VariableWatchPanel.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>VariableWatchPanel.cpp</h1><a href="_variable_watch_panel_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 <span class="comment">// Name:        VariableWatchPanel.cpp</span>
00003 <span class="comment">// Purpose:     </span>
00004 <span class="comment">// Author:      </span>
00005 <span class="comment">// Modified by: </span>
00006 <span class="comment">// Created:     03/29/04 21:43:35</span>
00007 <span class="comment">// RCS-ID:      </span>
00008 <span class="comment">// Copyright:   </span>
00009 <span class="comment">// Licence:     </span>
00011 <span class="comment"></span>
00012 <span class="preprocessor">#ifdef __GNUG__</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#pragma implementation "VariableWatchPanel.h"</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00015 <span class="preprocessor"></span>
00016 <span class="comment">// For compilers that support precompilation, includes "wx/wx.h".</span>
00017 <span class="preprocessor">#include "wx/wxprec.h"</span>
00018 
00019 <span class="preprocessor">#ifdef __BORLANDC__</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#pragma hdrstop</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00022 <span class="preprocessor"></span>
00025 
00026 <span class="preprocessor">#include &lt;wx/textdlg.h&gt;</span>
00027 
00028 <span class="preprocessor">#include "<a class="code" href="_variable_watch_panel_8h.html">VariableWatchPanel.h</a>"</span>
00029 <span class="comment">//#include "AddVariableWatch.h"</span>
00030 <span class="preprocessor">#include "../ChameleonWindow.h"</span>
00031 <span class="preprocessor">#include "../../common/fixvsbug.h"</span>
00032 
00033 
00036 
00041 IMPLEMENT_CLASS( <a class="code" href="class_variable_watch_panel.html">VariableWatchPanel</a>, wxPanel )
00042 
00043 
00047 BEGIN_EVENT_TABLE( <a class="code" href="class_variable_watch_panel.html">VariableWatchPanel</a>, wxPanel )
00048 
00049 
00050     EVT_BUTTON( ID_ADDWATCH, VariableWatchPanel::OnAddwatchClick )
00051 
00052     EVT_BUTTON( ID_REMOVEWATCH, VariableWatchPanel::OnRemovewatchClick )
00053 
00054     EVT_BUTTON( ID_CLEARALLWATCHES, VariableWatchPanel::OnClearallwatchesClick )
00055 
00056 
00057 
00058 END_EVENT_TABLE()
00059 
00060 
<a name="l00065"></a><a class="code" href="class_variable_watch_panel.html#a0">00065</a> <a class="code" href="class_variable_watch_panel.html#a0">VariableWatchPanel::VariableWatchPanel</a>( )
00066 {
00067 }
00068 
<a name="l00069"></a><a class="code" href="class_variable_watch_panel.html#a1">00069</a> <a class="code" href="class_variable_watch_panel.html#a0">VariableWatchPanel::VariableWatchPanel</a>( wxWindow* parent, <a class="code" href="class_chameleon_window.html">ChameleonWindow</a>* mainframe, wxWindowID <span class="keywordtype">id</span>, <span class="keyword">const</span> wxPoint&amp; pos, <span class="keyword">const</span> wxSize&amp; size, <span class="keywordtype">long</span> style )
00070 {
00071     <a class="code" href="class_variable_watch_panel.html#a2">Create</a>(parent, <span class="keywordtype">id</span>, pos, size, style);
00072 
00073     m_mainFrame = mainframe;
00074 
00075     wxListItem itemCol;
00076     itemCol.m_mask = wxLIST_MASK_TEXT | wxLIST_MASK_WIDTH;
00077     itemCol.m_text = _T(<span class="stringliteral">"Name"</span>);
00078     itemCol.m_width = 120;
00079     m_list-&gt;InsertColumn(0, itemCol);
00080     itemCol.m_text = _T(<span class="stringliteral">"Type"</span>);
00081     itemCol.m_width = 80;
00082     m_list-&gt;InsertColumn(1, itemCol);
00083     itemCol.m_text = _T(<span class="stringliteral">"Value"</span>);
00084     itemCol.m_width = 400;
00085     m_list-&gt;InsertColumn(2, itemCol);
00086 }
00087 
<a name="l00092"></a><a class="code" href="class_variable_watch_panel.html#a2">00092</a> <span class="keywordtype">bool</span> <a class="code" href="class_variable_watch_panel.html#a2">VariableWatchPanel::Create</a>( wxWindow* parent, wxWindowID <span class="keywordtype">id</span>, <span class="keyword">const</span> wxPoint&amp; pos, <span class="keyword">const</span> wxSize&amp; size, <span class="keywordtype">long</span> style )
00093 {
00095     m_list = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00097 
00099     SetExtraStyle(wxWS_EX_BLOCK_EVENTS);
00100     wxPanel::Create( parent, <span class="keywordtype">id</span>, pos, size, style );
00101 
00102     <a class="code" href="class_variable_watch_panel.html#a3">CreateControls</a>();
00103     Centre();
00105     <span class="keywordflow">return</span> TRUE;
00106 }
00107 
<a name="l00112"></a><a class="code" href="class_variable_watch_panel.html#a3">00112</a> <span class="keywordtype">void</span> <a class="code" href="class_variable_watch_panel.html#a3">VariableWatchPanel::CreateControls</a>()
00113 {    
00115 
00116     <a class="code" href="class_variable_watch_panel.html">VariableWatchPanel</a>* item1 = <span class="keyword">this</span>;
00117 
00118     wxBoxSizer* item2 = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
00119     item1-&gt;SetSizer(item2);
00120     item1-&gt;SetAutoLayout(TRUE);
00121 
00122     wxListCtrl* item3 = <span class="keyword">new</span> wxListCtrl( item1, <a class="code" href="_remote_file_dialog_8h.html#a7">ID_LISTCTRL</a>, wxDefaultPosition, wxDefaultSize, wxLC_REPORT|wxLC_SINGLE_SEL|wxLC_HRULES|wxSIMPLE_BORDER );
00123     m_list = item3;
00124     item2-&gt;Add(item3, 1, wxGROW, 5);
00125 
00126     wxBoxSizer* item4 = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
00127     item2-&gt;Add(item4, 0, wxALIGN_LEFT|wxLEFT|wxRIGHT, 5);
00128 
00129     wxButton* item5 = <span class="keyword">new</span> wxButton( item1, <a class="code" href="_variable_watch_panel_8h.html#a7">ID_ADDWATCH</a>, _(<span class="stringliteral">"Add watch"</span>), wxDefaultPosition, wxSize(80, -1), 0 );
00130     item4-&gt;Add(item5, 0, wxALIGN_CENTER_VERTICAL|wxALL, 5);
00131 
00132     wxButton* item6 = <span class="keyword">new</span> wxButton( item1, <a class="code" href="_variable_watch_panel_8h.html#a8">ID_REMOVEWATCH</a>, _(<span class="stringliteral">"Remove watch"</span>), wxDefaultPosition, wxSize(80, -1), 0 );
00133     item4-&gt;Add(item6, 0, wxALIGN_CENTER_VERTICAL|wxALL, 5);
00134 
00135     wxButton* item7 = <span class="keyword">new</span> wxButton( item1, <a class="code" href="_variable_watch_panel_8h.html#a9">ID_CLEARALLWATCHES</a>, _(<span class="stringliteral">"Clear watches"</span>), wxDefaultPosition, wxDefaultSize, 0 );
00136     item4-&gt;Add(item7, 0, wxALIGN_CENTER_VERTICAL|wxALL, 5);
00137 
00139 }
00140 
<a name="l00145"></a><a class="code" href="class_variable_watch_panel.html#a4">00145</a> <span class="keywordtype">void</span> <a class="code" href="class_variable_watch_panel.html#a4">VariableWatchPanel::OnAddwatchClick</a>( wxCommandEvent&amp; event )
00146 {
00147     <span class="comment">// Insert custom code here</span>
00148     event.Skip();
00149 
00150     <a class="code" href="class_variable_watch_panel.html#a7">AddWatch</a>();
00151 
00152     
00153 }
00154 
<a name="l00159"></a><a class="code" href="class_variable_watch_panel.html#a5">00159</a> <span class="keywordtype">void</span> <a class="code" href="class_variable_watch_panel.html#a5">VariableWatchPanel::OnRemovewatchClick</a>( wxCommandEvent&amp; event )
00160 {
00161     <span class="comment">// Insert custom code here</span>
00162     event.Skip();
00163 
00164     <a class="code" href="class_variable_watch_panel.html#a8">RemoveWatch</a>();
00165 }
00166 
<a name="l00171"></a><a class="code" href="class_variable_watch_panel.html#e0">00171</a> <span class="keywordtype">bool</span> <a class="code" href="class_variable_watch_panel.html#e0">VariableWatchPanel::ShowToolTips</a>()
00172 {
00173     <span class="keywordflow">return</span> TRUE;
00174 }
00175 
<a name="l00184"></a><a class="code" href="class_variable_watch_panel.html#a7">00184</a> <span class="keywordtype">void</span> <a class="code" href="class_variable_watch_panel.html#a7">VariableWatchPanel::AddWatch</a>()
00185 {
00186     wxString varName = wxGetTextFromUser(<span class="stringliteral">"Variable name to watch:"</span>, <span class="stringliteral">"Add Variable Watch"</span>);
00187 
00188     <span class="comment">//AddVariableWatchDialog avwd(this);</span>
00189 
00190     <span class="comment">//int result = avwd.ShowModal();</span>
00191     
00192 
00193 
00194     <span class="comment">//if(result == wxOK)</span>
00195     <span class="keywordflow">if</span>(varName != wxEmptyString)
00196     {
00197         <a class="code" href="classwx_debug_event.html">wxDebugEvent</a> dbg;
00198 
00199         dbg.SetId(<a class="code" href="datastructures_8h.html#a149a84">ID_DEBUG_ADD_WATCH</a>);
00200 
00201         <span class="comment">/*</span>
00202 <span class="comment">        //wxString varName = avwd.GetVariableName();</span>
00203 <span class="comment">        //wxString funcName = avwd.GetFunctionName();</span>
00204 <span class="comment">        //wxString className = wxEmptyString;</span>
00205 <span class="comment"></span>
00206 <span class="comment">        if(avwd.FunctionInClass())</span>
00207 <span class="comment">        {</span>
00208 <span class="comment">            className = avwd.GetClassName();</span>
00209 <span class="comment">        }</span>
00210 <span class="comment">        */</span>
00211 
00212         wxArrayString vars;
00213         vars.Add(varName);
00214         dbg.<a class="code" href="classwx_debug_event.html#a3">SetVariableNames</a>(vars);
00215         <span class="comment">//dbg.SetFunctionName(funcName);</span>
00216         <span class="comment">//dbg.SetClassName(className);</span>
00217         m_mainFrame-&gt;AddPendingEvent(dbg);      
00218 
00219         m_list-&gt;InsertItem(m_list-&gt;GetItemCount(), varName);
00220     }
00221 }
00222 
<a name="l00231"></a><a class="code" href="class_variable_watch_panel.html#a8">00231</a> <span class="keywordtype">void</span> <a class="code" href="class_variable_watch_panel.html#a8">VariableWatchPanel::RemoveWatch</a>()
00232 {
00233     <span class="keywordflow">if</span>(m_list-&gt;GetSelectedItemCount() &gt; 0)
00234     {
00235         <span class="keywordtype">int</span> num = -1;
00236         <span class="keywordtype">int</span> index = m_list-&gt;GetNextItem(num, wxLIST_NEXT_ALL,   wxLIST_STATE_SELECTED);
00237 
00238         wxListItem item;
00239         item.SetId(index);      
00240         item.m_mask = wxLIST_MASK_TEXT;
00241 
00242         item.m_col = 0;
00243         m_list-&gt;GetItem(item);
00244         wxString name = item.m_text;
00245 
00246         <a class="code" href="classwx_debug_event.html">wxDebugEvent</a> dbg;
00247 
00248         dbg.SetId(<a class="code" href="datastructures_8h.html#a149a85">ID_DEBUG_REMOVE_WATCH</a>);
00249         wxArrayString vars;
00250         vars.Add(name);
00251         dbg.<a class="code" href="classwx_debug_event.html#a3">SetVariableNames</a>(vars);
00252         m_mainFrame-&gt;AddPendingEvent(dbg);
00253 
00254         m_list-&gt;DeleteItem(index);
00255     }
00256 }
00257 
<a name="l00268"></a><a class="code" href="class_variable_watch_panel.html#a10">00268</a> <span class="keywordtype">void</span> <a class="code" href="class_variable_watch_panel.html#a10">VariableWatchPanel::UpdateVariableInfo</a>(<a class="code" href="classwx_debug_event.html">wxDebugEvent</a> event)
00269 {
00270     wxArrayString names = event.<a class="code" href="classwx_debug_event.html#a14">GetVariableNames</a>();
00271     wxArrayString values = event.<a class="code" href="classwx_debug_event.html#a15">GetVariableValues</a>();
00272     wxArrayString types = event.<a class="code" href="classwx_debug_event.html#a16">GetVariableTypes</a>();
00273 
00274     <span class="comment">//wxSortedArrayString sortedNames(names);</span>
00275 
00276     <span class="comment">//m_list-&gt;DeleteAllItems();</span>
00277 
00278     wxListItem textColorItem;
00279     textColorItem.SetTextColour(wxColour(<span class="stringliteral">"black"</span>));
00280     textColorItem.m_col = 2;
00281 
00282     <span class="comment">// reset all variable value text to black</span>
00283     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; m_list-&gt;GetItemCount(); i++)
00284     {
00285         textColorItem.m_itemId = i;
00286         <span class="comment">//m_list-&gt;SetItem(textColorItem);</span>
00287     }
00288 
00289     textColorItem.SetTextColour(wxColour(<span class="stringliteral">"red"</span>));
00290 
00291     wxListItem retrievalItem;
00292     retrievalItem.m_mask = wxLIST_MASK_TEXT;
00293     retrievalItem.m_col = 1;
00294 
00295     <span class="comment">// update any new/changed values</span>
00296     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (<span class="keywordtype">int</span>)names.GetCount(); i++)
00297     {
00298         wxString name = names[i];
00299         <span class="keywordtype">int</span> idx = names.Index(name);
00300         wxString value = values[idx];
00301         wxString type = types[idx];
00302 
00303         <span class="keywordtype">int</span> nameLineNum = m_list-&gt;FindItem(-1, name);       
00304         
00305         <span class="comment">// found the item's name</span>
00306         <span class="keywordflow">if</span>(nameLineNum &gt; -1)
00307         {
00308             <span class="comment">//retrievalItem.SetId(nameLineNum);</span>
00309             <span class="comment">//retrievalItem.m_col = 1;</span>
00310             <span class="comment">//m_list-&gt;GetItem(retrievalItem);</span>
00311             <span class="comment">//wxString listedType = retrievalItem.m_text;</span>
00312 
00313             m_list-&gt;SetItem(nameLineNum, 1, type);
00314             retrievalItem.m_col = 2;
00315             m_list-&gt;GetItem(retrievalItem);
00316 
00317             wxString listedValue = retrievalItem.m_text;
00318 
00319             <span class="keywordflow">if</span>(listedValue != value)
00320             {
00321                 m_list-&gt;SetItem(nameLineNum, 2, value);
00322                 <span class="comment">//m_list-&gt;SetItem(textColorItem);</span>
00323             }               
00324         }
00325     }
00326 }
00327 
<a name="l00336"></a><a class="code" href="class_variable_watch_panel.html#a9">00336</a> <span class="keywordtype">void</span> <a class="code" href="class_variable_watch_panel.html#a9">VariableWatchPanel::ClearVariableValues</a>()
00337 {
00338     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; m_list-&gt;GetItemCount(); i++)
00339     {
00340         m_list-&gt;SetItem(i, 2, wxEmptyString);
00341     }
00342 }
00343 
00348 
00349 
00350 
00351 
00352 
00353 
00354 
00355 
00356 
00357 
<a name="l00358"></a><a class="code" href="class_variable_watch_panel.html#a6">00358</a> <span class="keywordtype">void</span> <a class="code" href="class_variable_watch_panel.html#a6">VariableWatchPanel::OnClearallwatchesClick</a>( wxCommandEvent&amp; event )
00359 {
00360     <span class="comment">// Insert custom code here</span>
00361     event.Skip();
00362 
00363     <span class="keywordtype">int</span> numItems = m_list-&gt;GetItemCount();
00364 
00365     wxListItem selectionItem;
00366     selectionItem.m_mask = wxLIST_MASK_STATE;
00367     selectionItem.m_stateMask = wxLIST_STATE_SELECTED;
00368     selectionItem.m_state = wxLIST_STATE_SELECTED;
00369     selectionItem.SetId(0);
00370 
00371     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numItems; i++)
00372     {
00373         m_list-&gt;SetItem(selectionItem);
00374         <a class="code" href="class_variable_watch_panel.html#a8">RemoveWatch</a>();
00375     }
00376 }
00377 
00378 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 28 16:45:38 2004 for Chameleon by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
