<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Chameleon: cham_db.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>cham_db.cpp</h1><a href="cham__db_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*****************************************************************\</span>
00002 <span class="comment">*Wrapper Code file</span>
00003 <span class="comment">*</span>
00004 <span class="comment">*author: Ben Carhart</span>
00005 <span class="comment">*date started: 1/11/04</span>
00006 <span class="comment">*date finished: 4/20/04</span>
00007 <span class="comment">*</span>
00008 <span class="comment">*description: Code for the implementation of a wrapper for GDB</span>
00009 <span class="comment">*revisions:</span>
00010 <span class="comment">*BSC-02/13/04-&gt; Removed all constructors &amp; added 4 private func.</span>
00011 <span class="comment">*               to aid in general stuff.</span>
00012 <span class="comment">*BSC-02/27/04-&gt; Added Dave Czechowski's ASYNC code which rendered</span>
00013 <span class="comment">*               much of my code obsolete.  Backed up files &amp;</span>
00014 <span class="comment">*               deleted all commented code to start over.  :(</span>
00015 <span class="comment">*BSC-02/29/04-&gt; Added carriage returns [\r] on all my commands. I</span>
00016 <span class="comment">*               also added a soft-error-reset as well as a flush-</span>
00017 <span class="comment">*               buffer function to clear out unwanted input.</span>
00018 <span class="comment">*BSC-03/9/04-&gt; Gosh I added so much i can't list it here.  I added</span>
00019 <span class="comment">*              a class-specific status variable, new arrays, a few</span>
00020 <span class="comment">*              new functions... re-did a few functions, changed</span>
00021 <span class="comment">*              some logic.  I feel like I'm debugging without</span>
00022 <span class="comment">*              compiling!  AUGH!</span>
00023 <span class="comment">*BSC-03/19/04-&gt;Alright... i'm adapting my code into Dave's window</span>
00024 <span class="comment">*              API so I can test it.  All portions with "cout"</span>
00025 <span class="comment">*              debug statements have been altered &amp; "dave's code"</span>
00026 <span class="comment">*              shows obvious places i've moded.</span>
00027 <span class="comment">*BSC-04/03/04-&gt;So much has changed that it's not funny.  Debug</span>
00028 <span class="comment">*              event code has been changed to work with projects.</span>
00029 <span class="comment">*BSC-04/20/04-&gt;I somehow broke my code in the last update.  My</span>
00030 <span class="comment">*              comment here was lost as well.  So I can say we've</span>
00031 <span class="comment">*              updated networking and added run-to-cursor ability.</span>
00032 <span class="comment">*              Also user I/O is in here (sorta).  Hopefully this</span>
00033 <span class="comment">*              version will run...</span>
00034 <span class="comment">*BSC-04/23/04-&gt;Doxygen Update.</span>
00035 <span class="comment">\*****************************************************************/</span>
00036 
00037 
00038 <span class="preprocessor">#include "<a class="code" href="cham__db_8h.html">cham_db.h</a>"</span>
00039 <span class="preprocessor">#include "../common/ProjectInfo.h"</span>
00040 <span class="preprocessor">#include &lt;wx/wfstream.h&gt;</span>
00041 <span class="preprocessor">#include &lt;wx/RegEx.h&gt;</span>
00042 
00043 <span class="preprocessor">#include &lt;wx/arrimpl.cpp&gt;</span> <span class="comment">// this is a magic incantation which must be done!</span>
00044 <a class="code" href="cham__db_8cpp.html#a0">WX_DEFINE_OBJARRAY</a>(VariableInfoArray);
00045 
00046 
00047 <span class="preprocessor">#include "../common/debug.h"</span>
00048 
00049 <span class="preprocessor">#ifdef _DEBUG</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#define new DEBUG_NEW</span>
00051 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00052 <span class="preprocessor"></span>
00053 <span class="comment">//event handling</span>
00054 BEGIN_EVENT_TABLE(<a class="code" href="class_debugger.html">Debugger</a>, wxEvtHandler)
00055     <a class="code" href="chameleonprocessevent_8h.html#a0">EVT_PROCESS_ENDED</a>(Debugger::onProcessTermEvent)
00056     <a class="code" href="chameleonprocessevent_8h.html#a1">EVT_PROCESS_STDOUT</a>(Debugger::onProcessOutputEvent)
00057     <a class="code" href="chameleonprocessevent_8h.html#a2">EVT_PROCESS_STDERR</a>(Debugger::onProcessErrOutEvent)
00058 
00059     <a class="code" href="_debug_event_8h.html#a0">EVT_DEBUG</a>(Debugger::onDebugEvent)
00060 END_EVENT_TABLE()
00061 
00062 
00063 
00064 
00065 
00066 
00067 
00068 
00069 
00070 
00071 
<a name="l00072"></a><a class="code" href="class_debugger.html#a0">00072</a> <a class="code" href="class_debugger.html#a0">Debugger::Debugger</a>(<a class="code" href="class_networking.html">Networking</a>* networking, wxEvtHandler* pointer)
00073 {
00074     <a class="code" href="class_debugger.html#d4">flushPrivateVar</a>();
00075     <a class="code" href="class_debugger.html#r23">varCount</a> = 0;
00076     <a class="code" href="class_debugger.html#r32">m_numberOfDebugEvents</a> = 0;
00077 
00078     <a class="code" href="class_debugger.html#r29">myEvent</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00079 
00080     <a class="code" href="class_debugger.html#r30">guiPointer</a> = pointer;
00081     <a class="code" href="class_debugger.html#r1">procLives</a> = <span class="keyword">false</span>;
00082     <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>;
00083     <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a19">STOP</a>;
00084     <a class="code" href="class_debugger.html#r27">myConnection</a> = networking;
00085 
00086     <span class="comment">//reg-Ex for Variable watching</span>
00087     <span class="comment">//------</span>
00088     <span class="comment">// ints - "$n = val"</span>
00089     <span class="comment">// look for a space first, to make sure we don't grab the GDB print number instead</span>
00090     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"int"</span>] = <span class="stringliteral">" ([[:digit:]]+)"</span>;
00091 
00092     <span class="comment">// ints &amp; - "$n = (int &amp;) val"</span>
00093     <span class="comment">//note: is this even needed??</span>
00094     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"&amp;"</span>] = <span class="stringliteral">".+ ([[:digit:]]+)"</span>;
00095 
00096     <span class="comment">// ints * - "$n = val"</span>
00097     <span class="comment">//TODO: Eliminate this</span>
00098     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"int*"</span>] = <span class="stringliteral">" ([[:digit:]]+)"</span>;
00099     
00100     <span class="comment">// double-"$n = val.val"</span>
00101     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"double"</span>] = <span class="stringliteral">" ([[:digit:]]+(\\.[[:digit:]]+)?)"</span>;
00102 
00103     <span class="comment">// char[]-"$n = val 'char'"</span>
00104     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"char"</span>] = <span class="stringliteral">"[[:digit:]]+ '(.*?)'"</span>;
00105     
00106     <span class="comment">// char - "$n = "text""</span>
00107     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"char[]"</span>] = <span class="stringliteral">"\"(.*)\""</span>;<span class="comment">//"[[:digit:]]+ '([[:alnum:]]+)'";</span>
00108     
00109     <span class="comment">// array- "$n = {val, val...}"</span>
00110     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"array"</span>] = <span class="stringliteral">"({.*})\\r\\n$"</span>;
00111     
00112     <span class="comment">// str#2- "$n = "text"" (same as [char])</span>
00113     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"string"</span>] = <span class="stringliteral">"\"(.*)\""</span>;
00114 
00115     <span class="comment">// obj -  "$n = {varName = val, varName = val, ..} (varName can be of any listed type...)</span>
00116     <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"class"</span>] = <span class="stringliteral">"({.*})\\r\\n$"</span>;
00117 }
00118 <span class="comment">//end constructors</span>
00119 
<a name="l00127"></a><a class="code" href="class_debugger.html#a1">00127</a> <a class="code" href="class_debugger.html#a1">Debugger::~Debugger</a>()
00128 {
00129     <span class="comment">//initial stuff to cleanly exit (sorta)</span>
00130     <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
00131 
00132     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r29">myEvent</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
00133     {
00134         <span class="keyword">delete</span> <a class="code" href="class_debugger.html#r29">myEvent</a>;
00135     }
00136 
00137     <a class="code" href="class_debugger.html#d4">flushPrivateVar</a>();
00138     <a class="code" href="class_debugger.html#r24">m_varInfo</a>.Clear();
00139 }<span class="comment">//end ~Debugger</span>
00140 
<a name="l00151"></a><a class="code" href="class_debugger.html#a2">00151</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a2">Debugger::onDebugEvent</a>(<a class="code" href="classwx_debug_event.html">wxDebugEvent</a> &amp;event)
00152 {
00153     <span class="keywordtype">int</span> eventCommand = event.GetId();
00154 
00155     <span class="comment">/* We can only accept certain types of events while stopped/paused.</span>
00156 <span class="comment">     * If we're running and we get an unacceptable event type for the current</span>
00157 <span class="comment">     * state, we put it back on the event queue.  We use a counter with a </span>
00158 <span class="comment">     * completely arbitrary number (say, 50) to keep us from going into an</span>
00159 <span class="comment">     * infinite loop.  If we've received events 50 times without actually</span>
00160 <span class="comment">     * processing one, then we'll just pitch it and return.  This combination</span>
00161 <span class="comment">     * prevents stuff like getting stuck after repeatedly pressing Step too fast.</span>
00162 <span class="comment">     */</span>
00163     <span class="keywordflow">if</span>(eventCommand != <a class="code" href="datastructures_8h.html#a149a75">ID_DEBUG_STOP</a> &amp;&amp;
00164         eventCommand != <a class="code" href="datastructures_8h.html#a149a73">ID_DEBUG_START</a> &amp;&amp; 
00165         eventCommand != <a class="code" href="datastructures_8h.html#a149a84">ID_DEBUG_ADD_WATCH</a> &amp;&amp;
00166         eventCommand != <a class="code" href="datastructures_8h.html#a149a85">ID_DEBUG_REMOVE_WATCH</a>)
00167     {
00168         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> != <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a> &amp;&amp;
00169             <a class="code" href="class_debugger.html#r4">status</a> != <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>)
00170         {
00171             <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r32">m_numberOfDebugEvents</a> &lt; 50)
00172             {
00173                 this-&gt;AddPendingEvent(event);
00174             }
00175             
00176             <a class="code" href="class_debugger.html#r32">m_numberOfDebugEvents</a>++;
00177             <span class="keywordflow">return</span>;
00178         }
00179     }
00180     <a class="code" href="class_debugger.html#r32">m_numberOfDebugEvents</a> = 0;
00181 
00182     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r29">myEvent</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
00183     {
00184         <span class="keyword">delete</span> <a class="code" href="class_debugger.html#r29">myEvent</a>;
00185     }
00186     <a class="code" href="class_debugger.html#r29">myEvent</a> = (<a class="code" href="classwx_debug_event.html">wxDebugEvent</a>*)event.<a class="code" href="classwx_debug_event.html#a1">Clone</a>();
00187     <span class="comment">//all the variables i need here:</span>
00188     
00189     <span class="keywordtype">int</span> eventLineNum;
00190     
00191     wxArrayString gui_var_names;
00192     wxString varName, funcName, className;
00193     
00194     wxArrayInt breakpointLines;
00195 
00196     FileBreakpointHash breakpointList;
00197     
00198     wxString tmp;
00199     wxString firstFile;
00200     wxString sendAllBreakpoints;
00201     
00202     <span class="keywordflow">if</span>( eventCommand == <a class="code" href="datastructures_8h.html#a149a80">ID_DEBUG_ADD_BREAKPOINT</a> ||
00203         eventCommand == <a class="code" href="datastructures_8h.html#a149a81">ID_DEBUG_REMOVE_BREAKPOINT</a> ||
00204         eventCommand == <a class="code" href="datastructures_8h.html#a149a83">ID_DEBUG_RUNTOCURSOR</a>)
00205     {
00206         firstFile = event.<a class="code" href="classwx_debug_event.html#a17">GetSourceFilename</a>();
00207         eventLineNum = event.<a class="code" href="classwx_debug_event.html#a13">GetLineNumber</a>();
00208     }
00209 
00210     <span class="keywordflow">if</span>(eventCommand == <a class="code" href="datastructures_8h.html#a149a73">ID_DEBUG_START</a>)
00211     {
00212         breakpointList = event.<a class="code" href="classwx_debug_event.html#a22">GetFileBreakpoints</a>();
00213     }
00214 
00215     <span class="keywordflow">if</span>( eventCommand == <a class="code" href="datastructures_8h.html#a149a84">ID_DEBUG_ADD_WATCH</a> ||
00216         eventCommand == <a class="code" href="datastructures_8h.html#a149a85">ID_DEBUG_REMOVE_WATCH</a>)
00217     {
00218         gui_var_names = event.<a class="code" href="classwx_debug_event.html#a14">GetVariableNames</a>();
00219         varName = gui_var_names[0];
00220         funcName = event.<a class="code" href="classwx_debug_event.html#a18">GetFunctionName</a>();
00221         className = event.<a class="code" href="classwx_debug_event.html#a19">GetClassName</a>();
00222     }
00223 
00224     <span class="comment">//loop vars</span>
00225     <span class="keywordtype">int</span> i = 0, j = 0;
00226 
00227     <span class="keywordflow">switch</span>(eventCommand)
00228     {
00229     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a73">ID_DEBUG_START</a>:
00230     {
00231     
00232         <span class="comment">//start process</span>
00233         <a class="code" href="class_project_info.html">ProjectInfo</a>* proj = event.<a class="code" href="classwx_debug_event.html#a23">GetProject</a>();
00234 
00235         wxArrayString srcFiles = proj-&gt;<a class="code" href="class_project_info.html#a10">GetSources</a>();
00236         wxString execFile = proj-&gt;<a class="code" href="class_project_info.html#a18">GetExecutableFileName</a>();
00237         <a class="code" href="class_debugger.html#r31">projectBeingDebugged</a> = proj;
00238 
00239         <a class="code" href="class_debugger.html#d0">startProcess</a>(<span class="keyword">true</span>, event.<a class="code" href="classwx_debug_event.html#a21">IsRemote</a>(), execFile, <span class="stringliteral">"gdb -q"</span>);
00240 
00241         <span class="comment">//set breakpoints</span>
00242         <span class="keywordflow">for</span>(i = 0; i &lt; (<span class="keywordtype">int</span>)srcFiles.GetCount(); i++)
00243         {
00244             tmp = srcFiles[i];
00245             <span class="keywordflow">if</span>(breakpointList.find(tmp) != breakpointList.end())
00246             {
00247                 breakpointLines = breakpointList[tmp];
00248 
00249                 <span class="keywordflow">for</span>(j = 0; j &lt; (<span class="keywordtype">int</span>)breakpointLines.GetCount(); j++)
00250                 {
00251                     sendAllBreakpoints&lt;&lt;<span class="stringliteral">"break \""</span>&lt;&lt;tmp&lt;&lt;<span class="stringliteral">":"</span>&lt;&lt;breakpointLines[j]&lt;&lt;<span class="stringliteral">"\""</span>&lt;&lt;<a class="code" href="class_debugger.html#r16">returnChar</a>;
00252 
00253                     <a class="code" href="class_debugger.html#r9">lineToNum</a>[tmp].lineNumbers.Add(breakpointLines[j]);
00254                     <a class="code" href="class_debugger.html#r9">lineToNum</a>[tmp].gdbNumbers.Add(<a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a>);
00255 
00256                     <a class="code" href="class_debugger.html#r8">numBreakpoints</a>++;
00257                     <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a>++; 
00258                     
00259                     <span class="comment">//~~DEBUG CODE~~//</span>
00260                     <span class="comment">//wxLogDebug("--STARTUP: make breakpoint: num=%d, gdb_num=%d--",numBreakpoints, gdbBreakpointNum);</span>
00261                 }
00262             }<span class="comment">//end if</span>
00263         }
00264 
00265         <span class="comment">//~~DEBUG CODE~~//</span>
00266         <span class="comment">//wxLogDebug("--STARTUP: breakpoint string:\n------\n" + sendAllBreakpoints + "\n\n");</span>
00267 
00268 
00269         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<span class="stringliteral">"list"</span>+<a class="code" href="class_debugger.html#r16">returnChar</a>);
00270         <a class="code" href="class_debugger.html#d10">sendCommand</a>(sendAllBreakpoints);
00271         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<span class="stringliteral">"done"</span>+<a class="code" href="class_debugger.html#r16">returnChar</a>); <span class="comment">//tag... not really a command</span>
00272         <span class="keywordflow">break</span>;
00273     }
00274 
00275     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a75">ID_DEBUG_STOP</a>:
00276     {
00277         <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
00278         <a class="code" href="classwx_debug_event.html">wxDebugEvent</a> dbg;
00279         dbg.SetId(<a class="code" href="datastructures_8h.html#a149a88">ID_DEBUG_EXIT_NORMAL</a>);
00280         <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(dbg);
00281         <span class="keywordflow">break</span>;
00282     }
00283 
00284     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a76">ID_DEBUG_STEPNEXT</a>:
00285         <a class="code" href="class_debugger.html#a19">step</a>();
00286         <span class="keywordflow">break</span>;
00287 
00288     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a77">ID_DEBUG_STEPOVER</a>:
00289         <a class="code" href="class_debugger.html#a20">stepOver</a>();
00290         <span class="keywordflow">break</span>;
00291 
00292     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a78">ID_DEBUG_STEPOUT</a>:
00293         <a class="code" href="class_debugger.html#a21">stepOut</a>();
00294         <span class="keywordflow">break</span>;
00295     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a74">ID_DEBUG_CONTINUE</a>:
00296         <a class="code" href="class_debugger.html#a23">cont</a>();
00297         <span class="keywordflow">break</span>;
00298 
00299     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a83">ID_DEBUG_RUNTOCURSOR</a>:
00300         <a class="code" href="class_debugger.html#a24">runToCursor</a>(firstFile, eventLineNum);
00301         <span class="keywordflow">break</span>;
00302 
00303     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a80">ID_DEBUG_ADD_BREAKPOINT</a>:
00304         <a class="code" href="class_debugger.html#a14">setBreak</a>(firstFile, eventLineNum);
00305         <span class="keywordflow">break</span>;
00306 
00307     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a81">ID_DEBUG_REMOVE_BREAKPOINT</a>:
00308         <a class="code" href="class_debugger.html#a17">killBreak</a>(firstFile, eventLineNum);
00309         <span class="keywordflow">break</span>;
00310 
00311     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a84">ID_DEBUG_ADD_WATCH</a>:
00312         <a class="code" href="class_debugger.html#a25">snoopVar</a>(varName, funcName, className, <span class="keyword">false</span>);
00313         <span class="keywordflow">break</span>;
00314 
00315     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a85">ID_DEBUG_REMOVE_WATCH</a>:
00316         <a class="code" href="class_debugger.html#a27">removeVar</a>(varName, funcName, className);
00317         <span class="keywordflow">break</span>;
00318 
00319     <span class="keywordflow">default</span>:
00320         tmp = <a class="code" href="class_debugger.html#r12">error</a>;
00321         eventLineNum = <a class="code" href="class_debugger.html#r4">status</a>;
00322         error = <span class="stringliteral">"Unrecognized Debug Event"</span>;
00323         <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"onDebugEvent: "</span>);
00324         error = tmp;
00325         status = eventLineNum;
00326         <span class="keywordflow">break</span>;
00327     }
00328 }
00329 
00330 <span class="comment">//PUBLIC FUNCTIONS:</span>
00331 <span class="comment">//-----------------</span>
00332 <span class="comment">//PROGRAM STATUS</span>
00333 <span class="comment">//--------------</span>
00334 <span class="comment">//This is just general running information I thought would be</span>
00335 <span class="comment">//useful to know while using the class.</span>
00336 
<a name="l00345"></a><a class="code" href="class_debugger.html#a3">00345</a> <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a3">Debugger::getMode</a>()
00346 {
00347     <span class="keywordflow">return</span>(<a class="code" href="class_debugger.html#r0">isRemote</a>);
00348 }
00349 
<a name="l00358"></a><a class="code" href="class_debugger.html#a7">00358</a> <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a7">Debugger::isDebugging</a>()
00359 {
00360     <span class="keywordflow">return</span>((<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a>) || (<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a>) || (<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>));
00361 }
00362 
<a name="l00371"></a><a class="code" href="class_debugger.html#a8">00371</a> <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a8">Debugger::isPaused</a>()
00372 {
00373     <span class="keywordflow">return</span>(<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a> || <a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>);
00374 }
00375 
<a name="l00384"></a><a class="code" href="class_debugger.html#a9">00384</a> <a class="code" href="class_project_info.html">ProjectInfo</a>* <a class="code" href="class_debugger.html#a9">Debugger::getCurrentProject</a>()
00385 {
00386     <span class="keywordflow">return</span> <a class="code" href="class_debugger.html#r31">projectBeingDebugged</a>;
00387 }
00388 <span class="comment">//--//</span>
00389 
<a name="l00398"></a><a class="code" href="class_debugger.html#a4">00398</a> wxString <a class="code" href="class_debugger.html#a4">Debugger::getFile</a>()
00399 {
00400     <span class="keywordflow">return</span>(<a class="code" href="class_debugger.html#r3">currFile</a>);
00401 }
00402 
<a name="l00411"></a><a class="code" href="class_debugger.html#a6">00411</a> <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a6">Debugger::programStatus</a>()
00412 {
00413     <span class="keywordflow">return</span>(<a class="code" href="class_debugger.html#r5">classStatus</a>);
00414 }
00415 
00416 <span class="comment">//genericStatus(): returns the generic debugger status</span>
<a name="l00425"></a><a class="code" href="class_debugger.html#a5">00425</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a5">Debugger::genericStatus</a>()
00426 {
00427     <span class="keywordflow">return</span>(<a class="code" href="class_debugger.html#r4">status</a>);
00428 }
00429 
<a name="l00438"></a><a class="code" href="class_debugger.html#a10">00438</a> wxString <a class="code" href="class_debugger.html#a10">Debugger::errorMsg</a>()
00439 {
00440     <span class="keywordflow">return</span>(<a class="code" href="class_debugger.html#r12">error</a>);
00441 }
00442 
<a name="l00451"></a><a class="code" href="class_debugger.html#a11">00451</a> <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a11">Debugger::resetStatus</a>()
00452 {
00453     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a>)
00454     {
00455         <span class="comment">//if it's running, kill it...</span>
00456         <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">true</span>);
00457         
00458         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>;
00459     }
00460 
00461     <span class="comment">//i figure that if someone wants to reset the Debugger, then</span>
00462     <span class="comment">//darn it EVERYTHING is gonna get reset. so....</span>
00463     <span class="comment">//do a full reset of GDB</span>
00464 
00465     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> != <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>)
00466     {
00467         wxArrayString debugReset;
00468 
00469         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#a18">numBreak</a>() &gt; 0)
00470         {
00471             debugReset.Add(<span class="stringliteral">"delete breakpoint"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00472             <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a> = 0;
00473             <a class="code" href="class_debugger.html#r8">numBreakpoints</a> = 0;
00474             <a class="code" href="class_debugger.html#r9">lineToNum</a>.empty();
00475         }
00476 
00477         <span class="comment">//if the file was just loaded... no need to kill something not</span>
00478         <span class="comment">//running.  ^_^  + it generates an error</span>
00479         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r2">fileIsSet</a>)
00480         {
00481             <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> != <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>)
00482             {
00483                 debugReset.Add(<span class="stringliteral">"kill"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00484             }
00485 
00486             debugReset.Add(<span class="stringliteral">"file"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00487             debugReset.Add(<span class="stringliteral">"file "</span> + <a class="code" href="class_debugger.html#r3">currFile</a> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00488 
00489             <span class="comment">//now change the status</span>
00490             <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>;
00491         }
00492 
00493         <span class="comment">//end reset commands...</span>
00494         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a10">HARD_RESET</a>;
00495 
00496         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c = 0; c &lt; int(debugReset.GetCount()); c++)
00497         {
00498             <a class="code" href="class_debugger.html#d10">sendCommand</a>(debugReset[c]);
00499         }
00500     
00501         <a class="code" href="class_debugger.html#r12">error</a> = <span class="stringliteral">""</span>;
00502         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">""</span>;
00503         <a class="code" href="class_debugger.html#r17">data</a>.Empty();
00504         
00505         <span class="keywordflow">return</span>(<span class="keyword">true</span>);
00506     }
00507 
00508     <span class="comment">//this means the proc is dead so there's nothing to reset</span>
00509     <span class="keywordflow">return</span>(<span class="keyword">false</span>);
00510 }
00511 
<a name="l00520"></a><a class="code" href="class_debugger.html#a12">00520</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a12">Debugger::clearError</a>()
00521 {
00522     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r2">fileIsSet</a>)
00523     {
00524         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r5">classStatus</a> == <a class="code" href="cham__db_8h.html#a31a1">START</a> || <a class="code" href="class_debugger.html#r5">classStatus</a> == <a class="code" href="cham__db_8h.html#a31a10">HARD_RESET</a>)
00525         {
00526             <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>;
00527         }
00528         <span class="keywordflow">else</span>
00529         {
00530             <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a>;
00531         }
00532     }
00533     <span class="keywordflow">else</span>
00534     {
00535         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a29">DEBUG_NEED_FILE</a>;
00536     }
00537 
00538     <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a9">SOFT_RESET</a>;
00539 }
00540 
<a name="l00553"></a><a class="code" href="class_debugger.html#a13">00553</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a13">Debugger::setProcess</a>(<span class="keywordtype">bool</span> newIsRemote, wxString newFname, wxString nExec)
00554 {
00555     <span class="comment">//begin with a hard reset of everything.</span>
00556     <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
00557     <a class="code" href="class_debugger.html#d4">flushPrivateVar</a>();
00558     
00559     <a class="code" href="class_debugger.html#d0">startProcess</a>(<span class="keyword">true</span>,newIsRemote, newFname, nExec);
00560 }
00561 
00562 
<a name="l00577"></a><a class="code" href="class_debugger.html#d0">00577</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d0">Debugger::startProcess</a>(<span class="keywordtype">bool</span> fullRestart, <span class="keywordtype">bool</span> mode, wxString fName, wxString execThis)
00578 {
00579     <span class="keywordflow">if</span>(fullRestart)
00580     {
00581 
00582         <span class="comment">//generic initialization</span>
00583         <a class="code" href="class_debugger.html#r0">isRemote</a> = mode;            <span class="comment">//false = local</span>
00584         <a class="code" href="class_debugger.html#r3">currFile</a> = fName;
00585     
00586         <a class="code" href="class_debugger.html#r11">histCount</a> = 0;
00587     
00588         <a class="code" href="class_debugger.html#r8">numBreakpoints</a> = 0;
00589         <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a> = 1;
00590     
00591         <a class="code" href="class_debugger.html#r14">errorCount</a> = 0;
00592     
00593         <a class="code" href="class_debugger.html#r25">firstExecString</a> = execThis;
00594     }
00595 
00596     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r0">isRemote</a>)
00597     {<a class="code" href="class_debugger.html#r16">returnChar</a> = <span class="stringliteral">"\r"</span>;}
00598     <span class="keywordflow">else</span>
00599     {<a class="code" href="class_debugger.html#r16">returnChar</a> = <span class="stringliteral">"\n"</span>;}
00600 
00601     <span class="keywordflow">if</span>(fName != <span class="stringliteral">""</span>)
00602     {
00603         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>;
00604         <a class="code" href="class_debugger.html#r2">fileIsSet</a> = <span class="keyword">true</span>;
00605     }
00606     <span class="keywordflow">else</span>
00607     {
00608         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a29">DEBUG_NEED_FILE</a>;
00609         <a class="code" href="class_debugger.html#r2">fileIsSet</a> = <span class="keyword">false</span>;
00610     }
00611     
00612     <a class="code" href="class_debugger.html#r1">procLives</a> = <span class="keyword">true</span>;
00613     <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a13">NEW_PROC</a>;
00614     
00615 
00616     <a class="code" href="class_debugger.html#r28">streamOut</a> = <a class="code" href="class_debugger.html#r27">myConnection</a>-&gt;<a class="code" href="class_networking.html#a15">StartCommand</a>(<a class="code" href="class_debugger.html#r0">isRemote</a>, execThis, <span class="keyword">this</span>);
00617 
00618     <a class="code" href="class_debugger.html#r15">command</a> = execThis;
00619     <a class="code" href="class_debugger.html#d1">updateHistory</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00620 
00621     <span class="comment">//initial commands to GDB</span>
00622     
00623     wxArrayString initString;
00624     wxString tmp;
00625 
00626     <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a1">START</a>;
00627 
00628     <span class="comment">//initialize GDB</span>
00629     tmp.Printf(<span class="stringliteral">"set prompt %s%s"</span>, <a class="code" href="cham__db_8h.html#a0">PROMPT_CHAR</a>.c_str(), <a class="code" href="class_debugger.html#r16">returnChar</a>.c_str());
00630     initString.Add(tmp);
00631     initString.Add(<span class="stringliteral">"set print array off"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00632     initString.Add(<span class="stringliteral">"set print pretty off"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00633     initString.Add(<span class="stringliteral">"set print address off"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00634     initString.Add(<span class="stringliteral">"set confirm off"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00635     initString.Add(<span class="stringliteral">"set print repeats 10000"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00636 
00637     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r0">isRemote</a>)
00638     {
00639         wxString ttyString = <a class="code" href="class_debugger.html#r29">myEvent</a>-&gt;<a class="code" href="classwx_debug_event.html#a24">GetTTYString</a>();
00640         initString.Add(<span class="stringliteral">"tty "</span> + ttyString + <a class="code" href="class_debugger.html#r16">returnChar</a>);
00641     }
00642 
00643     <span class="comment">//send all initlization commands to GDB</span>
00644     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> currInit = 0; currInit &lt; int(initString.GetCount()); currInit++)
00645     {
00646         <a class="code" href="class_debugger.html#d10">sendCommand</a>(initString.Item(currInit));
00647     }
00648         
00649     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r2">fileIsSet</a>)
00650     {
00651         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"file "</span> + <a class="code" href="class_debugger.html#r3">currFile</a> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
00652         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00653     }<span class="comment">//end set-file conditional</span>
00654 }
00655 <span class="comment">//END PROGRAM STATUS</span>
00656 
00657 <span class="comment">//BREAKPOINT FUNCTIONALITY</span>
00658 <span class="comment">//------------------------</span>
00659 <span class="comment">//i used to have 3 variables to use for breakpoints.</span>
00660 <span class="comment">//Now I don't know.  ^_^  We re-designed things.</span>
00661 
<a name="l00674"></a><a class="code" href="class_debugger.html#a14">00674</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a14">Debugger::setBreak</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum)
00675 {
00676     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r2">fileIsSet</a> &amp;&amp;
00677         (<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a> || status == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>))
00678     {
00679 
00680         <span class="comment">//this if{} should never be run...</span>
00681         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#a18">numBreak</a>() == 0 &amp;&amp; <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a> == 1)
00682         {
00683             <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a1">START</a>;    <span class="comment">//ignore the output</span>
00684 
00685             <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a> = 1;
00686         }
00687         
00688         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a6">S_BREAK</a>;
00689         <a class="code" href="class_debugger.html#r15">command</a>.Printf(<span class="stringliteral">"break \"%s:%d\"%s"</span>, srcFile, lineNum, <a class="code" href="class_debugger.html#r16">returnChar</a>.c_str());
00690         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00691 
00692         <span class="comment">//~~DEBUG CODE~~//</span>
00693         <span class="comment">//wxLogDebug("--make breakpoint:(+1 to follow) num=%d, gdb_num=%d--",numBreakpoints, gdbBreakpointNum);</span>
00694 
00695         <a class="code" href="class_debugger.html#r9">lineToNum</a>[srcFile].lineNumbers.Add(lineNum);
00696         <a class="code" href="class_debugger.html#r9">lineToNum</a>[srcFile].gdbNumbers.Add(<a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a>);
00697         <a class="code" href="class_debugger.html#r8">numBreakpoints</a>++;
00698         <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a>++;
00699     }
00700 }
00701 
<a name="l00713"></a><a class="code" href="class_debugger.html#a16">00713</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a16">Debugger::enableBreak</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum)
00714 {
00715     <span class="keywordtype">int</span> equivNum = <a class="code" href="class_debugger.html#d8">findBreakpoint</a>(srcFile, lineNum);
00716 
00717     <span class="keywordflow">if</span>(equivNum == -1)
00718     {
00719         wxString baka = <a class="code" href="class_debugger.html#r12">error</a>;
00720         <span class="keywordtype">int</span> suBaka = <a class="code" href="class_debugger.html#r4">status</a>;
00721 
00722         error.Printf(<span class="stringliteral">"Failed to locate breakpoint in %s at %d"</span>, srcFile.c_str(), lineNum);
00723         <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"enableBreak: "</span>);
00724 
00725         error = baka;
00726         status = suBaka;
00727     }
00728     <span class="keywordflow">else</span>
00729     {
00730         <a class="code" href="class_debugger.html#r15">command</a>.Printf(<span class="stringliteral">"enable %d%s"</span>, equivNum, <a class="code" href="class_debugger.html#r16">returnChar</a>.c_str());
00731         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00732 
00733         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a3">E_BREAK</a>;
00734     }
00735 }
00736 
<a name="l00748"></a><a class="code" href="class_debugger.html#a15">00748</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a15">Debugger::disableBreak</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum)
00749 {
00750     <span class="keywordtype">int</span> equivNum = <a class="code" href="class_debugger.html#d8">findBreakpoint</a>(srcFile, lineNum);
00751 
00752     <span class="keywordflow">if</span>(equivNum == -1)
00753     {
00754         wxString baka = <a class="code" href="class_debugger.html#r12">error</a>;
00755         <span class="keywordtype">int</span> suBaka = <a class="code" href="class_debugger.html#r4">status</a>;
00756 
00757         error.Printf(<span class="stringliteral">"Failed to locate breakpoint in %s at %d"</span>, srcFile.c_str(), lineNum);
00758         <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"disableBreak: "</span>);
00759 
00760         error = baka;
00761         status = suBaka;
00762     }
00763     <span class="keywordflow">else</span>
00764     {
00765         <a class="code" href="class_debugger.html#r15">command</a>.Printf(<span class="stringliteral">"disable %d%s"</span>, equivNum, <a class="code" href="class_debugger.html#r16">returnChar</a>.c_str());
00766         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00767 
00768         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a4">D_BREAK</a>;
00769     }
00770 }
00771 
<a name="l00783"></a><a class="code" href="class_debugger.html#a17">00783</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a17">Debugger::killBreak</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum)
00784 {
00785     <span class="keywordtype">int</span> equivNum = <a class="code" href="class_debugger.html#d8">findBreakpoint</a>(srcFile, lineNum, <span class="keyword">true</span>);
00786     <span class="keywordflow">if</span>(equivNum == -1)
00787     {
00788         wxString baka = <a class="code" href="class_debugger.html#r12">error</a>;
00789         <span class="keywordtype">int</span> suBaka = <a class="code" href="class_debugger.html#r4">status</a>;
00790 
00791         error.Printf(<span class="stringliteral">"Failed to locate breakpoint in %s at %d"</span>, srcFile.c_str(), lineNum);
00792         <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"killBreak: "</span>);
00793 
00794         error = baka;
00795         status = suBaka;
00796     }
00797 
00798     <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a5">K_BREAK</a>;
00799 }
00800 
<a name="l00814"></a><a class="code" href="class_debugger.html#d8">00814</a> <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#d8">Debugger::findBreakpoint</a>(wxString fName, <span class="keywordtype">int</span> lineNum, <span class="keywordtype">bool</span> andRemove)
00815 {
00816     <span class="comment">//altered... added wxArrayInt &amp; took (lineToNum[fName].lineNumbers) out</span>
00817     <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
00818     <span class="keywordtype">int</span> equivNum = 0;
00819     <span class="keywordtype">int</span> arrayCount = <a class="code" href="class_debugger.html#r9">lineToNum</a>[fName].lineNumbers.GetCount();
00820     wxArrayInt tmp = lineToNum[fName].lineNumbers;
00821 
00822     <span class="keywordtype">int</span> lineIndex = tmp.Index(lineNum);
00823     <span class="keywordflow">if</span>(lineIndex != wxNOT_FOUND)
00824     {
00825         <span class="keywordflow">if</span>(andRemove)
00826         {
00827             <span class="comment">//~~DEBUG CODE~~//</span>
00828             <span class="comment">//wxLogDebug("--find breakpoint: i=%d, equivNum=%d, ltn[fn].gn.remove(i-1): %d--", i, equivNum, lineToNum[fName].gdbNumbers[i - 1]);</span>
00829             
00830             <span class="keywordtype">int</span> equivNum = lineToNum[fName].gdbNumbers[lineIndex];
00831             
00832             <span class="comment">//~~DEBUG CODE~~//</span>
00833             <span class="comment">//wxLogDebug("--find breakpoint: index=%d, equivNum=%d--", lineIndex, equivNum);</span>
00834 
00835             lineToNum[fName].lineNumbers.Remove(lineNum);
00836             lineToNum[fName].gdbNumbers.Remove(equivNum);
00837 
00838             <a class="code" href="class_debugger.html#r15">command</a>.Printf(<span class="stringliteral">"delete break %d%s"</span>, equivNum, <a class="code" href="class_debugger.html#r16">returnChar</a>.c_str());
00839             <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00840 
00841             <a class="code" href="class_debugger.html#r8">numBreakpoints</a>--;
00842         }
00843 
00844         <span class="keywordflow">return</span>(equivNum);
00845     }
00846     <span class="keywordflow">return</span>(-1);
00847 }
00848 
<a name="l00857"></a><a class="code" href="class_debugger.html#a18">00857</a> <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a18">Debugger::numBreak</a>()
00858 {
00859     <span class="keywordflow">return</span>(<a class="code" href="class_debugger.html#r8">numBreakpoints</a>);
00860 }
00861 <span class="comment">//END BREAKPOINT SECTION</span>
00862 
00863 <span class="comment">//STEP FUNCTIONALITY</span>
00864 <span class="comment">//------------------</span>
00865 <span class="comment">//This section handles step management; the jump-over, step into, things</span>
00866 <span class="comment">//like that.  The "go" function is also here.  It will get private var's</span>
00867 <span class="comment">//as neccesary.</span>
00868 
<a name="l00877"></a><a class="code" href="class_debugger.html#a19">00877</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a19">Debugger::step</a>()
00878 {
00879 
00880     <span class="comment">//check program status</span>
00881     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>)
00882     {
00883         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"run"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
00884         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a>;
00885         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a7">GO</a>;
00886         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00887 
00888     }
00889     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a> || <a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>)
00890     {
00891         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"step"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
00892         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a>;
00893         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a16">STEP</a>;
00894         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00895     }
00896     <span class="comment">//if not stopped or waiting, then program status = error</span>
00897 }
00898 
<a name="l00908"></a><a class="code" href="class_debugger.html#a20">00908</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a20">Debugger::stepOver</a>()
00909 {
00910     <span class="comment">//check program status</span>
00911     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a> || <a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>)
00912     {
00913         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"next"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
00914         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a>;
00915         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a17">STEP_OVER</a>;
00916         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00917     }
00918     <span class="comment">//if not waiting, then program status is not good for a step-over</span>
00919 }
00920 
<a name="l00930"></a><a class="code" href="class_debugger.html#a21">00930</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a21">Debugger::stepOut</a>()
00931 {
00932     <span class="comment">//check program status</span>
00933     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a> || <a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>)
00934     {
00935         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"finish"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
00936         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a>;
00937         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a18">STEP_OUT</a>;
00938         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00939     }
00940 
00941     <span class="comment">//if not stopped or waiting, then program status is not good for stepOut</span>
00942 }
00943 
<a name="l00956"></a><a class="code" href="class_debugger.html#a24">00956</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a24">Debugger::runToCursor</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum)
00957 {
00958     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a> || <a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>)
00959     {
00960         <span class="comment">//GDB automatically sets &amp; kills the breakpoint, but the number is incremented</span>
00961         <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a>++;
00962 
00963         <a class="code" href="class_debugger.html#r15">command</a>.Printf(<span class="stringliteral">"tbreak \"%s:%d\"%s"</span>, srcFile, lineNum, <a class="code" href="class_debugger.html#r16">returnChar</a>);
00964         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00965 
00966         <a class="code" href="class_debugger.html#a23">cont</a>();
00967 
00968         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a22">RUN_TO_CURSOR</a>;
00969     }
00970 
00971     <span class="comment">//if not stopped or waiting, then program status is not good for stepOut</span>
00972 }
00973 
<a name="l00982"></a><a class="code" href="class_debugger.html#a22">00982</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a22">Debugger::go</a>()
00983 {
00984     <span class="comment">//check to make sure the program is suitable to BE run...</span>
00985     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> != <a class="code" href="cham__db_8h.html#a32a28">DEBUG_ERROR</a> ||
00986         <a class="code" href="class_debugger.html#r4">status</a> != <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a> ||
00987         <a class="code" href="class_debugger.html#r4">status</a> != <a class="code" href="cham__db_8h.html#a32a29">DEBUG_NEED_FILE</a> ||
00988         <a class="code" href="class_debugger.html#r4">status</a> != <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>)
00989     {
00990         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a7">GO</a>;
00991         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a>;
00992 
00993         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"run"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
00994         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
00995     }<span class="comment">//end status check</span>
00996 }<span class="comment">//wow, tough</span>
00997 
<a name="l01008"></a><a class="code" href="class_debugger.html#a28">01008</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a28">Debugger::stop</a>(<span class="keywordtype">bool</span> pleaseRestart)
01009 {
01010     <span class="keywordtype">int</span> statBackup = <a class="code" href="class_debugger.html#r4">status</a>;
01011     <span class="keywordtype">int</span> classStatB = <a class="code" href="class_debugger.html#r5">classStatus</a>;
01012 
01013     <span class="keywordflow">if</span>(status == <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a> || status == <a class="code" href="cham__db_8h.html#a32a28">DEBUG_ERROR</a>)
01014     {
01015         <a class="code" href="class_debugger.html#r27">myConnection</a>-&gt;<a class="code" href="class_networking.html#a16">ForceKillProcess</a>(<a class="code" href="class_debugger.html#r28">streamOut</a>);
01016     } 
01017     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(status == <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>)
01018     {
01019         <a class="code" href="class_debugger.html#r12">error</a> = <span class="stringliteral">"tried to stop dead process"</span>;
01020         <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"stop(): "</span>);
01021         status = <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>;
01022     }
01023     <span class="keywordflow">else</span>
01024     {
01025         <span class="comment">//try to stop as cleanly as possible?</span>
01026         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#a18">numBreak</a>() &gt; 0)
01027         {
01028             <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"delete breakpoint"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
01029             <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
01030         }
01031 
01032         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r23">varCount</a> &gt; 0)
01033         {
01034             <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"delete display"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
01035             <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
01036         }
01037 
01038         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r2">fileIsSet</a>)
01039         {
01040             <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"file"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
01041             <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
01042         }
01043 
01044         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"quit"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
01045         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
01046 
01047     }
01048 
01049     <span class="comment">//is this appropriate for me???</span>
01050     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r0">isRemote</a>)
01051     {
01052         <span class="keywordflow">if</span>(statBackup != <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a> &amp;&amp;
01053             statBackup != <a class="code" href="cham__db_8h.html#a32a28">DEBUG_ERROR</a> &amp;&amp;
01054             statBackup != <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>)
01055         {
01056             <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"exit"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
01057             <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
01058         }
01059     }
01060 
01061     <a class="code" href="class_debugger.html#d4">flushPrivateVar</a>();
01062 
01063     classStatus = <a class="code" href="cham__db_8h.html#a31a19">STOP</a>;
01064     status = <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>;
01065     <a class="code" href="class_debugger.html#a11">resetStatus</a>();
01066 
01067     <a class="code" href="class_debugger.html#r1">procLives</a> = <span class="keyword">false</span>;
01068 
01069     <span class="keywordflow">if</span>(pleaseRestart)
01070     {   
01071         <a class="code" href="class_debugger.html#d0">startProcess</a>(<span class="keyword">true</span>, <a class="code" href="class_debugger.html#r0">isRemote</a>, <a class="code" href="class_debugger.html#r3">currFile</a>, <a class="code" href="class_debugger.html#r25">firstExecString</a>);
01072     }<span class="comment">//end pleaseRestart conditional</span>
01073 }
01074 
<a name="l01083"></a><a class="code" href="class_debugger.html#a29">01083</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a29">Debugger::kill</a>()
01084 {
01085     <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a19">STOP</a>;
01086     <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>;
01087 
01088     <a class="code" href="class_debugger.html#r1">procLives</a> = <span class="keyword">false</span>;
01089 
01090     <a class="code" href="class_debugger.html#r27">myConnection</a>-&gt;<a class="code" href="class_networking.html#a16">ForceKillProcess</a>(<a class="code" href="class_debugger.html#r28">streamOut</a>);
01091 
01092     <a class="code" href="class_debugger.html#d3">flushBuffer</a>();
01093     <a class="code" href="class_debugger.html#d4">flushPrivateVar</a>();
01094 }
01095 
<a name="l01104"></a><a class="code" href="class_debugger.html#a23">01104</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a23">Debugger::cont</a>()
01105 {
01106     <span class="comment">//continue will only work correctly on these two status items</span>
01107     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a> || <a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>)
01108     {
01109         <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">"continue"</span> + <a class="code" href="class_debugger.html#r16">returnChar</a>;
01110         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a2">CONTINUE</a>;
01111         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a>;
01112         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
01113     }
01114 }
01115 <span class="comment">//END STEP FUNCTIONALITY</span>
01116 
01117 <span class="comment">//VARIABLE FUNCTIONALITY</span>
01118 <span class="comment">//----------------------</span>
01119 
<a name="l01133"></a><a class="code" href="class_debugger.html#a25">01133</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a25">Debugger::snoopVar</a>(wxString varName, wxString funcName, wxString className, <span class="keywordtype">bool</span> oneShot)
01134 {
01135     wxString combinedFunction;
01136     <a class="code" href="struct_variable_info.html">VariableInfo</a> variableStruct;
01137     <span class="keywordtype">bool</span> notFound = <span class="keyword">true</span>;
01138 
01139     combinedFunction&lt;&lt;className&lt;&lt;<span class="stringliteral">"::"</span>&lt;&lt;funcName;
01140 
01141     <span class="comment">//Step 1: See if the variable &amp; function/class exists in the structure array</span>
01142     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r23">varCount</a> == 0)
01143     {   
01144         <span class="comment">//we're adding the first item to the array</span>
01145         variableStruct.<a class="code" href="struct_variable_info.html#o1">name</a> = varName;
01146         variableStruct.<a class="code" href="struct_variable_info.html#o2">functionName</a> = combinedFunction;
01147         variableStruct.<a class="code" href="struct_variable_info.html#o0">type</a> = <span class="stringliteral">"null"</span>;
01148         variableStruct.<a class="code" href="struct_variable_info.html#o3">value</a> = <span class="stringliteral">"0"</span>;
01149 
01150         <a class="code" href="class_debugger.html#r24">m_varInfo</a>.Add(variableStruct);
01151 
01152         <a class="code" href="class_debugger.html#r23">varCount</a>++;
01153     }
01154     <span class="keywordflow">else</span>
01155     {
01156         <span class="comment">//check to see if the variable is already in the array</span>
01157         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; (i &lt; <a class="code" href="class_debugger.html#r23">varCount</a>) &amp;&amp; (notFound); i++)
01158         {
01159             <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].name == varName)
01160             {
01161                 notFound = <span class="keyword">false</span>;
01162             }
01163         }
01164 
01165         <span class="keywordflow">if</span>(notFound)
01166         {
01167             variableStruct.<a class="code" href="struct_variable_info.html#o1">name</a> = varName;
01168             variableStruct.<a class="code" href="struct_variable_info.html#o2">functionName</a> = combinedFunction;
01169             variableStruct.<a class="code" href="struct_variable_info.html#o0">type</a> = <span class="stringliteral">"null"</span>;
01170             variableStruct.<a class="code" href="struct_variable_info.html#o3">value</a> = <span class="stringliteral">"0"</span>;
01171 
01172             <a class="code" href="class_debugger.html#r24">m_varInfo</a>.Add(variableStruct);
01173 
01174             <a class="code" href="class_debugger.html#r23">varCount</a>++;
01175         }
01176     }
01177 
01178     <span class="comment">//Step 2: if GDB is running, send a "whatis" command to get the type.</span>
01179     <span class="keywordflow">if</span>( notFound &amp;&amp;
01180         (<a class="code" href="class_debugger.html#r4">status</a> == <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a> || status == <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a>))
01181     {
01182         <a class="code" href="class_debugger.html#d5">sendWhat</a>();
01183 
01184         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a20">GET_WHAT</a>;
01185     }
01186 }
01187 
<a name="l01201"></a><a class="code" href="class_debugger.html#a26">01201</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a26">Debugger::setVar</a>(wxString varName, wxString newValue, wxString funcName, wxString className)
01202 {
01203 }
01204 
<a name="l01214"></a><a class="code" href="class_debugger.html#d5">01214</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d5">Debugger::sendWhat</a>()
01215 {
01216     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r23">varCount</a> &gt; 0)
01217     {
01218         wxString tmp;
01219         <a class="code" href="class_debugger.html#r15">command</a>.Clear();
01220         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_debugger.html#r23">varCount</a>; i++)
01221         {
01222             tmp.Printf(<span class="stringliteral">"whatis %s%s"</span>, <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].name.c_str(), <a class="code" href="class_debugger.html#r16">returnChar</a>.c_str());
01223             <a class="code" href="class_debugger.html#r15">command</a>.Append(tmp);
01224         }
01225 
01226         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
01227 
01228         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a20">GET_WHAT</a>;
01229     }
01230 }
01231 
<a name="l01245"></a><a class="code" href="class_debugger.html#d6">01245</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d6">Debugger::sendPrint</a>(wxString fromGDB)
01246 {
01247     wxString singleLine;
01248     wxArrayString fromWatch, ignoreVars;
01249     <span class="keywordtype">bool</span> watchStatus = <span class="keyword">false</span>;
01250     <span class="keywordtype">int</span> lineBreak = 0, endQuote = 0, fromWatchIndex = 0, ampIdx = -1;
01251 
01252     <span class="keywordflow">do</span>
01253     {
01254         lineBreak = fromGDB.Find(<span class="stringliteral">"\n"</span>);
01255 
01256         <span class="keywordflow">if</span>(lineBreak == -1)
01257         {
01258             fromGDB = <a class="code" href="cham__db_8h.html#a0">PROMPT_CHAR</a>;
01259         }
01260         <span class="keywordflow">else</span>
01261         {
01262             singleLine = fromGDB.Mid(0, lineBreak);
01263             singleLine = singleLine.BeforeFirst(<span class="charliteral">'\r'</span>);
01264 
01265             fromGDB = fromGDB.AfterFirst(<span class="charliteral">'\n'</span>);
01266 
01267             <span class="keywordflow">if</span>(singleLine.Mid(0,4) == <span class="stringliteral">"type"</span>)
01268             {
01269                 lineBreak = 2 + singleLine.Find(<span class="stringliteral">"= "</span>);
01270                 singleLine = singleLine.Mid(lineBreak);
01271 
01272 
01273                 ampIdx = singleLine.Find(<span class="stringliteral">" &amp;"</span>);
01274                 <span class="keywordflow">if</span>(ampIdx != -1)
01275                 {
01276                     singleLine = singleLine.Remove(ampIdx);
01277                     singleLine.Append(<span class="stringliteral">"&amp;"</span>);
01278                 }
01279 
01280                 ampIdx = singleLine.Find(<span class="stringliteral">" *"</span>);
01281                 <span class="keywordflow">if</span>(ampIdx != -1)
01282                 {
01283                     singleLine = singleLine.Remove(ampIdx);
01284                     singleLine.Append(<span class="stringliteral">"*"</span>);
01285                 }
01286 
01287                 <span class="comment">//~~DEBUG~~//</span>
01288                 <span class="comment">//wxLogDebug("\n--sendPrint: singleLine added: "+singleLine+"\n");</span>
01289 
01290                 fromWatch.Add(singleLine);
01291             }
01292             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(singleLine.Mid(0,9) == <span class="stringliteral">"No symbol"</span>)
01293             {
01294                 lineBreak = singleLine.Find(<span class="stringliteral">"\""</span>);
01295                 singleLine = singleLine.Mid(lineBreak + 1);
01296 
01297                 endQuote = singleLine.Find(<span class="stringliteral">"\""</span>);
01298                 singleLine = singleLine.Mid(0, endQuote);
01299 
01300                 ignoreVars.Add(singleLine);
01301             }
01302             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(singleLine.Mid(0,9) == <span class="stringliteral">"Attempt t"</span>)
01303             {
01304                 fromWatch.Add(<span class="stringliteral">"error"</span>);
01305             }
01306 
01307         }
01308     }<span class="keywordflow">while</span>(fromGDB != <a class="code" href="cham__db_8h.html#a0">PROMPT_CHAR</a>);
01309 
01310 
01311     <span class="keywordflow">if</span>(!fromWatch.IsEmpty())
01312     {
01313         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_debugger.html#r23">varCount</a>; i++)
01314         {
01315             <span class="keywordflow">if</span>(ignoreVars.Index(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].name) == wxNOT_FOUND)
01316             {
01317                 <span class="comment">//current variable is not in the "ignoreVars" list...</span>
01318                 <span class="keywordflow">if</span>(fromWatchIndex &lt; (<span class="keywordtype">int</span>)fromWatch.GetCount())
01319                 {
01320                     <span class="comment">//~~DEBUG CODE~~//</span>
01321                     <span class="comment">//wxLogDebug("\n--sendPrint: type set: "+fromWatch[fromWatchIndex]+"\n");</span>
01322 
01323                     <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type = fromWatch[fromWatchIndex];
01324 
01325                     fromWatchIndex++;
01326 
01327                     <span class="comment">//illegal variable name watch</span>
01328                     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type == <span class="stringliteral">"error"</span>)
01329                     {
01330                         <a class="code" href="class_debugger.html#r24">m_varInfo</a>.RemoveAt(i);
01331                         varCount--;
01332                     }
01333                 }<span class="comment">//testing "fromWatchIndex"</span>
01334                 <span class="keywordflow">else</span>
01335                 {
01336                     <span class="comment">//if we're down here, then there are more variables than there are</span>
01337                     <span class="comment">//printed outputs.  So we by-pass the output in hopes that the</span>
01338                     <span class="comment">//next few "whatis" statements come through</span>
01339                     watchStatus = <span class="keyword">true</span>;
01340                 }
01341             }<span class="comment">//end variable ignore existance check</span>
01342         }<span class="comment">//end for</span>
01343     }
01344 
01345     <span class="keywordflow">if</span>(!watchStatus)
01346     {
01347         wxString tmp;
01348         <a class="code" href="class_debugger.html#r15">command</a>.Clear();
01349         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_debugger.html#r23">varCount</a>; i++)
01350         {
01351             wxString name = <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].name;
01352 
01353             <span class="comment">//special cases:</span>
01354             <span class="comment">// type==string: append "._M_dataplus._M_p" to format the string</span>
01355             <span class="comment">// type==[xxx]*: pre-pend "*" to de-reference the pointer type</span>
01356             
01357             <span class="keywordflow">if</span>(m_varInfo[i].type == <span class="stringliteral">"string"</span>)
01358             {
01359                 name += <span class="stringliteral">"._M_dataplus._M_p"</span>;
01360             }
01361             <span class="keywordflow">if</span>(m_varInfo[i].type.Find(<span class="stringliteral">"*"</span>) != -1)
01362             {   
01363                 name.Prepend(<span class="stringliteral">"*"</span>);
01364             }
01365 
01366             tmp.Printf(<span class="stringliteral">"print %s%s"</span>, name, <a class="code" href="class_debugger.html#r16">returnChar</a>);
01367             <a class="code" href="class_debugger.html#r15">command</a>.Append(tmp);
01368         }
01369 
01370         <a class="code" href="class_debugger.html#d10">sendCommand</a>(<a class="code" href="class_debugger.html#r15">command</a>);
01371 
01372         <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a21">GET_PRINT</a>;
01373     }
01374 }
01375 
<a name="l01388"></a><a class="code" href="class_debugger.html#a27">01388</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a27">Debugger::removeVar</a>(wxString varName, wxString funcName, wxString className)
01389 {
01390     <span class="comment">//some added verbosity</span>
01391     <span class="keywordtype">bool</span> notFound = <span class="keyword">true</span>,
01392          found = <span class="keyword">false</span>;
01393 
01394     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r23">varCount</a> != 0)
01395     {
01396         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; (i &lt; <a class="code" href="class_debugger.html#r23">varCount</a>) &amp;&amp; (notFound); i++)
01397         {
01398             <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].name == varName)
01399             {
01400                 notFound = <span class="keyword">false</span>;
01401                 found = <span class="keyword">true</span>;
01402             }
01403         }
01404 
01405         <span class="keywordflow">if</span>(found)
01406         {
01407             <a class="code" href="class_debugger.html#r24">m_varInfo</a>.RemoveAt(i - 1);
01408             <a class="code" href="class_debugger.html#r23">varCount</a>--;
01409         }
01410     }<span class="comment">//end varCount if</span>
01411 }
01412 
<a name="l01426"></a><a class="code" href="class_debugger.html#d7">01426</a> <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#d7">Debugger::parsePrintOutput</a>(wxString fromGDB, wxArrayString &amp;varValue)
01427 {
01428     wxString singleLine, match;
01429     wxArrayString fromWatch, ignoreVars;
01430     <span class="keywordtype">int</span> lineBreak = 0, endQuote = 0, fromWatchIndex = 0;
01431     <span class="keywordtype">bool</span> parseError = <span class="keyword">false</span>, stayIn = <span class="keyword">true</span>;
01432 
01433     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; (i &lt; <a class="code" href="class_debugger.html#r23">varCount</a>) &amp;&amp; !parseError; i++)
01434     {
01435         lineBreak = fromGDB.Find(<span class="stringliteral">"\n"</span>);
01436 
01437         <span class="keywordflow">if</span>(lineBreak == -1)
01438         {
01439             parseError = <span class="keyword">true</span>;
01440         }
01441         <span class="keywordflow">else</span>
01442         {
01443             stayIn = <span class="keyword">true</span>;
01444 
01445             <span class="keywordflow">while</span>(stayIn)
01446             {
01447                 <span class="comment">// fromGDB should contain Windows-based line endings, ie, CRLF (\r\n).  </span>
01448                 lineBreak = fromGDB.Find(<span class="stringliteral">"\n"</span>);
01449                 singleLine = fromGDB.Mid(0, lineBreak + 1);
01450                 <span class="comment">//singleLine = singleLine.BeforeLast('\r');</span>
01451 
01452                 fromGDB = fromGDB.AfterFirst(<span class="charliteral">'\n'</span>);
01453 
01454                 <span class="keywordflow">if</span>(singleLine.IsEmpty())
01455                 {
01456                     stayIn = <span class="keyword">false</span>;
01457                 }
01458 
01459                 <span class="keywordflow">if</span>( stayIn &amp;&amp; 
01460                    (singleLine.StartsWith(<span class="stringliteral">"$"</span>) ||
01461                     singleLine.StartsWith(<span class="stringliteral">"No symbol"</span>)))
01462                 {
01463                     <span class="keywordflow">while</span>(!fromGDB.StartsWith(<span class="stringliteral">"$"</span>) &amp;&amp; 
01464                             !fromGDB.StartsWith(<span class="stringliteral">"No Symbol"</span>) &amp;&amp;
01465                             !fromGDB.StartsWith(<a class="code" href="cham__db_8h.html#a0">PROMPT_CHAR</a>) &amp;&amp;
01466                             !fromGDB.IsEmpty())
01467                     {
01468                         lineBreak = fromGDB.Find(<span class="stringliteral">"\n"</span>);
01469                         singleLine += fromGDB.Mid(0, lineBreak + 1);
01470                         fromGDB = fromGDB.AfterFirst(<span class="charliteral">'\n'</span>);
01471                     }
01472                     stayIn = <span class="keyword">false</span>;
01473                 }
01474             }
01475 
01476             <span class="keywordflow">if</span>(!singleLine.IsEmpty())
01477             {
01478                 wxString regexString;
01479                 <span class="keywordflow">if</span>(singleLine.Mid(0,9) == <span class="stringliteral">"No symbol"</span>)
01480                 {
01481                     <span class="comment">//~~DEBUG CODE~~//</span>
01482                     <span class="comment">//wxLogDebug("no symbol found: "+singleLine+"\n");</span>
01483 
01484                     varValue.Add(singleLine);
01485                     <span class="keywordflow">continue</span>;
01486                 }
01487                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type.Find(<span class="stringliteral">"["</span>) == -1)
01488                 {
01489                     <span class="keywordflow">if</span>( <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type.Find(<span class="stringliteral">"&amp;"</span>) == -1 &amp;&amp;
01490                         <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type.Find(<span class="stringliteral">"*"</span>) == -1)
01491                     {
01492                         <a class="code" href="struct_variable_info.html">VariableInfo</a> varInfo = <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i];
01493                         wxString type = varInfo.<a class="code" href="struct_variable_info.html#o0">type</a>;
01494                         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r19">varRegExes</a>.find(type) != <a class="code" href="class_debugger.html#r19">varRegExes</a>.end())
01495                         {
01496                             regexString = <a class="code" href="class_debugger.html#r19">varRegExes</a>[type];
01497                         }
01498                         <span class="keywordflow">else</span>
01499                         {
01500                             regexString = <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"class"</span>];
01501                         }
01502                     }
01503                     <span class="keywordflow">else</span>
01504                     {
01505                         <span class="comment">//we have a pointer dereference or a referenced variable on our hands</span>
01506                         <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type.Find(<span class="stringliteral">"&amp;"</span>) &gt; 0)
01507                         {
01508                             wxString tmp = <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type.BeforeLast(<span class="charliteral">'&amp;'</span>);
01509                             regexString = <a class="code" href="class_debugger.html#r19">varRegExes</a>[tmp];
01510                         }
01511                         <span class="keywordflow">else</span>
01512                         {
01513                             <span class="comment">//we're assuming it's a dereferenced pointer</span>
01514                             wxString tmp = <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type.BeforeLast(<span class="charliteral">'*'</span>);
01515                             regexString = <a class="code" href="class_debugger.html#r19">varRegExes</a>[tmp];
01516                         }
01517                     }<span class="comment">//end referenced variable test</span>
01518                 }
01519                 <span class="keywordflow">else</span>
01520                 {
01521                     <span class="comment">//we have an array of some type...</span>
01522                     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type.Find(<span class="stringliteral">"char"</span>) != -1)
01523                     {
01524                         regexString = <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"char[]"</span>];
01525                         <span class="comment">//it's a char string.  Parse as regular string</span>
01526                     }
01527                     <span class="keywordflow">else</span>
01528                     {
01529                         regexString = <a class="code" href="class_debugger.html#r19">varRegExes</a>[<span class="stringliteral">"array"</span>];
01530                     }
01531                 }<span class="comment">//end array-test</span>
01532 
01533                 <span class="keywordflow">if</span>(regexString == wxEmptyString)
01534                 {
01535                     <span class="comment">//~~DEBUG CODE~~//</span>
01536                     <span class="comment">//wxLogDebug("\n--parsePrint: unknown type: "+singleLine+"\n");</span>
01537 
01538                     <span class="comment">//continue;</span>
01539                     <a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type = <span class="stringliteral">"Unknown"</span>;
01540                     varValue.Add(singleLine); 
01541                 }
01542                 <span class="keywordflow">else</span>
01543                 {
01544                     wxRegEx varParser(regexString, wxRE_ADVANCED);
01545                     <span class="keywordtype">bool</span> keepMatching = <span class="keyword">true</span>;
01546 
01547                     <span class="keywordflow">while</span>(keepMatching &amp;&amp; !parseError)
01548                     {
01549                         <span class="keywordflow">if</span>(varParser.Matches(singleLine))
01550                         {
01551                             match = varParser.GetMatch(singleLine, 1);
01552 
01553                             <span class="comment">//~~DEBUG CODE~~//</span>
01554                             <span class="comment">//wxLogDebug("\n--parsePrint: added match: "+match+"\n");</span>
01555 
01556                             varValue.Add(match);
01557                             keepMatching = <span class="keyword">false</span>;
01558                         }
01559                         <span class="keywordflow">else</span>
01560                         {
01561                             <span class="keywordtype">int</span> nextMarker = -1;
01562                             wxString endOfVarRegex;
01563 
01564                             endOfVarRegex = <span class="stringliteral">"\\r\\n"</span> + <a class="code" href="cham__db_8h.html#a0">PROMPT_CHAR</a>;
01565                             
01566                             wxRegEx reEndOfVar(endOfVarRegex, wxRE_ADVANCED);
01567                             size_t start, len;
01568 
01569                             <span class="keywordflow">if</span>(reEndOfVar.Matches(fromGDB))
01570                             {
01571                                 reEndOfVar.GetMatch(&amp;start, &amp;len);
01572 
01573                                 nextMarker = (<span class="keywordtype">int</span>)start;
01574                                 wxString temp = fromGDB.Mid(0, nextMarker - 1);
01575 
01576                                 <span class="keywordflow">if</span>(singleLine.Find(temp) != -1)
01577                                 {
01578                                     singleLine += temp;
01579                                 }
01580                                 <span class="keywordflow">else</span>
01581                                 {
01582                                     parseError = <span class="keyword">true</span>;
01583                                 }
01584                             }
01585                             <span class="keywordflow">else</span>
01586                             {
01587                                 parseError = <span class="keyword">true</span>;
01588                             }
01589                         } <span class="comment">// end else</span>
01590                     } <span class="comment">// end while</span>
01591                 } <span class="comment">// end else regex == wxemptystring                </span>
01592             } <span class="comment">// end if !singleline.empty</span>
01593         } <span class="comment">// end else (linebreak)</span>
01594     }<span class="comment">//end for-loop</span>
01595 
01596     <span class="keywordflow">if</span>(parseError)
01597     {
01598         <span class="keywordflow">return</span>(<span class="keyword">false</span>);
01599     }
01600     <span class="keywordflow">return</span>(<span class="keyword">true</span>);
01601 }
01602 <span class="comment">//END VARIABLE FUNCTIONALITY</span>
01603 
01604 <span class="comment">//MISC FUNCTIONS:</span>
01605 <span class="comment">//---------------</span>
01606 <span class="comment">//These funcions are random public thingies that don't qualify under any other</span>
01607 <span class="comment">//heading.  "stop()" and "kill()" are listed as "misc" but i include those in</span>
01608 <span class="comment">//step functionality since those affect the running of this class.</span>
01609 
<a name="l01621"></a><a class="code" href="class_debugger.html#a30">01621</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a30">Debugger::sendCustomCommand</a>(wxString cust)
01622 {
01623     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r1">procLives</a> == <span class="keyword">true</span>)
01624     {
01625         cust.Append(<a class="code" href="class_debugger.html#r16">returnChar</a>);
01626         <a class="code" href="class_debugger.html#d10">sendCommand</a>(cust);
01627     }
01628 }
01629 
<a name="l01640"></a><a class="code" href="class_debugger.html#a31">01640</a> wxString <a class="code" href="class_debugger.html#a31">Debugger::getProcOutput</a>(<span class="keywordtype">int</span> numEntries = -1)
01641 {
01642     wxString tmp = <span class="stringliteral">""</span>;
01643     <span class="keywordtype">int</span> outputCount = (<span class="keywordtype">int</span>)<a class="code" href="class_debugger.html#r18">fullOutput</a>.GetCount();
01644     <span class="keywordtype">int</span> loopStop = numEntries;
01645     <span class="keywordflow">if</span>(outputCount &gt; 0)
01646     {
01647         <span class="keywordflow">if</span>(numEntries == -1)
01648         {loopStop = outputCount;}
01649 
01650         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; loopStop; i++)
01651         {tmp.Append(<a class="code" href="class_debugger.html#r18">fullOutput</a>[i]);}
01652     }
01653 
01654     <span class="keywordflow">return</span>(tmp);
01655 }
01656 
01657 
01658 <span class="comment">//PRIVATE FUNCTIONS:</span>
01659 <span class="comment">//------------------</span>
01660 
01661 <span class="comment">//The following 3 are from Dave Czechowski.  KUDOS!</span>
01662 
<a name="l01673"></a><a class="code" href="class_debugger.html#d13">01673</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d13">Debugger::onProcessOutputEvent</a>(<a class="code" href="class_chameleon_process_event.html">ChameleonProcessEvent</a> &amp;e)
01674 {
01675     <span class="comment">//variables to hold stuff for parsing...</span>
01676     wxString tempHold, goBreakpoint;
01677     wxArrayString tmpArrayString;
01678     
01679     wxArrayString varNames, varValue, varType;
01680 
01681     wxString tempString;
01682     <a class="code" href="classwx_debug_event.html">wxDebugEvent</a> outputEvent;
01683 
01684     
01685     <span class="keywordtype">int</span> classStatusBackup = 0,
01686         gdbNum = 0;
01687     <span class="keywordtype">long</span> tmpLong;
01688 
01689     <span class="keywordtype">bool</span> skipThrough = <span class="keyword">true</span>, 
01690          keepParsing = <span class="keyword">false</span>;
01691 
01692     <span class="comment">//step parsing RegEx</span>
01693     wxRegEx reCase1 = <span class="stringliteral">" at (([[:alnum:]]|[[:blank:]]|\\.|/)+):([[:digit:]]+)"</span>;
01694     <span class="comment">// needs the wxRE_ADVANCED in order to work properly, so can't just</span>
01695     <span class="comment">// assign this one as if it were a string</span>
01696     wxRegEx reCase2(<span class="stringliteral">"(\\n|^)(\\d+)[ \\t]+"</span>, wxRE_ADVANCED);
01697 
01698     <span class="comment">//go parsing RegEx</span>
01699     wxRegEx reStart = <span class="stringliteral">" command: \"done\""</span>;
01700     wxRegEx reGoCase = <span class="stringliteral">"Breakpoint ([[:digit:]]+)"</span>;
01701 
01702     <span class="comment">//breakpoint parsing RegEx</span>
01703     wxRegEx reSetBreak = <span class="stringliteral">"Breakpoint ([[:digit:]]+)"</span>;
01705 
01707 
01708     <span class="comment">//data now has the output...</span>
01709     tempHold = e.<a class="code" href="class_chameleon_process_event.html#a4">GetString</a>();
01710     <a class="code" href="class_debugger.html#r17">data</a>.Add(tempHold);
01711     
01712     <span class="comment">//~~DEBUG CODE~~//</span>
01713     <span class="comment">//wxLogDebug("DB output: %s", tempHold);</span>
01714 
01715     <span class="comment">//I don't think this code is effectual anymore... -B</span>
01716     <span class="comment">//REVISED: This code here is VITAL: DO NOT REMOVE unless you improve it -B</span>
01717     <span class="comment">//--//</span>
01718     <span class="comment">//1) See if the captured string has a [$] all by itself at the end</span>
01719     <span class="comment">//2) If so, begin parsing.</span>
01720     <span class="comment">//3) If not, wait for another output</span>
01721     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r5">classStatus</a> != <a class="code" href="cham__db_8h.html#a31a1">START</a>)
01722     {
01723         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; 
01724             i &lt; (<span class="keywordtype">int</span>)<a class="code" href="class_debugger.html#r17">data</a>.GetCount() &amp;&amp; skipThrough; 
01725             i++)
01726         {
01727             tempHold = <a class="code" href="class_debugger.html#r17">data</a>[i];
01728             <span class="keywordflow">if</span>(tempHold.Last() == <a class="code" href="cham__db_8h.html#a0">PROMPT_CHAR</a>)
01729             {
01730                 tempHold.Empty();
01731 
01732                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; j++)
01733                 {tempHold &lt;&lt; data[j];}
01734 
01735                 skipThrough = <span class="keyword">false</span>;
01736             }
01737         }
01738     }
01739     <span class="keywordflow">else</span>
01740     {
01741         skipThrough = <span class="keyword">false</span>;
01742     }
01743 
01744     <span class="comment">//check to see if something good was found.</span>
01745     <span class="keywordflow">if</span>(skipThrough)
01746     {
01747         classStatusBackup = <a class="code" href="class_debugger.html#r5">classStatus</a>;
01748         classStatus = <a class="code" href="cham__db_8h.html#a31a23">WAITING</a>;
01749     }
01750     <span class="comment">//--//</span>
01751     
01752     <span class="keywordflow">switch</span>(<a class="code" href="class_debugger.html#r5">classStatus</a>)
01753     {
01754         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a1">START</a>:         <span class="comment">//program start</span>
01755             <span class="comment">//this re-directs to where the output actually is that we want</span>
01756             <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r0">isRemote</a>)
01757             {tempString = tempHold;}
01758             <span class="keywordflow">else</span>
01759             {tempString = <a class="code" href="class_debugger.html#a10">errorMsg</a>();}
01760 
01761             <span class="keywordflow">if</span>(tempString != <span class="stringliteral">""</span>)
01762             {
01763                 <span class="keywordflow">if</span>(reStart.Matches(tempString))
01764                 {
01765                     <span class="comment">//the dope command "done" sent to GDB returns an error.</span>
01766                     <span class="comment">//this means that all init. commands have gone through,</span>
01767                     <span class="comment">//and we can start the program.</span>
01768                     <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>;
01769                     <a class="code" href="class_debugger.html#a22">go</a>();
01770                 }
01771             }
01772 
01773             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01774             <span class="keywordflow">break</span>;
01775 
01776         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a3">E_BREAK</a>:       <span class="comment">//enable break</span>
01777         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a4">D_BREAK</a>:       <span class="comment">//disable break</span>
01778         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a5">K_BREAK</a>:       <span class="comment">//kill break</span>
01779             <span class="comment">//nothing to parse...</span>
01780             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01781             <span class="keywordflow">break</span>;
01782 
01783         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a6">S_BREAK</a>:       <span class="comment">//set break</span>
01784             <span class="keywordflow">if</span>(reSetBreak.Matches(tempHold))
01785             {
01786                 goBreakpoint = reSetBreak.GetMatch(tempHold, 1);
01787                 
01788                 goBreakpoint.ToLong(&amp;tmpLong);
01789                 gdbNum = (<span class="keywordtype">int</span>)tmpLong;
01790                 
01791                 <span class="comment">//~~DEBUG CODE~~//</span>
01792                 <span class="comment">//wxLogDebug("--output_parse: setbreak: caught num=%d, gdb_num=%d--", gdbNum, (gdbBreakpointNum - 1));</span>
01793 
01794                 <span class="keywordflow">if</span>(gdbNum != (<a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a> - 1))
01795                 {
01796                     <a class="code" href="class_debugger.html#r12">error</a>.Printf(<span class="stringliteral">"#s don't match: caught=%d internal=%d"</span>, gdbNum, (<a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a> - 1));
01797                     <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"Set_Break parse: "</span>);
01798 
01799                     
01800                     outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a89">ID_DEBUG_EXIT_ERROR</a>);
01801                     <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01802                     <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
01803                 }
01804             }
01805             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01806             <span class="keywordflow">break</span>;
01807 
01808         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a22">RUN_TO_CURSOR</a>:
01809         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a2">CONTINUE</a>:
01810         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a7">GO</a>:
01811         {
01812             keepParsing = <a class="code" href="class_debugger.html#d9">checkOutputStream</a>(tempHold);
01813 
01814             <span class="keywordflow">if</span>(keepParsing)
01815             {
01816                 <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r5">classStatus</a> == <a class="code" href="cham__db_8h.html#a31a19">STOP</a>)
01817                 {
01818                     outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a88">ID_DEBUG_EXIT_NORMAL</a>);
01819                     <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01820                     <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
01821                     <span class="keywordflow">break</span>;
01822                 }
01823 
01824                 <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r5">classStatus</a> == <a class="code" href="cham__db_8h.html#a31a22">RUN_TO_CURSOR</a> || reGoCase.Matches(tempHold))
01825                 {
01826                     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r5">classStatus</a> != <a class="code" href="cham__db_8h.html#a31a22">RUN_TO_CURSOR</a>)
01827                     {
01828                         goBreakpoint = reGoCase.GetMatch(tempHold, 1);
01829                     }
01830 
01831                     <span class="keywordflow">if</span>(reCase1.Matches(tempHold))
01832                     {
01833                         <a class="code" href="class_debugger.html#r20">Filename</a> = reCase1.GetMatch(tempHold, 1);
01834                         <a class="code" href="class_debugger.html#r21">Linenumber</a> = reCase1.GetMatch(tempHold, 3);
01835 
01836                         <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>;
01837 
01838                         <a class="code" href="class_debugger.html#r21">Linenumber</a>.ToLong(&amp;tmpLong);
01839     
01840                         outputEvent.<a class="code" href="classwx_debug_event.html#a2">SetLineNumber</a>((<span class="keywordtype">int</span>)tmpLong);
01841                         outputEvent.<a class="code" href="classwx_debug_event.html#a6">SetSourceFilename</a>(<a class="code" href="class_debugger.html#r20">Filename</a>);
01842                         outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a87">ID_DEBUG_BREAKPOINT</a>);
01843                         <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01844 
01845                         <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01846 
01847                         <a class="code" href="class_debugger.html#d5">sendWhat</a>();
01848                     }
01849                 }
01850                 <span class="comment">//given synchronous issues, an "else" here is invalid.  Why?</span>
01851                 <span class="comment">//the fact that a command was sent can reach me before the</span>
01852                 <span class="comment">//actual result of the command, which i need.</span>
01853             }
01854             <span class="keywordflow">else</span>
01855             {
01856                 <span class="comment">//something bad this way comes... aka Keeparsing = false</span>
01857                 outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a89">ID_DEBUG_EXIT_ERROR</a>);
01858                 <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01859                 <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
01860             }
01861             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01862             <span class="keywordflow">break</span>;
01863         }
01864 
01865         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a8">JUMP</a>:
01866         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a9">SOFT_RESET</a>:
01867         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a10">HARD_RESET</a>:
01868         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a11">NEW_FILE</a>:      <span class="comment">//new file to debug</span>
01869         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a12">NEW_MODE</a>:      <span class="comment">//change in program mode</span>
01870             <a class="code" href="class_debugger.html#d3">flushBuffer</a>();
01871             <span class="keywordflow">break</span>;
01872 
01873         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a13">NEW_PROC</a>:      <span class="comment">//change in process pointer</span>
01874             <a class="code" href="class_debugger.html#d3">flushBuffer</a>();
01875             <span class="keywordflow">break</span>;
01876 
01877         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a14">VAR_ASSIGN</a>:
01878             <span class="comment">//the only time this status occurs is after a "print var = val"</span>
01879             <span class="comment">//First we check for text.  This means an invalid assignment</span>
01880             <span class="comment">//Next we check for the same things WATCH_VAR does...</span>
01881             <span class="comment">// so we can probably remove this "break" and let it flow into</span>
01882             <span class="comment">// WATCH_VAR...</span>
01883             <span class="comment">//or we could ignore what i wrote a coupl'a months ago ^^ and</span>
01884             <span class="comment">//let this flow into GET_PRINT.  :)  or an equiv.</span>
01885             <span class="keywordflow">break</span>;
01886 
01887         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a20">GET_WHAT</a>:
01888             <a class="code" href="class_debugger.html#d6">sendPrint</a>(tempHold);
01889             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01890             <span class="keywordflow">break</span>;
01891 
01892         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a21">GET_PRINT</a>:
01893         {
01894             <span class="comment">//varNames, varValue, varType</span>
01895             <span class="keywordtype">bool</span> dontskip = <span class="keyword">true</span>;
01896             dontskip = <a class="code" href="class_debugger.html#d7">parsePrintOutput</a>(tempHold, varValue);
01897 
01898             <span class="keywordflow">if</span>(dontskip)
01899             {
01900                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_debugger.html#r23">varCount</a>; i++)
01901                 {
01902                     varNames.Add(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].name);
01903                     varType.Add(<a class="code" href="class_debugger.html#r24">m_varInfo</a>[i].type);
01904                 }
01905 
01906                 <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a23">WAITING</a>;
01907 
01908                 <span class="keywordflow">if</span>(varCount &gt; 0)
01909                 {
01910                     outputEvent.<a class="code" href="classwx_debug_event.html#a3">SetVariableNames</a>(varNames);
01911                     outputEvent.<a class="code" href="classwx_debug_event.html#a5">SetVariableTypes</a>(varType);
01912                     outputEvent.<a class="code" href="classwx_debug_event.html#a4">SetVariableValues</a>(varValue);
01913                     outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a86">ID_DEBUG_VARINFO</a>);
01914                     <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01915                 }
01916             }
01917 
01918             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01919             <span class="keywordflow">break</span>;
01920         }
01921 
01922         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a15">WATCH_VAR</a>:
01923             <span class="keywordflow">break</span>;
01924 
01925         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a16">STEP</a>:
01926         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a17">STEP_OVER</a>:
01927         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a18">STEP_OUT</a>:
01928         {
01929 
01930             <span class="comment">//looking for this heirarchy:</span>
01931             <span class="comment">// 1) the word "Program" as this indicates a fatal error</span>
01932             <span class="comment">//  2) the pattern "f_name.ext:ln"</span>
01933             <span class="comment">//   3) a line number</span>
01934             <span class="comment">//case 1, reset statuses and send an error</span>
01935             <span class="comment">//case 2, update the filename and line number vars to send</span>
01936             <span class="comment">//case 3, update the line number and send</span>
01937             <span class="comment">//once one of these items is found, do a check on [topVarIndex &gt; 0]</span>
01938             <span class="comment">//and update the array;</span>
01939 
01940             <span class="comment">//kudos to Mark for the RegEx!!</span>
01941             <span class="keywordtype">bool</span> noNewWhats = <span class="keyword">true</span>;
01942             keepParsing = <a class="code" href="class_debugger.html#d9">checkOutputStream</a>(tempHold);
01943 
01944             <span class="comment">//begin testing cases</span>
01945             <span class="keywordflow">if</span>(keepParsing)
01946             {
01947                 <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r5">classStatus</a> == <a class="code" href="cham__db_8h.html#a31a19">STOP</a>)
01948                 {
01949                     outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a88">ID_DEBUG_EXIT_NORMAL</a>);
01950                     <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01951                     <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
01952                     <span class="keywordflow">break</span>;
01953                 }
01954                 <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a>;
01955                 <span class="keywordflow">if</span>(reCase1.Matches(tempHold))
01956                 {
01957                     <a class="code" href="class_debugger.html#r20">Filename</a> = reCase1.GetMatch(tempHold, 1);
01958                     <a class="code" href="class_debugger.html#r21">Linenumber</a> = reCase1.GetMatch(tempHold, 3);
01959 
01960                     <a class="code" href="class_debugger.html#r21">Linenumber</a>.ToLong(&amp;tmpLong);
01961                     
01962                     outputEvent.<a class="code" href="classwx_debug_event.html#a2">SetLineNumber</a>((<span class="keywordtype">int</span>)tmpLong);
01963                     outputEvent.<a class="code" href="classwx_debug_event.html#a6">SetSourceFilename</a>(<a class="code" href="class_debugger.html#r20">Filename</a>);
01964                     outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a87">ID_DEBUG_BREAKPOINT</a>);
01965                     <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01966 
01967                     <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01968 
01969                     <a class="code" href="class_debugger.html#d5">sendWhat</a>();
01970 
01971                     noNewWhats = <span class="keyword">false</span>;
01972                     <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>;
01973                 }
01974                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(reCase2.Matches(tempHold))
01975                 {
01976                     <a class="code" href="class_debugger.html#r21">Linenumber</a> = reCase2.GetMatch(tempHold, 2);
01977     
01978                     <a class="code" href="class_debugger.html#r21">Linenumber</a>.ToLong(&amp;tmpLong);
01979                     
01980                     outputEvent.<a class="code" href="classwx_debug_event.html#a2">SetLineNumber</a>((<span class="keywordtype">int</span>)tmpLong);
01981                     outputEvent.<a class="code" href="classwx_debug_event.html#a6">SetSourceFilename</a>(<a class="code" href="class_debugger.html#r20">Filename</a>);
01982                     outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a87">ID_DEBUG_BREAKPOINT</a>);
01983                     <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01984                 }
01985                 <span class="comment">//since we can pull right through, an "else" here is no good</span>
01986             }
01987             <span class="keywordflow">else</span>
01988             {
01989                 outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a89">ID_DEBUG_EXIT_ERROR</a>);
01990                 <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
01991                 <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
01992             }
01993 
01994             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
01995 
01996             <span class="keywordflow">if</span>(noNewWhats)
01997             {
01998                 <a class="code" href="class_debugger.html#d6">sendPrint</a>(<span class="stringliteral">""</span>);
01999             }
02000             <span class="keywordflow">break</span>;
02001         }
02002         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a23">WAITING</a>:       <span class="comment">//i'm waiting...</span>
02003             <a class="code" href="class_debugger.html#r5">classStatus</a> = classStatusBackup;
02004             <span class="keywordflow">break</span>;
02005 
02006         <span class="keywordflow">case</span> <a class="code" href="cham__db_8h.html#a31a19">STOP</a>:
02007         {
02008             <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r1">procLives</a>)
02009             {
02010                 <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a28">DEBUG_ERROR</a>;
02011                 <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a19">STOP</a>;
02012                 <a class="code" href="class_debugger.html#r12">error</a> = <span class="stringliteral">"Extreme debug error OR quit-command sent before output finished: received output with ClassStatus=STOP."</span>;
02013                 <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"See previous error messages (if any)"</span>);
02014 
02015                 outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a89">ID_DEBUG_EXIT_ERROR</a>);
02016                 <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
02017                 <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
02018             }
02019             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
02020             <span class="keywordflow">break</span>;
02021         }
02022 
02023         <span class="keywordflow">default</span>:
02024             <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a28">DEBUG_ERROR</a>;
02025             <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a19">STOP</a>;
02026             <a class="code" href="class_debugger.html#r12">error</a> = <span class="stringliteral">"[classStatus] value not recognized"</span>;
02027             <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"failure on output parse:"</span>);
02028 
02029             outputEvent.SetId(<a class="code" href="datastructures_8h.html#a149a89">ID_DEBUG_EXIT_ERROR</a>);
02030             <a class="code" href="class_debugger.html#r30">guiPointer</a>-&gt;AddPendingEvent(outputEvent);
02031             <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keyword">false</span>);
02032 
02033             <a class="code" href="class_debugger.html#r17">data</a>.Empty();
02034     }
02035 }
02036 
<a name="l02049"></a><a class="code" href="class_debugger.html#d9">02049</a> <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#d9">Debugger::checkOutputStream</a>(wxString stream)
02050 {
02051     wxRegEx reCase1 = <span class="stringliteral">"at (([[:alnum:]]|[[:blank:]]|\\.)+):([[:digit:]]+)"</span>;
02052     wxString thirdCase = stream;
02053 
02054     wxString prog = <span class="stringliteral">"Program "</span>;
02055     <span class="keywordtype">int</span> progIndex = thirdCase.Find(prog);
02056 
02057     <span class="keywordflow">if</span>(progIndex != -1)
02058     {
02059         thirdCase.Remove(0,progIndex + prog.Len());
02060         <span class="keywordflow">if</span>(thirdCase.Left(8) == <span class="stringliteral">"received"</span>)
02061         {
02062             <span class="keywordtype">int</span> newlineIndex = thirdCase.find_first_of(<span class="stringliteral">"\n"</span>);
02063             thirdCase.Remove(0, newlineIndex);
02064 
02065             <span class="comment">//if we've gotten here, the program has received a message of some type.</span>
02066             <span class="comment">//either way, not good for further parsing.</span>
02067             <span class="keywordflow">if</span>(reCase1.Matches(thirdCase))
02068             {
02069                 <a class="code" href="class_debugger.html#r12">error</a> = <span class="stringliteral">"Received bad program signal.  RegEx: "</span> + reCase1.GetMatch(thirdCase, 1) + <span class="stringliteral">", "</span> + reCase1.GetMatch(thirdCase, 3);
02070                 <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"checkOutputStream:  "</span>);
02071                 <span class="keywordflow">return</span>(<span class="keyword">false</span>);
02072             }
02073             <span class="keywordflow">else</span>
02074             {
02075                 <a class="code" href="class_debugger.html#r12">error</a> = <span class="stringliteral">"Received bad program signal.  No RegEx."</span>;
02076                 <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"checkOutputStream:  "</span>);
02077                 <span class="keywordflow">return</span>(<span class="keyword">false</span>);
02078             }
02079         }
02080         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(thirdCase.Left(6) == <span class="stringliteral">"exited"</span>)
02081         {
02082             thirdCase.Remove(0,7);
02083             <span class="keywordflow">if</span>(thirdCase.Matches(<span class="stringliteral">"normal*"</span>))
02084             {
02085                 <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>;
02086                 <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a19">STOP</a>;
02087                 <span class="keywordflow">return</span>(<span class="keyword">true</span>);
02088             }
02089             <span class="keywordflow">else</span>
02090             {
02091                 <a class="code" href="class_debugger.html#r12">error</a>.Printf(<span class="stringliteral">"Program terminated abnormally.  ClassStatus %d"</span>, <a class="code" href="class_debugger.html#r5">classStatus</a>);
02092                 <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"checkOutputStream: "</span>);
02093                 <span class="keywordflow">return</span>(<span class="keyword">false</span>);
02094             }
02095         }
02096         <span class="keywordflow">else</span>
02097         {
02098             <a class="code" href="class_debugger.html#r12">error</a>.Printf(<span class="stringliteral">"Unknown program signal. ClassStatus %d"</span>, <a class="code" href="class_debugger.html#r5">classStatus</a>);
02099             <a class="code" href="class_debugger.html#d11">makeGenericError</a>(<span class="stringliteral">"checkOutputStream: "</span>);
02100             <span class="keywordflow">return</span>(<span class="keyword">false</span>);
02101         }
02102     }
02103 
02104     <span class="keywordflow">return</span>(<span class="keyword">true</span>);
02105 }
02106 
<a name="l02117"></a><a class="code" href="class_debugger.html#d14">02117</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d14">Debugger::onProcessErrOutEvent</a>(<a class="code" href="class_chameleon_process_event.html">ChameleonProcessEvent</a> &amp;e)
02118 {
02119     <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a28">DEBUG_ERROR</a>;
02120 
02121     <span class="comment">//error now has the output</span>
02122     <a class="code" href="class_debugger.html#r12">error</a> = e.<a class="code" href="class_chameleon_process_event.html#a4">GetString</a>();
02123     <a class="code" href="class_debugger.html#d12">addErrorHist</a>(<span class="stringliteral">"Event-Generated error"</span>);
02124 
02125     <span class="comment">//DEBUG CODE//</span>
02126     <span class="comment">//wxLogDebug("DB error event: %s", error);</span>
02127 }
02128 
<a name="l02139"></a><a class="code" href="class_debugger.html#d15">02139</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d15">Debugger::onProcessTermEvent</a>(<a class="code" href="class_chameleon_process_event.html">ChameleonProcessEvent</a> &amp;e) 
02140 {
02141     <span class="comment">//the process has been killed (aka GDB quit for some reason)</span>
02142     <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>;
02143     <a class="code" href="class_debugger.html#r5">classStatus</a> = <a class="code" href="cham__db_8h.html#a31a19">STOP</a>;
02144     <a class="code" href="class_debugger.html#r1">procLives</a> = <span class="keyword">false</span>;
02145 
02146     <a class="code" href="class_debugger.html#d3">flushBuffer</a>();
02147     <a class="code" href="class_debugger.html#d4">flushPrivateVar</a>();
02148 }
02149 
<a name="l02159"></a><a class="code" href="class_debugger.html#d3">02159</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d3">Debugger::flushBuffer</a>()
02160 {
02161     <a class="code" href="class_debugger.html#r17">data</a>.Clear();
02162 }
02163 
<a name="l02172"></a><a class="code" href="class_debugger.html#d4">02172</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d4">Debugger::flushPrivateVar</a>()
02173 {
02174     <a class="code" href="class_debugger.html#r0">isRemote</a> = <span class="keyword">false</span>;
02175     <a class="code" href="class_debugger.html#r1">procLives</a> = <span class="keyword">false</span>;
02176     <a class="code" href="class_debugger.html#r2">fileIsSet</a> = <span class="keyword">false</span>;
02177     <a class="code" href="class_debugger.html#r3">currFile</a> = <span class="stringliteral">""</span>;
02178     pid = 0;
02179     <a class="code" href="class_debugger.html#r8">numBreakpoints</a> = 0;
02180     <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a> = 1;
02181     <a class="code" href="class_debugger.html#r9">lineToNum</a>.empty();
02182 
02183     <a class="code" href="class_debugger.html#r10">commandHistory</a>.Empty();
02184     <a class="code" href="class_debugger.html#r11">histCount</a> = 0;
02185     <a class="code" href="class_debugger.html#r12">error</a> = <span class="stringliteral">""</span>;
02186     <a class="code" href="class_debugger.html#r13">errorHist</a>.Empty();
02187     <a class="code" href="class_debugger.html#r14">errorCount</a> = 0;
02188     <a class="code" href="class_debugger.html#r15">command</a> = <span class="stringliteral">""</span>;
02189     <a class="code" href="class_debugger.html#r16">returnChar</a> = <span class="stringliteral">""</span>;
02190     <a class="code" href="class_debugger.html#r17">data</a>.Empty();
02191 }
02192 
<a name="l02204"></a><a class="code" href="class_debugger.html#d10">02204</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d10">Debugger::sendCommand</a>(wxString send)
02205 {
02206     <span class="keywordflow">if</span>(<a class="code" href="class_debugger.html#r1">procLives</a>)
02207     {
02208         <a class="code" href="class_debugger.html#r28">streamOut</a>-&gt;WriteString(send);
02209         send = send + <span class="stringliteral">"&lt;- sent"</span>;
02210         
02211         <span class="comment">//DEBUG CODE//</span>
02212         <span class="comment">//wxLogDebug("DB send command: %s", send);</span>
02213     }
02214     <span class="keywordflow">else</span>
02215     {
02216         send = send + <span class="stringliteral">"&lt;- NOT SENT: PROC DEAD"</span>;
02217     }
02218     <a class="code" href="class_debugger.html#d1">updateHistory</a>(send);
02219 }
02220 
<a name="l02232"></a><a class="code" href="class_debugger.html#d11">02232</a> <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d11">Debugger::makeGenericError</a>(wxString comment)
02233 {
02234     <a class="code" href="class_debugger.html#r4">status</a> = <a class="code" href="cham__db_8h.html#a32a28">DEBUG_ERROR</a>;   <span class="comment">//if not already set...</span>
02235     <a class="code" href="class_debugger.html#d12">addErrorHist</a>(comment);
02236 }
02237 
02238 <span class="comment">//addErrorHist(): updates the error history</span>
<a name="l02251"></a><a class="code" href="class_debugger.html#d12">02251</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d12">Debugger::addErrorHist</a>(wxString comment)
02252 {
02253     <a class="code" href="class_debugger.html#r14">errorCount</a>++;
02254     <a class="code" href="class_debugger.html#r13">errorHist</a>.Add(comment + <span class="stringliteral">"-&gt; "</span> + <a class="code" href="class_debugger.html#r12">error</a>);
02255 }
02256 
02257 <span class="comment">//updateHistory: updates the history storage and pointer</span>
<a name="l02269"></a><a class="code" href="class_debugger.html#d1">02269</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d1">Debugger::updateHistory</a>(wxString addMe)
02270 {
02271     <a class="code" href="class_debugger.html#r10">commandHistory</a>.Add(addMe);
02272     <a class="code" href="class_debugger.html#r11">histCount</a>++;
02273 }
02274 
<a name="l02285"></a><a class="code" href="class_debugger.html#d2">02285</a> wxString <a class="code" href="class_debugger.html#d2">Debugger::getHistoryItem</a>(<span class="keywordtype">int</span> offset = 0)
02286 {
02287     <span class="keywordflow">if</span>(offset &gt; <a class="code" href="class_debugger.html#r11">histCount</a>)
02288     {
02289         offset = <a class="code" href="class_debugger.html#r11">histCount</a>;
02290     }
02291     <span class="keywordflow">return</span>(<a class="code" href="class_debugger.html#r10">commandHistory</a>[offset]);
02292 }
02293 <span class="comment">//eof</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 28 16:45:37 2004 for Chameleon by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
