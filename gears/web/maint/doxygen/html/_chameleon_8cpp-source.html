<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Chameleon: Chameleon.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>Chameleon.cpp</h1><a href="_chameleon_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre><a name="l00001"></a><a class="code" href="_chameleon_8cpp.html#a0">00001</a> <span class="preprocessor">#define CHAMELEON__CPP</span>
00002 <span class="preprocessor"></span>
<a name="l00003"></a><a class="code" href="_chameleon_8cpp.html#a1">00003</a> <span class="preprocessor">#define _CRTDBG_MAP_ALLOC</span>
00004 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00005 <span class="preprocessor">#include &lt;crtdbg.h&gt;</span>
00006 
00007 <span class="preprocessor">#include "<a class="code" href="_chameleon_window_8h.html">ChameleonWindow.h</a>"</span>
00008 <span class="preprocessor">#include &lt;wx/statusbr.h&gt;</span>
00009 <span class="preprocessor">#include &lt;wx/choicdlg.h&gt;</span>
00010 <span class="preprocessor">#include &lt;wx/msgdlg.h&gt;</span>
00011 <span class="preprocessor">#include &lt;wx/msw/tbar95.h&gt;</span>
00012 <span class="preprocessor">#include &lt;wx/print.h&gt;</span>
00013 <span class="preprocessor">#include &lt;wx/printdlg.h&gt;</span>
00014 <span class="preprocessor">#include &lt;wx/mimetype.h&gt;</span>
00015 
00016 <span class="preprocessor">#include &lt;math.h&gt;</span>
00017 
00018 <span class="preprocessor">#include "../common/fixvsbug.h"</span>
00019 <span class="preprocessor">#include "../editor/editor.h"</span>
00020 <span class="preprocessor">#include "<a class="code" href="_chameleon_notebook_8h.html">ChameleonNotebook.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="_options_dialog_8h.html">dialogs/OptionsDialog.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="_remote_file_dialog_8h.html">dialogs/RemoteFileDialog.h</a>"</span>
00023 <span class="preprocessor">#include "<a class="code" href="wx_term_container_8h.html">dialogs/wxTermContainer.h</a>"</span>
00024 <span class="preprocessor">#include "<a class="code" href="_variable_watch_panel_8h.html">dialogs/VariableWatchPanel.h</a>"</span>
00025 <span class="preprocessor">#include "<a class="code" href="_compiler_output_panel_8h.html">dialogs/CompilerOutputPanel.h</a>"</span>
00026 <span class="preprocessor">#include "<a class="code" href="_about_chameleon_dialog_8h.html">dialogs/AboutChameleonDialog.h</a>"</span>
00027 <span class="preprocessor">#include "../common/ChameleonPrintout.h"</span>
00028 <span class="preprocessor">#include "../perms/p.h"</span>
00029 <span class="preprocessor">#include "../common/ProjectInfo.h"</span>
00030 <span class="preprocessor">#include "../network/networking.h"</span>
00031 <span class="preprocessor">#include "../compiler/compiler.h"</span>
00032 <span class="preprocessor">#include "../common/Options.h"</span>
00033 <span class="preprocessor">#include "../debugger/cham_db.h"</span>
00034 <span class="preprocessor">#include "../common/DebugEvent.h"</span>
00035 <span class="preprocessor">#include "<a class="code" href="wxssh_8h.html">wxssh.h</a>"</span>
00036 <span class="preprocessor">#include "../compiler/compilerevent.h"</span>
00037 
00038 <span class="preprocessor">#include "newfile.xpm"</span>
00039 <span class="preprocessor">#include "openremote.xpm"</span>
00040 <span class="preprocessor">#include "openlocal.xpm"</span>
00041 <span class="preprocessor">#include "savefile.xpm"</span>
00042 
00043 <span class="preprocessor">#include "build.xpm"</span>
00044 <span class="preprocessor">#include "compilestop.xpm"</span>
00045 <span class="preprocessor">#include "button.xpm"</span>
00046 
00047 <span class="preprocessor">#include "connect16.xpm"</span>
00048 <span class="preprocessor">#include "disconnect16.xpm"</span>
00049 
00050 <span class="preprocessor">#include "newstart1.xpm"</span>
00051 <span class="preprocessor">#include "newcontinue1.xpm"</span>
00052 <span class="preprocessor">#include "newstop1.xpm"</span>
00053 <span class="preprocessor">#include "stepnext.xpm"</span>
00054 <span class="preprocessor">#include "stepout.xpm"</span>
00055 <span class="preprocessor">#include "stepover.xpm"</span>
00056 
00057 <span class="preprocessor">#include "../common/debug.h"</span>
00058 
00059 <span class="preprocessor">#ifdef _DEBUG</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#define new DEBUG_NEW</span>
00061 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00062 <span class="preprocessor"></span>
00063 
<a name="l00065"></a><a class="code" href="_chameleon_8cpp.html#a2">00065</a> wxPrintData *<a class="code" href="_chameleon_printout_8cpp.html#a0">g_printData</a> = (wxPrintData*) <a class="code" href="_crc16_8h.html#a0">NULL</a>;
<a name="l00066"></a><a class="code" href="_chameleon_8cpp.html#a3">00066</a> wxPageSetupData *<a class="code" href="_chameleon_printout_8cpp.html#a1">g_pageSetupData</a> = (wxPageSetupData*) <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00067 
00068 BEGIN_EVENT_TABLE(<a class="code" href="class_chameleon_window.html">ChameleonWindow</a>, wxFrame)
00069     EVT_MENU                        (ID_NEW_SOURCE, ChameleonWindow::OnMenuEvent)
00070     EVT_MENU_RANGE                  (ID_OPEN_SOURCE_LOCAL, ID_OPEN_SOURCE_REMOTE, ChameleonWindow::OnMenuEvent)
00071     EVT_MENU                        (ID_QUIT,  ChameleonWindow::OnMenuEvent)
00072     EVT_MENU                        (ID_ABOUT, ChameleonWindow::OnMenuEvent)
00073     EVT_MENU                        (ID_TEST, ChameleonWindow::Test)
00074     EVT_MENU                        (ID_SAVE, ChameleonWindow::OnMenuEvent)
00075     EVT_MENU_RANGE                  (ID_SAVE_SOURCE_LOCAL, ID_SAVE_SOURCE_REMOTE, ChameleonWindow::OnMenuEvent)
00076     EVT_MENU                        (ID_CLOSEPAGE, ChameleonWindow::OnMenuEvent)
00077     EVT_MENU                        (ID_CLOSETAB, ChameleonWindow::OnMenuEvent)
00078     EVT_MENU                        (ID_CLOSEALL, ChameleonWindow::OnMenuEvent)
00079     EVT_MENU                        (ID_STARTCONNECT, ChameleonWindow::OnMenuEvent)
00080     EVT_MENU                        (ID_DISCONNECT, ChameleonWindow::OnMenuEvent)
00081     EVT_MENU_RANGE                  (ID_COMPILE, ID_COMPILE_PROJECT, ChameleonWindow::OnMenuEvent)
00082     EVT_MENU                        (ID_UNDO, ChameleonWindow::OnMenuEvent)
00083     EVT_MENU                        (ID_REDO, ChameleonWindow::OnMenuEvent)
00084     EVT_MENU                        (ID_OPTIONS, ChameleonWindow::OnMenuEvent)
00085     EVT_MENU                        (ID_CUT, ChameleonWindow::OnMenuEvent)
00086     EVT_MENU                        (ID_COPY, ChameleonWindow::OnMenuEvent)
00087     EVT_MENU                        (ID_PASTE, ChameleonWindow::OnMenuEvent)
00088     EVT_MENU                        (ID_FIND, ChameleonWindow::OnMenuEvent)
00089     EVT_MENU                        (ID_REPLACE, ChameleonWindow::OnMenuEvent)
00090     EVT_FIND                        (-1, ChameleonWindow::OnFindEvent)
00091     EVT_FIND_NEXT                   (-1, ChameleonWindow::OnFindEvent)
00092     EVT_FIND_REPLACE                (-1, ChameleonWindow::OnFindEvent)
00093     EVT_FIND_REPLACE_ALL            (-1, ChameleonWindow::OnFindEvent)
00094     EVT_FIND_CLOSE                  (-1, ChameleonWindow::OnFindEvent)
00095     EVT_CLOSE                       (ChameleonWindow::OnClose)
00096     EVT_NOTEBOOK_PAGE_CHANGED       (ID_NOTEBOOK_ED,   ChameleonWindow::OnPageChange)
00097     EVT_SPLITTER_SASH_POS_CHANGED   (ID_SPLITEDITOROUTPUT, ChameleonWindow::OnTermResize)
00098     EVT_SIZE                        (ChameleonWindow::OnSize)
00099     EVT_SPLITTER_DCLICK             (ID_SPLITPROJECTEDITOR, ChameleonWindow::OnSplitterDoubleClick)
00100     EVT_SPLITTER_DCLICK             (ID_SPLITEDITOROUTPUT, ChameleonWindow::OnSplitterDoubleClick)
00101     EVT_TREE_ITEM_RIGHT_CLICK       (ID_PROJECTTREE, ChameleonWindow::OnTreeItemRightClick)
00102     EVT_MENU                        (ID_PROJECT_ADDFILE, ChameleonWindow::OnMenuEvent)
00103     EVT_MENU                        (ID_PROJECT_REMOVEFILE, ChameleonWindow::OnMenuEvent)
00104     EVT_MENU                        (ID_PROJECT_EXCLUDE_FILE, ChameleonWindow::OnMenuEvent)
00105     EVT_MENU                        (ID_PROJECT_INCLUDE_FILE, ChameleonWindow::OnMenuEvent)
00106     EVT_TREE_ITEM_ACTIVATED         (ID_PROJECTTREE, ChameleonWindow::OnTreeItemActivated)
00107     EVT_MENU                        (ID_NEW_PROJECT, ChameleonWindow::OnMenuEvent)
00108     EVT_MENU                        (ID_OPEN_PROJECT_LOCAL, ChameleonWindow::OnMenuEvent)
00109     EVT_MENU                        (ID_OPEN_PROJECT_REMOTE, ChameleonWindow::OnMenuEvent)
00110     EVT_MENU                        (ID_PRINT_PAGE, ChameleonWindow::OnMenuEvent)
00111     EVT_MENU                        (ID_PRINT_PREVIEW, ChameleonWindow::OnMenuEvent)
00112     EVT_MENU                        (ID_PRINT_SETUP, ChameleonWindow::OnMenuEvent)
00113     EVT_MENU                        (ID_CLOSE_PROJECT, ChameleonWindow::OnMenuEvent)    
00114     EVT_MENU                        (ID_DEBUG_START, ChameleonWindow::OnDebugCommand)
00115     EVT_MENU                        (ID_DEBUG_CONTINUE, ChameleonWindow::OnDebugCommand)
00116     EVT_MENU                        (ID_DEBUG_STOP, ChameleonWindow::OnDebugCommand)
00117     EVT_MENU                        (ID_DEBUG_STEPNEXT, ChameleonWindow::OnDebugCommand)
00118     EVT_MENU                        (ID_DEBUG_STEPOVER, ChameleonWindow::OnDebugCommand)
00119     EVT_MENU                        (ID_DEBUG_STEPOUT, ChameleonWindow::OnDebugCommand)
00120     <a class="code" href="_debug_event_8h.html#a0">EVT_DEBUG</a>                       (ChameleonWindow::OnDebugEvent)
00121     EVT_IDLE                        (ChameleonWindow::OnIdle)
00122     EVT_TIMER                       (ID_STATUSTIMER, ChameleonWindow::OnStatusTimer)
00123     EVT_MENU                        (ID_HELP, ChameleonWindow::OnMenuEvent)
00124 END_EVENT_TABLE()
00125 
00126 IMPLEMENT_APP(<a class="code" href="class_my_app.html">MyApp</a>)
00127 <span class="comment">//----------------------------------------------------------------------</span>
00128 <span class="comment">// `Main program' equivalent: the program execution "starts" here</span>
00129 
<a name="l00130"></a><a class="code" href="class_my_app.html#a1">00130</a> <span class="keywordtype">bool</span> <a class="code" href="class_my_app.html#a1">MyApp::OnInit</a>()
00131 {
00132     <a class="code" href="class_chameleon_window.html">ChameleonWindow</a> *frame = <span class="keyword">new</span> <a class="code" href="class_chameleon_window.html">ChameleonWindow</a>(<span class="stringliteral">"Chameleon"</span>,
00133                                  wxPoint(5, 5), wxSize(400, 300));
00134 
00135     frame-&gt;Show(TRUE);
00136     <span class="keywordflow">return</span> TRUE;
00137 }
00138 
<a name="l00139"></a><a class="code" href="class_my_app.html#a0">00139</a> <a class="code" href="class_my_app.html#a0">MyApp::~MyApp</a>()
00140 {
00141 }
00142 
00143 <span class="comment">//----------------------------------------------------------------------</span>
00144 
00145 
00146 <span class="preprocessor">#pragma hdrstop</span>
00147 <span class="preprocessor"></span>
<a name="l00160"></a><a class="code" href="class_chameleon_window.html#a0">00160</a> <a class="code" href="class_chameleon_window.html#a0">ChameleonWindow::ChameleonWindow</a>(<span class="keyword">const</span> wxString&amp; title, <span class="keyword">const</span> wxPoint&amp; pos, <span class="keyword">const</span> wxSize&amp; size)
00161        : wxFrame((wxFrame *)<a class="code" href="_crc16_8h.html#a0">NULL</a>, -1, title, pos, size)
00162 {   
00163     <span class="comment">// should be approximately 80x15 for the terminal</span>
00164     this-&gt;SetSize(800, 600);
00165 
00166     <span class="comment">// Show a log window for all debug messages</span>
00167 <span class="preprocessor">#ifdef _DEBUG</span>
00168 <span class="preprocessor"></span>    <a class="code" href="class_chameleon_window.html#r0">logWindow</a> = <span class="keyword">new</span> wxLogWindow(<span class="keyword">this</span>, <span class="stringliteral">"Debug messages"</span>);
00169     wxLog::SetActiveTarget(<a class="code" href="class_chameleon_window.html#r0">logWindow</a>);
00170 <span class="preprocessor">#endif</span>
00171 <span class="preprocessor"></span>
00172     <a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00173 
00174     wxIcon icon(wxICON(IDI_APPICON));
00175     SetIcon(icon);
00176     
00177     m_remoteMode = <span class="keyword">true</span>;
00178 
00179     <span class="comment">// Open up the configuration file, assumed to be in the user's home directory</span>
00180 
00181     wxString authorizedCode = <span class="stringliteral">"0"</span>;
00182     wxString enabledCode = <span class="stringliteral">"0"</span>;
00183 
00184     <span class="comment">// by default, enable nothing</span>
00185     wxString defaultAuthorizedCode = <span class="stringliteral">"10A80000000"</span>;
00186     wxString defaultEnableCode = <span class="stringliteral">"0"</span>;
00187 
00188     m_options = <span class="keyword">new</span> <a class="code" href="class_options.html">Options</a>();
00189 
00190     <a class="code" href="class_permission.html">Permission</a>* perms = m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>();
00191 
00192     wxFileName configName(wxGetHomeDir(), <span class="stringliteral">"chameleon.ini"</span>);
00193 
00194     <a class="code" href="class_chameleon_window.html#r17">m_config</a> = <span class="keyword">new</span> wxFileConfig(<span class="stringliteral">"Chameleon"</span>, wxEmptyString, configName.GetFullPath());
00195 
00196     <span class="keywordflow">if</span>(configName.FileExists())
00197     {
00198         m_options-&gt;<a class="code" href="class_options.html#a6">SetHostname</a>(<a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Read(<span class="stringliteral">"Network/hostname"</span>));
00199         m_options-&gt;<a class="code" href="class_options.html#a5">SetUsername</a>(<a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Read(<span class="stringliteral">"Network/username"</span>));
00200         m_options-&gt;<a class="code" href="class_options.html#a4">SetMingwPath</a>(<a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Read(<span class="stringliteral">"Compiler/mingwpath"</span>));
00201 
00202         <span class="keywordtype">bool</span> printInColor = (<a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Read(<span class="stringliteral">"Miscellaneous/PrintInColor"</span>, <span class="stringliteral">"true"</span>) == <span class="stringliteral">"true"</span>);
00203         <span class="keywordtype">int</span> printStyle = printInColor ? <a class="code" href="_options_8h.html#a1">wxSTC_PRINT_COLOURONWHITE</a> : <a class="code" href="_options_8h.html#a0">wxSTC_PRINT_BLACKONWHITE</a>;
00204         m_options-&gt;<a class="code" href="class_options.html#a10">SetPrintStyle</a>(printStyle);
00205 
00206         <span class="keywordtype">bool</span> showToolbarText = (<a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Read(<span class="stringliteral">"Interface/ShowToolbarText"</span>, <span class="stringliteral">"true"</span>) == <span class="stringliteral">"true"</span>);
00207         m_options-&gt;<a class="code" href="class_options.html#a11">SetShowToolbarText</a>(showToolbarText);
00208         <span class="keywordtype">int</span> terminalHistory = <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Read(<span class="stringliteral">"Miscellaneous/TerminalHistory"</span>, 100);
00209         
00210         authorizedCode = <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Read(<span class="stringliteral">"Permissions/authorized"</span>, defaultAuthorizedCode);
00211         enabledCode = <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Read(<span class="stringliteral">"Permissions/enabled"</span>, defaultEnableCode);
00212         
00213                 
00214     }
00215     <span class="keywordflow">else</span>
00216     {
00217         wxLogDebug(<span class="stringliteral">"Failed to locate config file, loading default permissions"</span>);
00218         authorizedCode = defaultAuthorizedCode;
00219         enabledCode = defaultEnableCode;
00220 
00221         <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Network/hostname"</span>, wxEmptyString);
00222         <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Network/username"</span>, wxEmptyString);
00223         <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Permissions/authorized"</span>, defaultAuthorizedCode);
00224         <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Permissions/enabled"</span>, defaultEnableCode);
00225     }
00226 
00227     <span class="keywordflow">if</span>(authorizedCode == wxEmptyString)
00228     {
00229         authorizedCode = defaultAuthorizedCode;
00230     }
00231     <span class="keywordflow">if</span>(enabledCode == wxEmptyString)
00232     {
00233         enabledCode = defaultEnableCode;
00234     }
00235 
00236     <span class="keywordflow">if</span>(!perms-&gt;<a class="code" href="class_permission.html#a8">setGlobalAuthorized</a>(authorizedCode))
00237     {
00238         wxLogDebug(<span class="stringliteral">"Authcode initialization failed!  Code: %s"</span>, authorizedCode.c_str());
00239     }
00240     <span class="keywordflow">else</span>
00241     {
00242         perms-&gt;<a class="code" href="class_permission.html#a9">setGlobalEnabled</a>(enabledCode);
00243     }
00244     
00245     wxFileName plinkPath(wxGetCwd(), <span class="stringliteral">"plink.exe"</span>);
00246     m_options-&gt;<a class="code" href="class_options.html#a3">SetPlinkApp</a>(plinkPath.GetFullPath());
00247 
00248     wxFileName pscpPath(wxGetCwd(), <span class="stringliteral">"pscp.exe"</span>);  
00249     m_options-&gt;<a class="code" href="class_options.html#a2">SetPscpApp</a>(pscpPath.GetFullPath());
00250 
00251     m_network = <span class="keyword">new</span> <a class="code" href="class_networking.html">Networking</a>(m_options);
00252     <a class="code" href="class_chameleon_window.html#r25">m_compiler</a> = <span class="keyword">new</span> <a class="code" href="class_compiler.html">Compiler</a>(m_options, m_network);
00253     <a class="code" href="class_chameleon_window.html#r28">m_debugger</a> = <span class="keyword">new</span> <a class="code" href="class_debugger.html">Debugger</a>(m_network, <span class="keyword">this</span>);
00254 
00255     <a class="code" href="class_chameleon_window.html#r14">m_optionsDialog</a> = <span class="keyword">new</span> <a class="code" href="class_options_dialog.html">OptionsDialog</a>(<span class="keyword">this</span>, m_options, <a class="code" href="datastructures_8h.html#a149a34">ID_OPTIONSDIALOG</a>, <span class="stringliteral">"Options"</span>);
00256 
00257     <a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a> = <span class="keyword">new</span> wxSplitterWindow(<span class="keyword">this</span>, <a class="code" href="datastructures_8h.html#a149a31">ID_SPLITEDITOROUTPUT</a>);
00258     <a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a> = <span class="keyword">new</span> wxSplitterWindow(<a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>, <a class="code" href="datastructures_8h.html#a149a32">ID_SPLITPROJECTEDITOR</a>);
00259     <a class="code" href="class_chameleon_window.html#r1">m_book</a> = <span class="keyword">new</span> <a class="code" href="class_chameleon_notebook.html">ChameleonNotebook</a>(<a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>, <a class="code" href="datastructures_8h.html#a149a23">ID_NOTEBOOK_ED</a>);
00260 
00261     <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a> = <span class="keyword">new</span> ChameleonNotebook(<a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>, <a class="code" href="datastructures_8h.html#a149a24">ID_NOTEBOOK_TERM</a>);
00262     <a class="code" href="class_chameleon_window.html#r9">m_termContainer</a> = <span class="keyword">new</span> <a class="code" href="classwx_term_container.html">wxTermContainer</a>(<a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>, <a class="code" href="datastructures_8h.html#a149a25">ID_CONTAINER_TERM</a>);
00263     <a class="code" href="class_chameleon_window.html#r10">m_debugTermContainer</a> = <span class="keyword">new</span> wxTermContainer(<a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>, <a class="code" href="datastructures_8h.html#a149a26">ID_CONTAINER_DEBUGTERM</a>);
00264 
00265     <a class="code" href="class_chameleon_window.html#r12">m_terminal</a> = <span class="keyword">new</span> <a class="code" href="classwx_s_s_h.html">wxSSH</a>(<a class="code" href="class_chameleon_window.html#r9">m_termContainer</a>, <a class="code" href="datastructures_8h.html#a149a30">ID_TERMINAL</a>, m_network, wxPoint(0, 0));
00266     <a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="class_g_term.html#a21">set_mode_flag</a>(GTerm::CURSORINVISIBLE);
00267     <a class="code" href="class_chameleon_window.html#r9">m_termContainer</a>-&gt;<a class="code" href="classwx_term_container.html#a4">SetTerminal</a>(<a class="code" href="class_chameleon_window.html#r12">m_terminal</a>);   
00268 
00269     <a class="code" href="class_chameleon_window.html#r13">m_debugTerminal</a> = <span class="keyword">new</span> wxSSH(<a class="code" href="class_chameleon_window.html#r10">m_debugTermContainer</a>, <a class="code" href="datastructures_8h.html#a149a40">ID_DEBUGTERMINAL</a>, m_network, wxPoint(0, 0));
00270     <a class="code" href="class_chameleon_window.html#r13">m_debugTerminal</a>-&gt;<a class="code" href="class_g_term.html#a21">set_mode_flag</a>(GTerm::CURSORINVISIBLE);
00271     <a class="code" href="class_chameleon_window.html#r10">m_debugTermContainer</a>-&gt;<a class="code" href="classwx_term_container.html#a4">SetTerminal</a>(<a class="code" href="class_chameleon_window.html#r13">m_debugTerminal</a>);
00272 
00273     <a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a> = <span class="keyword">new</span> <a class="code" href="class_compiler_output_panel.html">CompilerOutputPanel</a>(<a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>, <span class="keyword">this</span>, <a class="code" href="datastructures_8h.html#a149a38">ID_COMPILEROUTPUT</a>);
00274     <a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>-&gt;<a class="code" href="class_compiler_output_panel.html#a8">SetAdvanced</a>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a98">PERM_ADVANCEDCOMPILE</a>));
00275 
00276     <a class="code" href="class_chameleon_window.html#r11">m_watchPanel</a> = <span class="keyword">new</span> <a class="code" href="class_variable_watch_panel.html">VariableWatchPanel</a>(<a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>, <span class="keyword">this</span>, <a class="code" href="datastructures_8h.html#a149a39">ID_VARWATCHPANEL</a>);
00277 
00278     <span class="comment">// project setup</span>
00279     <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00280     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a> = <span class="keyword">new</span> wxTreeCtrl(<a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>, <a class="code" href="datastructures_8h.html#a149a33">ID_PROJECTTREE</a>);
00281     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;Hide();
00282 
00283     <a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a> = <span class="keyword">new</span> <a class="code" href="class_remote_file_dialog.html">RemoteFileDialog</a>(<span class="keyword">this</span>, <a class="code" href="datastructures_8h.html#a149a35">ID_REMOTEFILEDIALOG</a>);
00284     <a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a>-&gt;<a class="code" href="class_remote_file_dialog.html#a12">SetNetworking</a>(m_network);
00285 
00286     wxTreeItemId rootNode = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;AddRoot(<span class="stringliteral">"No project open"</span>, <a class="code" href="datastructures_8h.html#a151a103">ICON_FOLDERCLOSED</a>, <a class="code" href="datastructures_8h.html#a151a104">ICON_FOLDEROPEN</a>);
00287     <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[0] = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;AppendItem(rootNode, <span class="stringliteral">"Source files"</span>, <a class="code" href="datastructures_8h.html#a151a103">ICON_FOLDERCLOSED</a>, <a class="code" href="datastructures_8h.html#a151a104">ICON_FOLDEROPEN</a>);
00288     <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[1] = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;AppendItem(rootNode, <span class="stringliteral">"Header files"</span>, <a class="code" href="datastructures_8h.html#a151a103">ICON_FOLDERCLOSED</a>, <a class="code" href="datastructures_8h.html#a151a104">ICON_FOLDEROPEN</a>);
00289     <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[2] = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;AppendItem(rootNode, <span class="stringliteral">"Libraries"</span>, <a class="code" href="datastructures_8h.html#a151a103">ICON_FOLDERCLOSED</a>, <a class="code" href="datastructures_8h.html#a151a104">ICON_FOLDEROPEN</a>);
00290 
00291     <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a> = 0;
00292     <a class="code" href="class_chameleon_window.html#r31">m_fileNum</a> = 0;
00293 
00294     <a class="code" href="class_chameleon_window.html#r34">m_appClosing</a> = <span class="keyword">false</span>;
00295     <a class="code" href="class_chameleon_window.html#r35">m_setSelection</a> = <span class="keyword">false</span>;
00296 
00297     <span class="keywordtype">int</span> charWidth = GetCharWidth();
00298 
00299     <span class="keywordtype">int</span> fileNameChars = 55;
00300     <span class="keywordtype">int</span> locationChars = 6;  
00301     <span class="keywordtype">int</span> readEditChars = 9;
00302     <span class="keywordtype">int</span> networkStatusChars = 25;
00303     <span class="keywordtype">int</span> lineColChars = 15;
00304 
00305     <span class="keyword">const</span> <span class="keywordtype">int</span> widths[] = {fileNameChars * charWidth, locationChars * charWidth, readEditChars * charWidth, 
00306                             networkStatusChars * charWidth, lineColChars * charWidth};
00307     <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a> = CreateStatusBar (WXSIZEOF(widths), wxST_SIZEGRIP);
00308     <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a>-&gt;SetStatusWidths (WXSIZEOF(widths), widths);
00309     SendSizeEvent();
00310 
00311     <a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a> = <span class="keyword">new</span> wxTimer (<span class="keyword">this</span>, <a class="code" href="datastructures_8h.html#a149a57">ID_STATUSTIMER</a>);
00312 
00313     <a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>-&gt;Initialize(<a class="code" href="class_chameleon_window.html#r1">m_book</a>);
00314     <a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>-&gt;Initialize(<a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>);
00315     <a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>-&gt;Show();
00316     <a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>-&gt;Show();
00317     <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Show();
00318     <a class="code" href="class_chameleon_window.html#d42">EvaluateOptions</a>();
00319     
00320     <span class="comment">// create the initial blank open file</span>
00321     <a class="code" href="class_chameleon_window.html#d21">NewFile</a>();
00322     <a class="code" href="class_chameleon_window.html#d28">PageHasChanged</a>(<a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>);
00323 
00324     <a class="code" href="class_chameleon_window.html#r40">m_filterCPPFiles</a> = <span class="stringliteral">"C++ source files (*.cpp, *.c)|*.cpp;*.c"</span>;
00325     <a class="code" href="class_chameleon_window.html#r41">m_filterHeaderFiles</a> += <span class="stringliteral">"C++ header files (*.h, *.hpp)|*.h;*.hpp"</span>;   
00326     <a class="code" href="class_chameleon_window.html#r42">m_filterProjectFiles</a> = <span class="stringliteral">"Chameleon project files (*.cpj)|*.cpj"</span>;
00327 
00328     <span class="comment">// If this ever gets ported to Linux, we'd probably want to add</span>
00329     <span class="comment">// Linux library extensions here (.a, .so).  The other issue is that</span>
00330     <span class="comment">// the remote file dialog only looks in ~, which might need to be changed.</span>
00331     <a class="code" href="class_chameleon_window.html#r43">m_filterLibraryFiles</a> = <span class="stringliteral">"C++ libraries (*.lib)|*.lib"</span>; 
00332     <a class="code" href="class_chameleon_window.html#r44">m_filterAllFiles</a> = <span class="stringliteral">"All files (*.*)|*.*"</span>;
00333 
00334     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"cpj"</span>] = <a class="code" href="datastructures_8h.html#a151a102">ICON_PROJECT</a>;
00335     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"c"</span>] = <a class="code" href="datastructures_8h.html#a151a105">ICON_SOURCE_C</a>;
00336     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"cpp"</span>] = <a class="code" href="datastructures_8h.html#a151a106">ICON_SOURCE_CPP</a>;
00337     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"h"</span>] = <a class="code" href="datastructures_8h.html#a151a107">ICON_SOURCE_H</a>;
00338     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"hpp"</span>] = <a class="code" href="datastructures_8h.html#a151a107">ICON_SOURCE_H</a>;
00339     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"lib"</span>] = <a class="code" href="datastructures_8h.html#a151a108">ICON_LIBRARY</a>;
00340     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"c_disabled"</span>] = <a class="code" href="datastructures_8h.html#a151a109">ICON_DISABLED_SOURCE_C</a>;
00341     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"cpp_disabled"</span>] = <a class="code" href="datastructures_8h.html#a151a110">ICON_DISABLED_SOURCE_CPP</a>;
00342     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"h_disabled"</span>] = <a class="code" href="datastructures_8h.html#a151a111">ICON_DISABLED_SOURCE_H</a>;
00343     <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[<span class="stringliteral">"hpp_disabled"</span>] = <a class="code" href="datastructures_8h.html#a151a111">ICON_DISABLED_SOURCE_H</a>;
00344 
00345     <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00346 
00347     <a class="code" href="class_chameleon_window.html#r16">m_findReplace</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00348 
00349     <a class="code" href="_chameleon_printout_8cpp.html#a0">g_printData</a> = <span class="keyword">new</span> wxPrintData;
00350     <a class="code" href="_chameleon_printout_8cpp.html#a1">g_pageSetupData</a> = <span class="keyword">new</span> wxPageSetupDialogData;
00351 
00352     <a class="code" href="_chameleon_printout_8cpp.html#a0">g_printData</a>-&gt;SetPaperId(wxPAPER_LETTER);
00353 
00354     <a class="code" href="class_chameleon_window.html#r37">m_appStarting</a> = <span class="keyword">false</span>;
00355     <a class="code" href="class_chameleon_window.html#r39">m_compileProject</a> = <span class="keyword">false</span>;
00356 }
00357 
<a name="l00368"></a><a class="code" href="class_chameleon_window.html#a1">00368</a> <a class="code" href="class_chameleon_window.html#a1">ChameleonWindow::~ChameleonWindow</a>()
00369 {
00370     <span class="comment">// make sure the config file got written to disk</span>
00371     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Flush();
00372 
00373     <span class="keyword">delete</span> <a class="code" href="_chameleon_printout_8cpp.html#a0">g_printData</a>;
00374     <span class="keyword">delete</span> <a class="code" href="_chameleon_printout_8cpp.html#a1">g_pageSetupData</a>;
00375 
00376     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r16">m_findReplace</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
00377     {
00378         <span class="keyword">delete</span> <a class="code" href="class_chameleon_window.html#r16">m_findReplace</a>;
00379     }
00380 
00381     <span class="keywordflow">if</span> (<a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a>) 
00382     {
00383         <span class="keyword">delete</span> <a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a>;
00384         <a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00385     }
00386 
00387     <span class="comment">// (hopefully) fixes some issues with widgets not getting deleted for some reason</span>
00388     <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;DestroyChildren();  
00389 
00390     <span class="keyword">delete</span> <a class="code" href="class_chameleon_window.html#r14">m_optionsDialog</a>;
00391     <span class="keyword">delete</span> <a class="code" href="class_chameleon_window.html#r25">m_compiler</a>;
00392     <span class="keyword">delete</span> <a class="code" href="class_chameleon_window.html#r17">m_config</a>;
00393     <span class="keyword">delete</span> m_options;
00394     <span class="keyword">delete</span> <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>;
00395     <span class="keyword">delete</span> m_network;   
00396 }
00397 
<a name="l00408"></a><a class="code" href="class_chameleon_window.html#d4">00408</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d4">ChameleonWindow::OnClose</a>(wxCloseEvent &amp;event) 
00409 {
00410     <a class="code" href="class_chameleon_window.html#r34">m_appClosing</a> = <span class="keyword">true</span>;
00411 
00412     <a class="code" href="class_chameleon_window.html#d26">CloseAllFiles</a>();
00413 
00414     <span class="comment">// double check in case something went wrong</span>
00415     <span class="keywordflow">if</span> (<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a> &amp;&amp; <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a6">Modified</a>()) 
00416     {
00417         <span class="keywordflow">if</span> (event.CanVeto())
00418         {
00419             event.Veto (<span class="keyword">true</span>);
00420         }
00421 
00422         <span class="keywordflow">return</span>;
00423     }
00424 
00425     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
00426     {
00427         <a class="code" href="class_chameleon_window.html#d35">CloseProjectFile</a>();
00428     }
00429 
00430     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a>)
00431     {
00432         <a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a>-&gt;Stop();
00433     }
00434 
00435     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a9">IsConnected</a>())
00436     {
00437         <a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a8">Disconnect</a>();
00438     }
00439 
00440     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r13">m_debugTerminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a9">IsConnected</a>())
00441     {
00442         <a class="code" href="class_chameleon_window.html#r13">m_debugTerminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a8">Disconnect</a>();
00443     }
00444 
00445     Destroy();
00446 }
00447 
00448 <span class="comment">// Main menu and debug stuff begins here</span>
00449 
<a name="l00460"></a><a class="code" href="class_chameleon_window.html#d1">00460</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d1">ChameleonWindow::OnMenuEvent</a>(wxCommandEvent &amp;event)
00461 {
00462     <span class="keywordtype">int</span> <span class="keywordtype">id</span> = event.GetId();
00463 
00464     <span class="keywordflow">switch</span>(<span class="keywordtype">id</span>)
00465     {
00466         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a7">ID_NEW_SOURCE</a>:
00467             <a class="code" href="class_chameleon_window.html#d21">NewFile</a>();
00468             <span class="keywordflow">break</span>;
00469 
00470         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a11">ID_OPEN_SOURCE_LOCAL</a>:
00471         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a12">ID_OPEN_SOURCE_REMOTE</a>:
00472         {
00473             <span class="keywordflow">if</span>( <span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a11">ID_OPEN_SOURCE_LOCAL</a>)
00474             {
00475                 m_remoteMode = <span class="keyword">false</span>;
00476             }
00477             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a12">ID_OPEN_SOURCE_REMOTE</a>)
00478             {
00479                 m_remoteMode = <span class="keyword">true</span>;
00480             }
00481 
00482             wxArrayString fnames = <a class="code" href="class_chameleon_window.html#d22">OpenFile</a>(<a class="code" href="datastructures_8h.html#a156a129">FILE_ALLSOURCETYPES</a>);
00483 
00484             <span class="keywordflow">if</span>(fnames.Count() &gt; 0)
00485             {
00486                 <a class="code" href="class_chameleon_window.html#a10">OpenSourceFile</a> (fnames);
00487             }
00488             <span class="keywordflow">break</span>;
00489         }
00490 
00491         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a8">ID_SAVE</a>:
00492             <a class="code" href="class_chameleon_window.html#d23">SaveFile</a>(<span class="keyword">false</span>, <span class="keyword">true</span>, <a class="code" href="datastructures_8h.html#a156a129">FILE_ALLSOURCETYPES</a>);
00493             <span class="keywordflow">break</span>;
00494 
00495         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a9">ID_SAVE_SOURCE_LOCAL</a>:
00496         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a10">ID_SAVE_SOURCE_REMOTE</a>:
00497         {
00498             <span class="keywordflow">if</span>( <span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a9">ID_SAVE_SOURCE_LOCAL</a>)
00499             {
00500                 m_remoteMode = <span class="keyword">false</span>;
00501             }
00502             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a10">ID_SAVE_SOURCE_REMOTE</a>)
00503             {
00504                 m_remoteMode = <span class="keyword">true</span>;
00505             }
00506             <a class="code" href="class_chameleon_window.html#d23">SaveFile</a>(<span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code" href="datastructures_8h.html#a156a129">FILE_ALLSOURCETYPES</a>);
00507             <span class="keywordflow">break</span>;
00508         }
00509 
00510         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a16">ID_NEW_PROJECT</a>:
00511             <a class="code" href="class_chameleon_window.html#d23">SaveFile</a>(<span class="keyword">true</span>, <span class="keyword">true</span>, <a class="code" href="datastructures_8h.html#a156a130">FILE_PROJECT</a>);
00512             <span class="keywordflow">break</span>;
00513 
00514         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a17">ID_OPEN_PROJECT_LOCAL</a>:
00515         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a18">ID_OPEN_PROJECT_REMOTE</a>:
00516             <a class="code" href="class_chameleon_window.html#d31">OpenProjectFile</a>(<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a18">ID_OPEN_PROJECT_REMOTE</a>);
00517             <span class="keywordflow">break</span>;
00518 
00519         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a19">ID_CLOSE_PROJECT</a>:
00520             <a class="code" href="class_chameleon_window.html#d35">CloseProjectFile</a>();
00521             <span class="keywordflow">break</span>;
00522 
00523         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a15">ID_CLOSETAB</a>:
00524         {
00525             <a class="code" href="class_chameleon_window.html#d27">CloseTab</a>();
00526             <span class="keywordflow">break</span>;
00527         }
00528 
00529         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a13">ID_CLOSEPAGE</a>:
00530         {
00531             <span class="keywordflow">if</span> (!<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>) 
00532             {
00533                 <span class="keywordflow">return</span>;
00534             }
00535 
00536             <a class="code" href="class_chameleon_window.html#d25">CloseFile</a>();
00537             <a class="code" href="class_chameleon_window.html#d28">PageHasChanged</a>();
00538             <span class="keywordflow">break</span>;
00539         }
00540 
00541         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a14">ID_CLOSEALL</a>:
00542             <a class="code" href="class_chameleon_window.html#d26">CloseAllFiles</a>();
00543             <span class="keywordflow">break</span>;
00544 
00545 
00546         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a53">ID_STARTCONNECT</a>:
00547         {
00548             <a class="code" href="datastructures_8h.html#a154">NetworkStatus</a> isok = m_network-&gt;<a class="code" href="class_networking.html#a2">GetStatus</a>();
00549             <span class="keywordflow">if</span>(isok == <a class="code" href="datastructures_8h.html#a154a121">NET_GOOD</a>) 
00550             { 
00551                 <a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a6">Connect</a>();
00552                 wxLogDebug(<span class="stringliteral">"Connected: %d"</span>, <a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a9">IsConnected</a>());
00553 
00554                 <span class="comment">// Focus on the terminal</span>
00555                 <span class="keywordtype">int</span> terminalIndex = <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;<a class="code" href="class_chameleon_notebook.html#a2">FindPagePosition</a>(<a class="code" href="class_chameleon_window.html#r9">m_termContainer</a>);
00556                 <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;SetSelection(terminalIndex);
00557                 <a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;SetFocus();
00558             }
00559             <span class="keywordflow">else</span> 
00560             {
00561                 wxLogDebug(<span class="stringliteral">"Tried to start Terminal with invalid networking status: %d"</span>, isok);
00562                 <a class="code" href="class_chameleon_window.html#a9">CheckNetworkStatus</a>();
00563             }
00564             <span class="keywordflow">break</span>;
00565         }
00566 
00567         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a54">ID_DISCONNECT</a>:
00568             <a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a8">Disconnect</a>();
00569             <span class="keywordflow">break</span>;
00570 
00571         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a6">ID_QUIT</a>:
00572             Close(TRUE);
00573             <span class="keywordflow">break</span>;
00574 
00575         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a42">ID_REDO</a>:
00576         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a41">ID_UNDO</a>:
00577         {
00578             <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a42">ID_REDO</a>)
00579             {
00580                 <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;Redo();
00581             }
00582             <span class="keywordflow">else</span>
00583             {
00584                 <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;Undo();
00585             }
00586             
00587             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
00588             <span class="keywordflow">break</span>;
00589         }
00590 
00591         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a43">ID_COPY</a>:
00592             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;Copy();
00593             <span class="keywordflow">break</span>;
00594 
00595         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a44">ID_CUT</a>:
00596             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;Cut();
00597             <span class="keywordflow">break</span>;
00598 
00599         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a45">ID_PASTE</a>:
00600             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;Paste();
00601             <span class="keywordflow">break</span>;
00602 
00603         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a46">ID_FIND</a>:
00604         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a47">ID_REPLACE</a>:
00605         {           
00606             <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r16">m_findReplace</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
00607             {
00608                 <span class="keywordtype">bool</span> isReplaceDialog = <a class="code" href="class_chameleon_window.html#r16">m_findReplace</a>-&gt;GetWindowStyle() &amp; wxFR_REPLACEDIALOG;
00609 
00610                 <span class="keywordflow">if</span>( (isReplaceDialog &amp;&amp; (<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a47">ID_REPLACE</a>)) ||
00611                     (!isReplaceDialog &amp;&amp; (<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a46">ID_FIND</a>)) )
00612                 {
00613                     <span class="keywordflow">return</span>;
00614                 }               
00615                 <span class="keywordflow">else</span>
00616                 {
00617                     <span class="keyword">delete</span> <a class="code" href="class_chameleon_window.html#r16">m_findReplace</a>;
00618                 }
00619             }
00620 
00621             <span class="keywordtype">bool</span> showFind = (<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a46">ID_FIND</a>);
00622             <span class="keywordtype">int</span> dialogFlags = showFind ? 0 : wxFR_REPLACEDIALOG;
00623             wxString title = showFind ? <span class="stringliteral">"Find"</span> : <span class="stringliteral">"Replace"</span>;
00624 
00625             <a class="code" href="class_chameleon_window.html#r20">m_findData</a>.SetFlags(wxFR_DOWN);
00626 
00627             <a class="code" href="class_chameleon_window.html#r16">m_findReplace</a> = <span class="keyword">new</span> wxFindReplaceDialog(<span class="keyword">this</span>,   &amp;<a class="code" href="class_chameleon_window.html#r20">m_findData</a>, title, dialogFlags);
00628             <a class="code" href="class_chameleon_window.html#r16">m_findReplace</a>-&gt;Show(TRUE);
00629 
00630             <span class="keywordflow">break</span>;
00631         }
00632 
00633         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a58">ID_ABOUT</a>:
00634         {
00635             <a class="code" href="class_about_chameleon_dialog.html">AboutChameleonDialog</a> acd(<span class="keyword">this</span>);
00636             acd.ShowModal();
00637             <span class="keywordflow">break</span>;
00638         }
00639         
00640         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a52">ID_OPTIONS</a>:
00641         {
00642             <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a9">IsConnected</a>())
00643             {
00644                 <a class="code" href="class_chameleon_window.html#r14">m_optionsDialog</a>-&gt;<a class="code" href="class_options_dialog.html#a16">DisableServerSettings</a>();
00645             }
00646             <span class="keywordflow">else</span>
00647             {
00648                 <a class="code" href="class_chameleon_window.html#r14">m_optionsDialog</a>-&gt;<a class="code" href="class_options_dialog.html#a15">EnableServerSettings</a>();
00649             }
00650 
00651             <a class="code" href="class_chameleon_window.html#r14">m_optionsDialog</a>-&gt;<a class="code" href="class_options_dialog.html#a11">InitializeDialog</a>();
00652             <span class="keywordtype">int</span> result = <a class="code" href="class_chameleon_window.html#r14">m_optionsDialog</a>-&gt;ShowModal();
00653 
00654             <a class="code" href="class_permission.html">Permission</a>* perms = m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>();
00655             <span class="comment">// because the authorization could be updated and followed by a cancel,</span>
00656             <span class="comment">// go ahead and write the authcode out.  Odds are it hasn't changed, but</span>
00657             <span class="comment">// it's worth doing anyway to make sure it's current.</span>
00658             <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Permissions/authorized"</span>, perms-&gt;<a class="code" href="class_permission.html#a6">GetAuthCode</a>());
00659 
00660             <span class="comment">// For the same reason, ALWAYS re-evaluate the options.  If the user canceled</span>
00661             <span class="comment">// the dialog, things won't have changed.</span>
00662             <a class="code" href="class_chameleon_window.html#d42">EvaluateOptions</a>();  
00663 
00664             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetFocus();
00665             <span class="keywordflow">break</span>;
00666         }
00667 
00668         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a56">ID_COMPILE_PROJECT</a>:
00669         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a55">ID_COMPILE</a>:
00670         {
00671             <span class="comment">// We didn't have time to really test compile cancelation, so this </span>
00672             <span class="comment">// code is commented out.</span>
00673             <span class="comment">/*</span>
00674 <span class="comment">            if(m_compiler-&gt;IsCompiling())</span>
00675 <span class="comment">            {</span>
00676 <span class="comment">                m_compiler-&gt;HaltCompiling();</span>
00677 <span class="comment">            }</span>
00678 <span class="comment">            else</span>
00679 <span class="comment">            {</span>
00680 <span class="comment">                Compile();</span>
00681 <span class="comment">            }</span>
00682 <span class="comment">            */</span>
00683 
00684             <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a56">ID_COMPILE_PROJECT</a>)
00685             {
00686                 <a class="code" href="class_chameleon_window.html#r39">m_compileProject</a> = <span class="keyword">true</span>;
00687             }
00688             <a class="code" href="class_chameleon_window.html#d37">Compile</a>();
00689             <span class="keywordflow">break</span>;
00690         }
00691             
00692 
00693         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a61">ID_PROJECT_ADDFILE</a>:
00694             <a class="code" href="class_chameleon_window.html#d32">AddFileToProject</a>();
00695             <span class="keywordflow">break</span>;
00696 
00697         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a62">ID_PROJECT_REMOVEFILE</a>:
00698             <a class="code" href="class_chameleon_window.html#d33">RemoveFileFromProject</a>();
00699             <span class="keywordflow">break</span>;
00700 
00701         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a70">ID_PROJECT_EXCLUDE_FILE</a>:
00702         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a71">ID_PROJECT_INCLUDE_FILE</a>:
00703         {
00704         
00705             <span class="keywordtype">bool</span> include = (<span class="keywordtype">id</span> == <a class="code" href="datastructures_8h.html#a149a71">ID_PROJECT_INCLUDE_FILE</a>);
00706             <a class="code" href="class_file_name_tree_data.html">FileNameTreeData</a>* data = static_cast &lt;FileNameTreeData* &gt; (<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetItemData(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a>));
00707             <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a5">SetFileBuildInclusion</a>(data-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a>, <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a>, include);
00708 
00709             wxString extension = wxFileName(data-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a>).GetExt();
00710             <span class="keywordtype">int</span> iconIndex;
00711             <span class="keywordflow">if</span>(include)
00712             {
00713                 iconIndex = <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[extension];
00714             }
00715             <span class="keywordflow">else</span>
00716             {
00717                 extension += <span class="stringliteral">"_disabled"</span>;
00718                 iconIndex = <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[extension];
00719             }
00720             <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;SetItemImage(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a>, iconIndex);
00721             <span class="keywordflow">break</span>;
00722         }
00723 
00724         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a20">ID_PRINT_PAGE</a>:
00725         {
00726             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetPrintColourMode(m_options-&gt;<a class="code" href="class_options.html#a22">GetPrintStyle</a>());
00727             wxPrintDialogData printDialogData( *<a class="code" href="_chameleon_printout_8cpp.html#a0">g_printData</a>);
00728             wxPrinter printer (&amp;printDialogData);
00729             <a class="code" href="class_chameleon_printout.html">ChameleonPrintout</a> printout (<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>);
00730             <span class="keywordflow">if</span> (!printer.Print (<span class="keyword">this</span>, &amp;printout, <span class="keyword">true</span>)) 
00731             {
00732                 <span class="keywordflow">if</span> (wxPrinter::GetLastError() == wxPRINTER_ERROR) 
00733                 {
00734                     wxMessageBox (<span class="stringliteral">"There was a problem with printing.\nPlease check your printer setup and try again."</span>,
00735                                     <span class="stringliteral">"Print failed"</span>, wxOK | wxICON_WARNING);
00736                     <span class="keywordflow">return</span>;
00737                 }
00738             }
00739             (*g_printData) = printer.GetPrintDialogData().GetPrintData();
00740             <span class="keywordflow">break</span>;
00741         }
00742 
00743         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a21">ID_PRINT_PREVIEW</a>:
00744         {
00745             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetPrintColourMode(m_options-&gt;<a class="code" href="class_options.html#a22">GetPrintStyle</a>());
00746             wxPrintDialogData printDialogData( *<a class="code" href="_chameleon_printout_8cpp.html#a0">g_printData</a>);
00747             wxPrintPreview *preview = <span class="keyword">new</span> wxPrintPreview (<span class="keyword">new</span> <a class="code" href="class_chameleon_printout.html">ChameleonPrintout</a> (<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>),
00748                 <span class="keyword">new</span> <a class="code" href="class_chameleon_printout.html">ChameleonPrintout</a> (m_currentEd),
00749                 &amp;printDialogData);
00750             <span class="keywordflow">if</span> (!preview-&gt;Ok()) 
00751             {
00752                 <span class="keyword">delete</span> preview;
00753                 wxMessageBox (<span class="stringliteral">"There was a problem with previewing.\nPlease check your printer setup and try again."</span>,
00754                                 <span class="stringliteral">"Preview failed"</span>, wxOK | wxICON_WARNING);
00755                 <span class="keywordflow">return</span>;
00756             }
00757             wxRect rect = <a class="code" href="class_chameleon_window.html#d38">DeterminePrintSize</a>();
00758             wxPreviewFrame *frame = <span class="keyword">new</span> wxPreviewFrame (preview, <span class="keyword">this</span>, _(<span class="stringliteral">"Print Preview"</span>));
00759             frame-&gt;SetSize (rect);
00760             frame-&gt;Centre(wxBOTH);
00761             frame-&gt;Initialize();
00762             frame-&gt;Show(<span class="keyword">true</span>);
00763             <span class="keywordflow">break</span>;
00764         }
00765 
00766         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a22">ID_PRINT_SETUP</a>:
00767         {
00768             (*g_pageSetupData) = * <a class="code" href="_chameleon_printout_8cpp.html#a0">g_printData</a>;
00769             wxPageSetupDialog pageSetupDialog(<span class="keyword">this</span>, <a class="code" href="_chameleon_printout_8cpp.html#a1">g_pageSetupData</a>);
00770             pageSetupDialog.ShowModal();
00771             (*g_printData) = pageSetupDialog.GetPageSetupData().GetPrintData();
00772             (*g_pageSetupData) = pageSetupDialog.GetPageSetupData();
00773             <span class="keywordflow">break</span>;
00774         }
00775 
00776         <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a59">ID_HELP</a>:
00777         {
00778             wxString helpFile = <span class="stringliteral">"chameleon.chm"</span>;
00779             wxString ext = <span class="stringliteral">"chm"</span>;
00780             wxFileType *ft = wxTheMimeTypesManager-&gt;GetFileTypeFromExtension(ext);
00781             <span class="keywordflow">if</span> ( !ft )
00782             {
00783                 <span class="keywordflow">return</span>;
00784             }
00785 
00786             wxString cmd;
00787             <span class="keywordtype">bool</span> ok = ft-&gt;GetOpenCommand(&amp;cmd,
00788                 wxFileType::MessageParameters(helpFile, _T(<span class="stringliteral">""</span>)));
00789             <span class="keyword">delete</span> ft;
00790             <span class="keywordflow">if</span> ( !ok )
00791             {
00792                 <span class="keywordflow">return</span>;
00793             }
00794 
00795             wxProcess *process = <span class="keyword">new</span> wxProcess();
00796             <span class="keywordtype">long</span> pidLast = wxExecute(cmd, wxEXEC_ASYNC, process);
00797             <span class="keywordflow">if</span> ( !pidLast )
00798             {
00799                 <span class="keyword">delete</span> process;
00800             }
00801         }
00802     }
00803 }
00804 
<a name="l00817"></a><a class="code" href="class_chameleon_window.html#d2">00817</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d2">ChameleonWindow::OnDebugCommand</a>(wxCommandEvent &amp;event)
00818 {
00819     <span class="keywordtype">int</span> eventID = event.GetId();
00820 
00821     <a class="code" href="classwx_debug_event.html">wxDebugEvent</a> debugEvent;
00822 
00823     debugEvent.SetId(eventID);
00824 
00825     <span class="keywordflow">if</span>(eventID == <a class="code" href="datastructures_8h.html#a149a73">ID_DEBUG_START</a>)
00826     {
00827         <a class="code" href="class_project_info.html">ProjectInfo</a>* debugProject;
00828         FileBreakpointHash bphash;
00829         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
00830         {
00831             debugProject = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>;
00832             EditorPointerArray edList = m_projMultiFiles-&gt;<a class="code" href="class_project_info.html#a12">GetEditors</a>();
00833             <span class="keywordtype">int</span> numOpenProjEds = edList.GetCount();
00834             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numOpenProjEds; i++)
00835             {
00836                 <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* ed = edList[i];
00837                 wxArrayInt breaks = ed-&gt;<a class="code" href="class_chameleon_editor.html#a19">GetBreakpoints</a>();
00838                 <span class="keywordflow">if</span>(breaks.GetCount() &gt; 0)
00839                 {
00840                     wxFileName fn = ed-&gt;<a class="code" href="class_chameleon_editor.html#a16">GetFileName</a>();
00841                     wxString filename = fn.GetFullPath(wxPATH_UNIX);
00842 
00843                     bphash[filename] = breaks;
00844                 }
00845             }
00846         }
00847         <span class="keywordflow">else</span>
00848         {               
00849             debugProject = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a20">GetProject</a>();
00850             wxFileName sourceFile = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a16">GetFileName</a>();
00851             wxString sourceFileName = sourceFile.GetFullPath(wxPATH_UNIX);
00852             wxArrayInt linenumbers = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a19">GetBreakpoints</a>();
00853             bphash[sourceFileName] = linenumbers;
00854         }
00855         debugEvent.<a class="code" href="classwx_debug_event.html#a11">SetProject</a>(debugProject);
00856 
00857         <span class="comment">// set up the debug I/O panel connection</span>
00858         <span class="keywordflow">if</span>(debugProject-&gt;<a class="code" href="class_project_info.html#a13">IsRemote</a>())
00859         {
00860             wxString tty = <a class="code" href="class_chameleon_window.html#r13">m_debugTerminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a7">ConnectForDebug</a>();
00861             debugEvent.<a class="code" href="classwx_debug_event.html#a12">SetTTYString</a>(<span class="stringliteral">"/dev/"</span> + tty);
00862         }
00863         debugEvent.<a class="code" href="classwx_debug_event.html#a10">SetFileBreakpoints</a>(bphash);
00864         debugEvent.SetId(<a class="code" href="datastructures_8h.html#a149a73">ID_DEBUG_START</a>);
00865     }
00866 
00867     <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;AddPendingEvent(debugEvent);
00868 }
00869 
<a name="l00880"></a><a class="code" href="class_chameleon_window.html#d3">00880</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d3">ChameleonWindow::OnDebugEvent</a>(<a class="code" href="classwx_debug_event.html">wxDebugEvent</a> &amp;event)
00881 {
00882     <span class="keywordtype">int</span> eventID = event.GetId();
00883 
00884     <span class="keywordflow">switch</span>(eventID)
00885     {
00886     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a89">ID_DEBUG_EXIT_ERROR</a>:
00887     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a88">ID_DEBUG_EXIT_NORMAL</a>:
00888         {
00889             <span class="comment">// This is an absurdly naive way to handle removing the focused line</span>
00890             <span class="comment">// marker, but it's easy and shouldn't take up much time</span>
00891             <span class="keywordtype">int</span> numPages = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount();
00892             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPages; i++)
00893             {
00894                 <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* pEdit = static_cast &lt;ChameleonEditor* &gt;(<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage(i));
00895                 pEdit-&gt;MarkerDeleteAll(<a class="code" href="datastructures_8h.html#a148a5">MARKER_FOCUSEDLINE</a>);
00896             }
00897             wxLogDebug(<span class="stringliteral">"Debugger exit"</span>);
00898             <a class="code" href="class_chameleon_window.html#r13">m_debugTerminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a8">Disconnect</a>(<span class="keyword">false</span>);
00899 
00900             <span class="keywordflow">break</span>;
00901         }
00902     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a87">ID_DEBUG_BREAKPOINT</a>:
00903         {   
00904             wxString file = event.<a class="code" href="classwx_debug_event.html#a17">GetSourceFilename</a>();
00905             <span class="keywordtype">int</span> linenumber = event.<a class="code" href="classwx_debug_event.html#a13">GetLineNumber</a>();
00906 
00907             <a class="code" href="class_chameleon_window.html#a8">FocusOnLine</a>(file, linenumber);
00908 
00909             <span class="keywordflow">if</span>(event.<a class="code" href="classwx_debug_event.html#a14">GetVariableNames</a>().GetCount() &gt; 0)
00910             {
00911                 <a class="code" href="class_chameleon_window.html#r11">m_watchPanel</a>-&gt;<a class="code" href="class_variable_watch_panel.html#a10">UpdateVariableInfo</a>(event);
00912             }
00913             <span class="keywordflow">break</span>;
00914         }
00915     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a80">ID_DEBUG_ADD_BREAKPOINT</a>:
00916     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a81">ID_DEBUG_REMOVE_BREAKPOINT</a>:
00917         {
00918             <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;<a class="code" href="class_debugger.html#a7">isDebugging</a>() &amp;&amp; <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;<a class="code" href="class_debugger.html#a8">isPaused</a>())
00919             {
00920                 <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;AddPendingEvent(event);
00921             }           
00922             <span class="keywordflow">break</span>;
00923         }
00924     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a84">ID_DEBUG_ADD_WATCH</a>:
00925     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a85">ID_DEBUG_REMOVE_WATCH</a>:
00926         {
00927             <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;AddPendingEvent(event);
00928             <span class="keywordflow">break</span>;
00929         }
00930     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a86">ID_DEBUG_VARINFO</a>:
00931         <a class="code" href="class_chameleon_window.html#r11">m_watchPanel</a>-&gt;<a class="code" href="class_variable_watch_panel.html#a10">UpdateVariableInfo</a>(event);
00932         <span class="keywordflow">break</span>;
00933     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a149a83">ID_DEBUG_RUNTOCURSOR</a>:
00934         <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;AddPendingEvent(event);
00935         <span class="keywordflow">break</span>;
00936     <span class="keywordflow">default</span>:
00937         wxLogDebug(<span class="stringliteral">"Default DebugEvent.  Value: %d"</span>, eventID);
00938         <span class="keywordflow">break</span>;
00939     }
00940 }
00941 
00942 <span class="comment">// File and editor manipulation code begins here</span>
00943 
<a name="l00952"></a><a class="code" href="class_chameleon_window.html#d21">00952</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d21">ChameleonWindow::NewFile</a>() 
00953 {
00954     <a class="code" href="class_chameleon_window.html#r31">m_fileNum</a> += 1;
00955 
00956     wxString locationPrefix = <span class="stringliteral">"(?) "</span>;
00957 
00958     wxString noname = locationPrefix + <span class="stringliteral">"&lt;untitled&gt; "</span> + wxString::Format (<span class="stringliteral">"%d"</span>, <a class="code" href="class_chameleon_window.html#r31">m_fileNum</a>);
00959     <a class="code" href="class_project_info.html">ProjectInfo</a>* singleFileProject = <span class="keyword">new</span> <a class="code" href="class_project_info.html">ProjectInfo</a>();
00960     <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* edit = <span class="keyword">new</span> <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a> (<span class="keyword">this</span>, m_options, singleFileProject, <a class="code" href="class_chameleon_window.html#r1">m_book</a>, -1);
00961     <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a> = edit;
00962     <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a> = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount();
00963     <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;AddPage (edit, noname, <span class="keyword">true</span>);
00964 }
00965 
<a name="l00976"></a><a class="code" href="class_chameleon_window.html#d28">00976</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d28">ChameleonWindow::PageHasChanged</a> (<span class="keywordtype">int</span> pageNr) 
00977 {
00978     <span class="comment">// no pages - null out the current ed pointer</span>
00979     <span class="comment">// You know, this should really never happen with the current design</span>
00980     <span class="comment">// 3/11/04: Unless, of course, we're closing out the program...</span>
00981     <span class="keywordflow">if</span> (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount() == 0) 
00982     {
00983         <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a> = -1;
00984         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
00985         <span class="keywordflow">return</span>;
00986     }
00987 
00988     <span class="comment">// no page passed in</span>
00989     <span class="keywordflow">if</span> (pageNr == -1)
00990     {
00991         pageNr = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetSelection();
00992         
00993     }
00994 
00995     <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount() &lt;= pageNr)
00996     {
00997         pageNr = pageNr - 1;
00998     }
00999 
01000     <span class="comment">// activate the selected page</span>
01001     <span class="keywordflow">if</span> (pageNr &gt;= 0) 
01002     {
01003         <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a> = pageNr;
01004         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a> = static_cast&lt; ChameleonEditor * &gt; (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage (<a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>));
01005         <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;SetSelection(pageNr);
01006         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetFocus();
01007     }
01008     <span class="keywordflow">else</span>
01009     {
01010         <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a> = -1;
01011         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
01012     }
01013     <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
01014     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
01015     {
01016         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;Refresh();
01017 
01018         wxString tabText = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageText(<a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>);
01019         wxString statusText;
01020 
01021         <span class="keywordflow">if</span>(tabText.StartsWith(<span class="stringliteral">"(R)"</span>))
01022         {           
01023             m_remoteMode = <span class="keyword">true</span>;
01024         }
01025         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tabText.StartsWith(<span class="stringliteral">"(L)"</span>))
01026         {
01027             m_remoteMode = <span class="keyword">false</span>;
01028         }
01029         <span class="comment">// else assume unsaved file and don't change anything</span>
01030     }
01031 }
01032 
<a name="l01041"></a><a class="code" href="class_chameleon_window.html#d27">01041</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d27">ChameleonWindow::CloseTab</a>()
01042 {
01043     <span class="keywordtype">int</span> tab = <a class="code" href="class_chameleon_window.html#a3">GetIntVar</a>(<a class="code" href="datastructures_8h.html#a147a3">VN_CLICKEDTAB</a>);
01044     <a class="code" href="class_chameleon_window.html#d25">CloseFile</a>(tab);
01045     <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
01046 }
01047 
<a name="l01058"></a><a class="code" href="class_chameleon_window.html#d25">01058</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d25">ChameleonWindow::CloseFile</a> (<span class="keywordtype">int</span> pageNr) 
01059 {
01060     <span class="keywordflow">if</span> (pageNr == -1)
01061     {
01062         pageNr = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetSelection();
01063     }
01064 
01065     <span class="comment">// gives the user a chance to save if the file has been modified</span>
01066     <span class="keywordtype">int</span> modifiedFileResult = <a class="code" href="class_chameleon_window.html#d30">HandleModifiedFile</a>(pageNr, <span class="keyword">true</span>);
01067 
01068     <span class="comment">// a wxYES result is taken care of inside HandleModifiedFile, and a</span>
01069     <span class="comment">// wxNO is handled implicitly by the fact that the file isn't saved.</span>
01070     <span class="keywordflow">if</span>(modifiedFileResult == wxCANCEL)
01071     {
01072         <span class="keywordflow">return</span>;
01073     }
01074 
01075     <span class="keywordflow">if</span> (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount() &gt; 0) 
01076     {
01077         wxFileName currentFileName;
01078         <span class="keywordflow">if</span> ((<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount() &gt; 1) || <a class="code" href="class_chameleon_window.html#r34">m_appClosing</a>) 
01079         {
01080             currentFileName = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a16">GetFileName</a>();
01081             <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* pEdit = static_cast &lt;ChameleonEditor* &gt;(<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage(pageNr));
01082             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;DeletePage (pageNr);
01083         }
01084         <span class="comment">// closing out the last buffer, reset it to act as a new one</span>
01085         <span class="keywordflow">else</span>
01086         {
01087             <a class="code" href="class_chameleon_window.html#r31">m_fileNum</a> = 1;
01088             wxString locationPrefix = <span class="stringliteral">"(?) "</span>;
01089             wxString noname = locationPrefix + <span class="stringliteral">"&lt;untitled&gt; "</span> + wxString::Format (<span class="stringliteral">"%d"</span>, <a class="code" href="class_chameleon_window.html#r31">m_fileNum</a>);
01090             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;SetPageText (pageNr, noname);
01091             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a25">ResetEditor</a>();
01092         }
01093         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount() &gt; 0)
01094         {
01095             <span class="keywordflow">if</span>(currentFileName.IsOk())
01096             {
01097                 <span class="keywordtype">int</span> newSelectedPageNum = <a class="code" href="class_chameleon_window.html#d29">GetPageNum</a>(currentFileName);
01098                 <a class="code" href="class_chameleon_window.html#d28">PageHasChanged</a>(newSelectedPageNum);
01099             }
01100         }       
01101     }
01102 }
01103 
<a name="l01112"></a><a class="code" href="class_chameleon_window.html#d26">01112</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d26">ChameleonWindow::CloseAllFiles</a>()
01113 {
01114     <span class="keywordtype">int</span> cnt = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount();
01115     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cnt; i++) 
01116     {
01117         <a class="code" href="class_chameleon_window.html#d25">CloseFile</a>();
01118     }
01119 
01120     <a class="code" href="class_chameleon_window.html#d28">PageHasChanged</a>();
01121 }
01122 
<a name="l01135"></a><a class="code" href="class_chameleon_window.html#d29">01135</a> <span class="keywordtype">int</span> <a class="code" href="class_chameleon_window.html#d29">ChameleonWindow::GetPageNum</a>(wxFileName fn,  <span class="keywordtype">bool</span> compareWholePath, <span class="keywordtype">int</span> startingTab)
01136 {
01137     <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a> *edit;
01138     <span class="keywordtype">int</span> numPages = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount();
01139     wxString filename = fn.GetFullName();
01140 
01141     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pageNum = startingTab; pageNum &lt; numPages; pageNum++) 
01142     {
01143         edit = static_cast &lt;ChameleonEditor *&gt; (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage(pageNum));
01144 
01145         <span class="keywordtype">bool</span> fileMatches = <span class="keyword">false</span>;
01146 
01147         <span class="keywordflow">if</span>(compareWholePath)
01148         {
01149             fileMatches = (edit-&gt;<a class="code" href="class_chameleon_editor.html#a16">GetFileName</a>() == fn);
01150         }
01151         <span class="keywordflow">else</span>
01152         {
01153             fileMatches = (edit-&gt;<a class="code" href="class_chameleon_editor.html#a15">GetFilenameString</a>() == filename);
01154         }
01155         <span class="keywordflow">if</span> (fileMatches)
01156         {           
01157             <span class="keywordflow">return</span> pageNum;
01158         }
01159     }
01160 
01161     <span class="keywordflow">return</span> -1;
01162 }
01163 
01174 <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d19">ChameleonWindow::OnPageChange</a> (wxNotebookEvent &amp;WXUNUSED(event)) 
01175 {
01176     <span class="keywordflow">if</span> (!m_setSelection)
01177     {
01178         <a class="code" href="class_chameleon_window.html#d28">PageHasChanged</a>();
01179     }
01180 }
01181 
<a name="l01193"></a><a class="code" href="class_chameleon_window.html#d30">01193</a> <span class="keywordtype">int</span> <a class="code" href="class_chameleon_window.html#d30">ChameleonWindow::HandleModifiedFile</a>(<span class="keywordtype">int</span> pageNr, <span class="keywordtype">bool</span> closingFile)
01194 {
01195     <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a> *edit = static_cast &lt;ChameleonEditor * &gt; (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage (pageNr));
01196 
01197     <span class="keywordflow">if</span> (!edit)
01198     {
01199         <span class="keywordflow">return</span> wxCANCEL;
01200     }
01201 
01202     <span class="keywordflow">if</span> (edit-&gt;<a class="code" href="class_chameleon_editor.html#a6">Modified</a>()) 
01203     {
01204         wxString saveMessage = <span class="stringliteral">"The file "</span>;
01205         wxString fileName = edit-&gt;<a class="code" href="class_chameleon_editor.html#a14">GetFileNameAndPath</a>();
01206         
01207         <span class="comment">// the file hasn't been saved yet, grab the "&lt;untitled&gt; #" bit from the tab</span>
01208         <span class="keywordflow">if</span>(fileName == wxEmptyString)
01209         {
01210             <span class="keywordtype">int</span> selectedTab = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetSelection();
01211             wxString tabText = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageText(selectedTab);
01212 
01213             <span class="keywordtype">int</span> idx = tabText.Index(<span class="charliteral">'*'</span>);
01214 
01215             <span class="keywordflow">if</span>(idx != wxNOT_FOUND)
01216             {
01217                 tabText.Remove(idx, 1);
01218             }
01219 
01220             <span class="comment">// remove the (R), (L), or (?) from the tab</span>
01221             wxRegEx reLocationPrefix = <span class="stringliteral">"\\((R|L|\\?)\\) "</span>;
01222             reLocationPrefix.Replace(&amp;tabText, wxEmptyString);
01223             
01224             fileName = tabText;
01225         }
01226         saveMessage += fileName;
01227         
01228         saveMessage &lt;&lt; <span class="stringliteral">" has unsaved changes.  Do you want to save them before the file is "</span>;
01229         
01230         <span class="keywordflow">if</span>(closingFile)
01231         {
01232             saveMessage += <span class="stringliteral">"closed?"</span>;
01233         }
01234         <span class="keywordflow">else</span>
01235         {
01236             saveMessage += <span class="stringliteral">"reloaded?"</span>;
01237         }
01238 
01239         <span class="keywordtype">int</span> result = wxMessageBox (saveMessage, <span class="stringliteral">"Close"</span>, wxYES_NO | wxCANCEL | wxICON_QUESTION);
01240         <span class="keywordflow">if</span>( result == wxYES) 
01241         {
01242             <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* tmpCurrentEd = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>;
01243             m_currentEd = edit;
01244             <span class="comment">// only do a Save As if necessary</span>
01245             <a class="code" href="class_chameleon_window.html#d23">SaveFile</a>(<span class="keyword">false</span>, <span class="keyword">true</span>, <a class="code" href="datastructures_8h.html#a156a129">FILE_ALLSOURCETYPES</a>);
01246             m_currentEd = tmpCurrentEd;
01247             m_currentEd-&gt;SetFocus();
01248 
01249             <span class="keywordflow">if</span> (edit-&gt;Modified()) 
01250             {
01251                 wxString errorMessage = fileName + <span class="stringliteral">" could not be saved!"</span>;
01252                 wxMessageBox (errorMessage, <span class="stringliteral">"File not closed"</span>,
01253                     wxOK | wxICON_EXCLAMATION);
01254                 m_currentEd-&gt;Refresh();
01255             }
01256         }
01257 
01258         <span class="keywordflow">return</span> result;
01259     }
01260     <span class="comment">// if I'm here, doesn't matter if I return wxNO or wxYES, just as long as it's not wxCANCEL</span>
01261     <span class="keywordflow">return</span> wxNO;
01262 }
01263 
<a name="l01279"></a><a class="code" href="class_chameleon_window.html#d22">01279</a> wxArrayString <a class="code" href="class_chameleon_window.html#d22">ChameleonWindow::OpenFile</a>(FileFilterType filterType)
01280 {
01281     wxArrayString fnames;
01282     <span class="keywordflow">if</span> (!<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>)
01283     {
01284         <span class="keywordflow">return</span> fnames;
01285     }
01286 
01287     wxString filterString = <a class="code" href="class_chameleon_window.html#d39">ConstructFilterString</a>(filterType);
01288 
01289     <span class="keywordflow">if</span>(!m_remoteMode)
01290     {
01291         wxFileDialog dlg (<span class="keyword">this</span>, _(<span class="stringliteral">"Open"</span>), <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, filterString,
01292             wxOPEN | wxFILE_MUST_EXIST  | wxCHANGE_DIR);
01293         <span class="keywordflow">if</span> (dlg.ShowModal() != wxID_OK)
01294         {
01295             <span class="keywordflow">return</span> fnames;
01296         }
01297         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetFocus();
01298         dlg.GetPaths (fnames);
01299     }
01300     <span class="keywordflow">else</span>
01301     {
01302         SetStatusText(<span class="stringliteral">"Doing network operation..."</span>, 3);
01303 
01304         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a>-&gt;<a class="code" href="class_remote_file_dialog.html#a17">Prepare</a>(<span class="keyword">true</span>, filterString))
01305         {
01306             <span class="keywordtype">int</span> result = <a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a>-&gt;ShowModal();
01307             SetStatusText(wxEmptyString, 3);
01308             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetFocus();
01309 
01310             <span class="keywordflow">if</span>(result != wxOK)
01311             {
01312                 <span class="keywordflow">return</span> fnames;
01313             }
01314 
01315             wxString remoteFileName = <a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a>-&gt;<a class="code" href="class_remote_file_dialog.html#a15">GetRemoteFileNameAndPath</a>();
01316 
01317             wxString userHome;
01318             <span class="keywordflow">if</span>(!m_network-&gt;<a class="code" href="class_networking.html#a6">GetHomeDirPath</a>(userHome))
01319             {
01320                 <a class="code" href="class_chameleon_window.html#a9">CheckNetworkStatus</a>();
01321             }
01322             <span class="keywordflow">else</span>
01323             {
01324                 remoteFileName.Replace(<span class="stringliteral">"~"</span>, userHome);
01325                 fnames.Add(remoteFileName);
01326             }           
01327         }
01328         <span class="keywordflow">else</span>
01329         {
01330             <a class="code" href="class_chameleon_window.html#a9">CheckNetworkStatus</a>();
01331             SetStatusText(wxEmptyString, 3);
01332             <span class="keywordflow">return</span> fnames;
01333         }
01334     }
01335     
01336     <span class="keywordflow">return</span> fnames;  
01337 }
01338 
<a name="l01349"></a><a class="code" href="class_chameleon_window.html#a10">01349</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#a10">ChameleonWindow::OpenSourceFile</a> (wxArrayString fnames) 
01350 {
01351     <span class="keywordtype">int</span> firstPageNr = -1;
01352     wxString fileContents = wxEmptyString;
01353     wxString fileNameNoPath;
01354 
01355     wxString locationPrefix;
01356 
01357     <span class="keywordflow">if</span>(m_remoteMode)
01358     {
01359         locationPrefix = <span class="stringliteral">"(R) "</span>;
01360     }
01361     <span class="keywordflow">else</span>
01362     {
01363         locationPrefix = <span class="stringliteral">"(L) "</span>;
01364     }
01365 
01366     <span class="keywordflow">for</span> (size_t n = 0; n &lt; fnames.GetCount(); n++) 
01367     {
01368         fileNameNoPath = wxEmptyString;
01369         wxFileName newFileName(fnames[n]);
01370         <span class="keywordtype">int</span> pageNr = <a class="code" href="class_chameleon_window.html#d29">GetPageNum</a>(newFileName);
01371 
01372         <span class="keywordflow">if</span>(!<a class="code" href="class_chameleon_window.html#d24">GetFileContents</a>(fnames[n], fileContents, fileNameNoPath))
01373         {
01374             <span class="keywordflow">return</span>;
01375         }
01376 
01377         <span class="comment">// I'd previously canceled the open here if the file was empty,</span>
01378         <span class="comment">// but we opted to skip that behavior</span>
01379         <span class="comment">/*</span>
01380 <span class="comment">        if(fileContents == wxEmptyString)</span>
01381 <span class="comment">        {</span>
01382 <span class="comment">            continue;</span>
01383 <span class="comment">        }</span>
01384 <span class="comment">        */</span>
01385 
01386         <span class="comment">// filename is already open</span>
01387         <span class="keywordflow">if</span> (pageNr &gt;= 0) 
01388         {
01389             <span class="keywordtype">int</span> modifiedFileResult = <a class="code" href="class_chameleon_window.html#d30">HandleModifiedFile</a>(pageNr, <span class="keyword">false</span>);
01390 
01391             <span class="comment">// user canceled the open request, skip the reload</span>
01392             <span class="keywordflow">if</span>(modifiedFileResult == wxCANCEL)
01393             {
01394                 <span class="keywordflow">continue</span>;
01395             }
01396             <a class="code" href="class_chameleon_window.html#r35">m_setSelection</a> = <span class="keyword">true</span>;
01397             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;SetSelection (pageNr);
01398             <a class="code" href="class_chameleon_window.html#r35">m_setSelection</a> = <span class="keyword">false</span>;
01399             <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a> = pageNr;
01400             
01401             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a> = static_cast&lt; ChameleonEditor* &gt; (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage (<a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>));
01402             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a3">LoadFileText</a>(fileContents);
01403         }
01404         
01405         <span class="keywordflow">else</span>
01406         {
01407             <a class="code" href="class_project_info.html">ProjectInfo</a>* proj;
01408 
01409             <span class="keywordflow">if</span>( (<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>) &amp;&amp; (<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a1">FileExistsInProject</a>(fnames[n])))
01410             {
01411                 proj = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>;
01412             }
01413             <span class="keywordflow">else</span>
01414             {
01415                 proj = <span class="keyword">new</span> <a class="code" href="class_project_info.html">ProjectInfo</a>();
01416                 proj-&gt;<a class="code" href="class_project_info.html#a25">SetRemote</a>(m_remoteMode);
01417             }
01418             
01419             <span class="comment">// current buffer is empty and untouched, so load the file into it</span>
01420             <span class="keywordflow">if</span> ((!<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a6">Modified</a>() &amp;&amp; 
01421                  !<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a8">HasBeenSaved</a>() &amp;&amp; 
01422                   <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetText().IsEmpty()) ) 
01423             {
01424                 <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;SetPageText(<a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>, locationPrefix + fileNameNoPath);
01425                 <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a24">SetProject</a>(proj);              
01426             }
01427             <span class="comment">// need to create a new buffer for the file</span>
01428             <span class="keywordflow">else</span>
01429             {
01430                 <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a> *edit = <span class="keyword">new</span> <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a> (<span class="keyword">this</span>, m_options, proj, <a class="code" href="class_chameleon_window.html#r1">m_book</a>, -1);
01431 
01432                 <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a> = edit;
01433                 <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a> = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount();
01434                 <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;AddPage (<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>, locationPrefix + fileNameNoPath, <span class="keyword">true</span>);
01435             }
01436             
01437             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a3">LoadFileText</a>(fileContents);
01438             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a22">SetFilename</a>(newFileName, m_remoteMode);
01439         }
01440 
01441         <span class="keywordflow">if</span> (firstPageNr &lt; 0)
01442         {
01443             firstPageNr = <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>;
01444         }
01445     }
01446 
01447     <span class="comment">// show the active tab, new or otherwise</span>
01448     <span class="keywordflow">if</span> (firstPageNr &gt;= 0) 
01449     {
01450         <a class="code" href="class_chameleon_window.html#d28">PageHasChanged</a>(firstPageNr);
01451     }
01452 }
01453 
01454 
01455 
<a name="l01468"></a><a class="code" href="class_chameleon_window.html#d24">01468</a> <span class="keywordtype">bool</span> <a class="code" href="class_chameleon_window.html#d24">ChameleonWindow::GetFileContents</a>(wxString fileToLoad, wxString &amp;fileContents, wxString &amp;fileName)
01469 {
01470     wxFileName fn(fileToLoad);
01471     <span class="keywordflow">if</span>(m_remoteMode)
01472     {
01473         wxString remotePath = fn.GetPath(<span class="keyword">false</span>, wxPATH_UNIX);
01474         wxString remoteFile = fn.GetFullName();
01475 
01476         <span class="keywordflow">if</span>(!m_network-&gt;<a class="code" href="class_networking.html#a7">GetFileContents</a>(fn, fileContents))
01477         {
01478             <a class="code" href="class_chameleon_window.html#a9">CheckNetworkStatus</a>();
01479         }
01480     }
01481     <span class="keywordflow">else</span>
01482     {
01483         wxFile file (fileToLoad);
01484 
01485         <span class="keywordflow">if</span>( !file.IsOpened() )
01486         {
01487             <span class="keywordflow">return</span> <span class="keyword">false</span>;
01488         }
01489 
01490         <span class="keywordtype">long</span> lng = file.Length();
01491 
01492         <span class="keywordflow">if</span>( lng &gt; 0 )
01493         {
01494             <span class="keywordtype">char</span> *pFileContents = fileContents.GetWriteBuf(lng);
01495             file.Read(pFileContents, lng);
01496             fileContents.UngetWriteBuf();
01497         }
01498     }
01499 
01500     fileName = fn.GetFullName();
01501     <span class="keywordflow">return</span> <span class="keyword">true</span>;   
01502 }
01503 
<a name="l01519"></a><a class="code" href="class_chameleon_window.html#d23">01519</a> <span class="keywordtype">bool</span> <a class="code" href="class_chameleon_window.html#d23">ChameleonWindow::SaveFile</a>(<span class="keywordtype">bool</span> saveas, <span class="keywordtype">bool</span> askLocalRemote, FileFilterType filterType)
01520 {
01521     wxString filename;
01522     wxString fileContents;
01523 
01524     <span class="keywordtype">bool</span> originalRemoteMode = m_remoteMode;
01525 
01526     <span class="keywordtype">bool</span> doSaveAs = saveas || !<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a8">HasBeenSaved</a>() || (m_remoteMode != <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a26">LastSavedRemotely</a>());
01527 
01528     <span class="keywordtype">bool</span> isSourceFile = !(filterType == <a class="code" href="datastructures_8h.html#a156a130">FILE_PROJECT</a>);
01529 
01530     wxString filterString = <a class="code" href="class_chameleon_window.html#d39">ConstructFilterString</a>(filterType);
01531 
01532     <span class="keywordflow">if</span>(doSaveAs &amp;&amp; askLocalRemote)
01533     {
01534         <span class="comment">// default to saving remotely</span>
01535         m_remoteMode = <span class="keyword">true</span>;
01536 
01537         <span class="keywordflow">if</span>(m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>()-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a95">PERM_LOCALMODE</a>))
01538         {
01539             wxArrayString choices;
01540             choices.Add(<span class="stringliteral">"Remote"</span>);
01541             choices.Add(<span class="stringliteral">"Local"</span>);
01542             wxString choice = wxGetSingleChoice(<span class="stringliteral">"Would you like to save this file: \n\n1) Remotely (on the server) \n2) Locally (on the computer you're using)?"</span>, 
01543                 <span class="stringliteral">"Save File - location"</span>,choices);
01544             <span class="keywordflow">if</span>(choice == <span class="stringliteral">"Local"</span>)
01545             {
01546                 m_remoteMode = <span class="keyword">false</span>;
01547             }
01548             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(choice == wxEmptyString)
01549             {
01550                 <span class="comment">// user hit Cancel - don't save</span>
01551                 m_remoteMode = originalRemoteMode;
01552                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01553             }
01554         }       
01555     }
01556 
01557     <span class="keywordflow">if</span>(isSourceFile)
01558     {
01559         fileContents = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetText();
01560     }
01561     <span class="comment">// we must be saving a new project</span>
01562     <span class="keywordflow">else</span>
01563     {
01564         fileContents = <span class="stringliteral">"[Headers]\n\n[Sources]\n\n[Libraries]\n"</span>;
01565     }
01566 
01567     <span class="keywordflow">if</span>(!m_remoteMode)
01568     {
01569         <span class="keywordflow">if</span>(doSaveAs)
01570         {       
01571             <span class="comment">// the last item in a filter's list will be the default extension if none is given</span>
01572             <span class="comment">// ie, right now, .cpp is the default extension for C++ files</span>
01573 
01574             wxString title = <span class="stringliteral">"Save File As"</span>;
01575 
01576             <span class="keywordflow">if</span>(filterType == <a class="code" href="datastructures_8h.html#a156a130">FILE_PROJECT</a>)
01577             {
01578                 title = <span class="stringliteral">"Save New Project"</span>;
01579             }
01580             wxFileDialog dlg (<span class="keyword">this</span>, title, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, filterString, 
01581                 wxSAVE | wxOVERWRITE_PROMPT | wxCHANGE_DIR);
01582 
01583             <span class="comment">// ie, user clicked cancel</span>
01584             <span class="keywordflow">if</span>(dlg.ShowModal() != wxID_OK) 
01585             { 
01586                 <span class="keywordflow">return</span> <span class="keyword">false</span>; 
01587             }
01588 
01589             filename = dlg.GetPath();
01590         }
01591 
01592         <span class="keywordflow">else</span>
01593         {
01594             filename = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a14">GetFileNameAndPath</a>();
01595         }
01596 
01597         <span class="keywordflow">if</span>(isSourceFile)
01598         {
01599             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetFocus();
01600 
01601             wxFileName fn(filename);
01602             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a22">SetFilename</a>(fn, <span class="keyword">false</span>);
01603             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a4">SaveFile</a>(filename);
01604 
01605             wxString simpleFileName = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a15">GetFilenameString</a>();
01606 
01607             <span class="keywordtype">int</span> currentTab = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetSelection();
01608 
01609             wxString locationPrefix = <span class="stringliteral">"(L) "</span>;
01610             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;SetPageText(currentTab, locationPrefix + simpleFileName);
01611             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
01612         }
01613         <span class="keywordflow">else</span>
01614         {
01615             wxFile newProjectFile(filename, wxFile::write);
01616             newProjectFile.Write(fileContents);
01617             newProjectFile.Close();
01618         }
01619 
01620     }
01621     <span class="comment">// remote mode</span>
01622     <span class="keywordflow">else</span>
01623     {
01624         wxString remotePath, remoteFile;
01625 
01626         <span class="keywordflow">if</span>(doSaveAs)
01627         {
01628             SetStatusText(<span class="stringliteral">"Doing network operation..."</span>, 3);
01629             <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a>-&gt;<a class="code" href="class_remote_file_dialog.html#a17">Prepare</a>(<span class="keyword">false</span>, filterString))
01630             {
01631                 <span class="keywordtype">int</span> result = <a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a>-&gt;ShowModal();
01632                 SetStatusText(wxEmptyString, 3);
01633                 <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetFocus();
01634 
01635                 <span class="keywordflow">if</span>(result != wxOK)
01636                 {
01637                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
01638                 }
01639 
01640                 remotePath = <a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a>-&gt;<a class="code" href="class_remote_file_dialog.html#a14">GetRemotePath</a>();
01641                 remoteFile = <a class="code" href="class_chameleon_window.html#r15">m_remoteFileDialog</a>-&gt;<a class="code" href="class_remote_file_dialog.html#a13">GetRemoteFileName</a>();
01642 
01643                 wxString userHome;
01644                 <span class="keywordflow">if</span>(!m_network-&gt;<a class="code" href="class_networking.html#a6">GetHomeDirPath</a>(userHome))
01645                 {
01646                     <a class="code" href="class_chameleon_window.html#a9">CheckNetworkStatus</a>();
01647                 }
01648                 <span class="keywordflow">else</span>
01649                 {
01650                     remotePath.Replace(<span class="stringliteral">"~"</span>, userHome);
01651                 }
01652             }
01653             <span class="keywordflow">else</span>
01654             {
01655                 <a class="code" href="class_chameleon_window.html#a9">CheckNetworkStatus</a>();
01656                 SetStatusText(wxEmptyString, 3);
01657                 <span class="keywordflow">return</span> <span class="keyword">false</span>;               
01658             }           
01659         }
01660         <span class="keywordflow">else</span>
01661         {
01662             remoteFile = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a15">GetFilenameString</a>();
01663             remotePath = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a18">GetFilePath</a>();
01664         }
01665 
01666         wxFileName remoteFN(remotePath, remoteFile);
01667         wxBeginBusyCursor();
01668         <span class="keywordflow">if</span>(!m_network-&gt;<a class="code" href="class_networking.html#a8">SendFileContents</a>(fileContents, remoteFN))
01669         {
01670             <a class="code" href="class_chameleon_window.html#a9">CheckNetworkStatus</a>();
01671         }
01672         wxEndBusyCursor();
01673 
01674         <span class="keywordflow">if</span>(isSourceFile)
01675         {
01676             wxString currentFilenameAndPath = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a14">GetFileNameAndPath</a>();
01677             <span class="keywordflow">if</span>((currentFilenameAndPath == wxEmptyString) ||
01678                 (currentFilenameAndPath != wxFileName(remotePath, remoteFile, wxPATH_UNIX).GetFullPath()))
01679             {
01680                 <span class="keywordtype">int</span> currentTab = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetSelection();
01681                 wxString locationPrefix = <span class="stringliteral">"(R) "</span>;
01682                 <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;SetPageText(currentTab, locationPrefix + remoteFile);
01683             }
01684 
01685             wxFileName fn(remotePath, remoteFile, wxPATH_UNIX);
01686             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a22">SetFilename</a>(fn, <span class="keyword">true</span>);
01687         }
01688         <span class="keywordflow">else</span>
01689         {
01690             <span class="comment">// store the name so we can set the name in the project tree</span>
01691             filename = wxFileName(remotePath, remoteFile, wxPATH_UNIX).GetFullPath();
01692         }       
01693     }
01694 
01695     <span class="keywordflow">if</span>(isSourceFile)
01696     {
01697         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;EmptyUndoBuffer();
01698         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetSavePoint();
01699         <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
01700     }
01701     <span class="keywordflow">else</span>
01702     {
01703         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
01704         {
01705             <a class="code" href="class_chameleon_window.html#d35">CloseProjectFile</a>();
01706         }
01707 
01708         <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> = <span class="keyword">new</span> <a class="code" href="class_project_info.html">ProjectInfo</a>();
01709         <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a25">SetRemote</a>(m_remoteMode);
01710 
01711         wxFileName projectFile(filename);
01712         <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a30">SetProjectFile</a>(projectFile);
01713 
01714         wxTreeItemId rootItem = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetRootItem();
01715         <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;SetItemText(rootItem, <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a19">GetProjectName</a>());
01716     }
01717 
01718     <span class="keywordflow">return</span> <span class="keyword">true</span>;
01719 }
01720 
<a name="l01731"></a><a class="code" href="class_chameleon_window.html#d39">01731</a> wxString <a class="code" href="class_chameleon_window.html#d39">ChameleonWindow::ConstructFilterString</a>(FileFilterType filterType)
01732 {
01733     wxString filterString;
01734     <span class="keywordflow">switch</span>(filterType)
01735     {
01736     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a156a129">FILE_ALLSOURCETYPES</a>:
01737         filterString = <a class="code" href="class_chameleon_window.html#r40">m_filterCPPFiles</a>;
01738         filterString += <span class="stringliteral">"|"</span>;
01739         filterString += <a class="code" href="class_chameleon_window.html#r41">m_filterHeaderFiles</a>;
01740         filterString += <span class="stringliteral">"|"</span>;
01741         filterString += <a class="code" href="class_chameleon_window.html#r44">m_filterAllFiles</a>;
01742         <span class="keywordflow">break</span>;
01743     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a156a132">FILE_SOURCES</a>:
01744         filterString = m_filterCPPFiles;
01745         <span class="keywordflow">break</span>;
01746     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a156a133">FILE_HEADERS</a>:
01747         filterString = <a class="code" href="class_chameleon_window.html#r41">m_filterHeaderFiles</a>;
01748         <span class="keywordflow">break</span>;
01749     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a156a130">FILE_PROJECT</a>:
01750         filterString = <a class="code" href="class_chameleon_window.html#r42">m_filterProjectFiles</a>;
01751         <span class="keywordflow">break</span>;
01752     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a156a131">FILE_LIBRARIES</a>:
01753         filterString = <a class="code" href="class_chameleon_window.html#r43">m_filterLibraryFiles</a>;
01754         <span class="keywordflow">break</span>;
01755     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a156a134">FILE_ALLFILES</a>:
01756     <span class="keywordflow">default</span>:
01757         filterString = <a class="code" href="class_chameleon_window.html#r44">m_filterAllFiles</a>;
01758         <span class="keywordflow">break</span>;
01759     }
01760     <span class="keywordflow">return</span> filterString;
01761 }
01762 
01763 <span class="comment">// my "I need to try something out, I'll stick it in here" function</span>
01764 <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d5">ChameleonWindow::Test</a>(wxCommandEvent&amp; WXUNUSED(event))
01765 {
01766 }
01767 
01768 
01769 <span class="comment">// not currently used.  may come into play later regarding terminal resizing</span>
<a name="l01770"></a><a class="code" href="class_chameleon_window.html#d0">01770</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d0">ChameleonWindow::CheckSize</a>()
01771 {
01772     <span class="keywordtype">int</span> x, y;
01773     this-&gt;GetClientSize(&amp;x, &amp;y);
01774     wxString result;
01775     result &lt;&lt; x &lt;&lt; <span class="stringliteral">", "</span> &lt;&lt; y;
01776     wxMessageBox(result );
01777     <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetScrollWidth(x);
01778     
01779 }
01780 
01781 <span class="comment">// UI update code begins here</span>
01782 
<a name="l01793"></a><a class="code" href="class_chameleon_window.html#d11">01793</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d11">ChameleonWindow::OnIdle</a>(wxIdleEvent &amp;event)
01794 {
01795     <span class="keywordflow">if</span> (<a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a> &amp;&amp; !<a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a>-&gt;IsRunning ()) 
01796     {
01797         <a class="code" href="class_chameleon_window.html#r18">m_updateTimer</a>-&gt;Start (250, wxTIMER_ONE_SHOT);
01798 
01799     }
01800     event.Skip();
01801 }
01802 
01813 <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d13">ChameleonWindow::OnStatusTimer</a>(wxTimerEvent &amp;WXUNUSED(event))
01814 {
01815     <span class="keywordflow">if</span> (m_updateTimer)
01816     {
01817         m_updateTimer-&gt;Stop();
01818         <a class="code" href="class_chameleon_window.html#d12">UpdateStatusBar</a>();
01819         <a class="code" href="class_chameleon_window.html#d6">OnUpdateSaveUI</a>();
01820         <a class="code" href="class_chameleon_window.html#d7">OnUpdateDebugUI</a>();
01821         <a class="code" href="class_chameleon_window.html#d8">OnUpdateConnectionUI</a>();
01822         <a class="code" href="class_chameleon_window.html#d9">OnUpdateCompileUI</a>();
01823         <a class="code" href="class_chameleon_window.html#d10">OnUpdateProjectUI</a>();
01824     }
01825 }
01826 
<a name="l01835"></a><a class="code" href="class_chameleon_window.html#d7">01835</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d7">ChameleonWindow::OnUpdateDebugUI</a>()
01836 {
01837     <span class="keywordflow">if</span>(!m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>()-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a93">PERM_DEBUG</a>))
01838     {
01839         <span class="keywordflow">return</span>;
01840     }
01841     <span class="keywordtype">bool</span> isDebugging = <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;<a class="code" href="class_debugger.html#a7">isDebugging</a>();
01842     <span class="keywordtype">bool</span> isPaused = <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;<a class="code" href="class_debugger.html#a8">isPaused</a>();
01843 
01844     wxToolBar* tb = GetToolBar();
01845 
01846     <span class="keywordflow">if</span>(isDebugging)
01847     {
01848         tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a73">ID_DEBUG_START</a>, <span class="keyword">false</span>);
01849         tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a74">ID_DEBUG_CONTINUE</a>, isPaused);
01850         tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a75">ID_DEBUG_STOP</a>, <span class="keyword">true</span>);
01851 
01852         tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a76">ID_DEBUG_STEPNEXT</a>, isPaused);
01853         tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a77">ID_DEBUG_STEPOVER</a>, isPaused);
01854         tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a78">ID_DEBUG_STEPOUT</a>, isPaused);
01855     }
01856     <span class="keywordflow">else</span>
01857     {
01858         <span class="comment">// skip ID_DEBUG_START;</span>
01859         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = <a class="code" href="datastructures_8h.html#a149a72">ID_DEBUG_IDS_FIRST</a> + 1; i &lt; <a class="code" href="datastructures_8h.html#a149a79">ID_DEBUG_IDS_LAST</a>; i++)
01860         {
01861             tb-&gt;EnableTool(i, <span class="keyword">false</span>);
01862         }
01863 
01864         <a class="code" href="class_project_info.html">ProjectInfo</a>* proj = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a20">GetProject</a>();
01865 
01866         <span class="keywordtype">bool</span> canStartDebug = proj-&gt;<a class="code" href="class_project_info.html#a15">IsCompiled</a>();
01867         tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a73">ID_DEBUG_START</a>, canStartDebug);
01868     }
01869 }
01870 
<a name="l01879"></a><a class="code" href="class_chameleon_window.html#d8">01879</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d8">ChameleonWindow::OnUpdateConnectionUI</a>()<span class="comment">//wxUpdateUIEvent &amp;event)</span>
01880 {
01881     <span class="keywordflow">if</span>(!m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>()-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a94">PERM_TERMINAL</a>))
01882     {
01883         <span class="keywordflow">return</span>;
01884     }
01885     <span class="keywordtype">bool</span> termConnected = <a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="classwx_s_s_h.html#a9">IsConnected</a>();
01886 
01887     wxToolBar* tb = GetToolBar();
01888     tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a53">ID_STARTCONNECT</a>, !termConnected);
01889     tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a54">ID_DISCONNECT</a>, termConnected);
01890 
01891     wxMenuBar* mb = GetMenuBar();
01892     wxMenu* toolsMenu = mb-&gt;GetMenu(mb-&gt;FindMenu(<span class="stringliteral">"Tools"</span>));
01893 
01894     toolsMenu-&gt;Enable(<a class="code" href="datastructures_8h.html#a149a53">ID_STARTCONNECT</a>, !termConnected);
01895     toolsMenu-&gt;Enable(<a class="code" href="datastructures_8h.html#a149a54">ID_DISCONNECT</a>, termConnected);    
01896 }
01897 
<a name="l01906"></a><a class="code" href="class_chameleon_window.html#d9">01906</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d9">ChameleonWindow::OnUpdateCompileUI</a>()<span class="comment">//wxUpdateUIEvent &amp;event)</span>
01907 {
01908     <span class="keywordflow">if</span>(!m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>()-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a97">PERM_COMPILE</a>))
01909     {
01910         <span class="keywordflow">return</span>;
01911     }
01912 
01913     <a class="code" href="class_project_info.html">ProjectInfo</a>* edProj = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a20">GetProject</a>();
01914     wxToolBar* tb = GetToolBar();
01915     wxToolBarToolBase* compileButton = tb-&gt;FindById(<a class="code" href="datastructures_8h.html#a149a55">ID_COMPILE</a>);
01916 
01917     <span class="keywordtype">bool</span> canCompile = !edProj-&gt;<a class="code" href="class_project_info.html#a15">IsCompiled</a>();
01918     <span class="keywordtype">bool</span> currProjIsCompiling = <a class="code" href="class_chameleon_window.html#r25">m_compiler</a>-&gt;<a class="code" href="class_compiler.html#a3">IsCompiling</a>() &amp;&amp; edProj-&gt;<a class="code" href="class_project_info.html#a16">IsBeingCompiled</a>();
01919 
01920     <span class="comment">// The other half of the compile cancellation code.  If this is ever activated,</span>
01921     <span class="comment">// then a check needs to be made so that tb-&gt;Realize() is only called when it's</span>
01922     <span class="comment">// actually needed.  If it's called every time, there's some nasty flickering</span>
01923     <span class="comment">// in the toolbar.</span>
01924 
01925     <span class="comment">/*</span>
01926 <span class="comment">    // Choose the image &amp; caption:</span>
01927 <span class="comment">    if(currProjIsCompiling)</span>
01928 <span class="comment">    {</span>
01929 <span class="comment">    wxBitmap bmStopCompile(stop1_xpm);</span>
01930 <span class="comment">    compileButton-&gt;SetNormalBitmap(bmStopCompile);</span>
01931 <span class="comment">    compileButton-&gt;SetLabel("Stop");</span>
01932 <span class="comment">    }</span>
01933 <span class="comment">    else</span>
01934 <span class="comment">    {</span>
01935 <span class="comment">    wxBitmap bmBuild(build_xpm);</span>
01936 <span class="comment">    compileButton-&gt;SetNormalBitmap(bmBuild);</span>
01937 <span class="comment">    compileButton-&gt;SetLabel("Compile");</span>
01938 <span class="comment">    }</span>
01939 <span class="comment">    //tb-&gt;Realize();</span>
01940 <span class="comment">    */</span>
01941 
01942     <span class="keywordtype">bool</span> enableButton = canCompile &amp;&amp; !currProjIsCompiling; <span class="comment">//|| currProjIsCompiling;</span>
01943     tb-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a55">ID_COMPILE</a>, enableButton);
01944 }
01945 
<a name="l01954"></a><a class="code" href="class_chameleon_window.html#d12">01954</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d12">ChameleonWindow::UpdateStatusBar</a>()
01955 {
01956     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r5">m_statusBar</a> == <a class="code" href="_crc16_8h.html#a0">NULL</a>)
01957     {
01958         <span class="keywordflow">return</span>;
01959     }
01960 
01961     <span class="keywordtype">int</span> pageCount = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount();
01962     <span class="keywordflow">if</span>(pageCount &lt; 1 || pageCount &lt;= <a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>)
01963     {
01964         <span class="keywordflow">return</span>;
01965     }
01966     wxString tabText = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageText(<a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>);
01967     wxString filename;
01968     wxString location;
01969 
01970     filename = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a14">GetFileNameAndPath</a>();
01971 
01972     <span class="keywordflow">if</span>(tabText.StartsWith(<span class="stringliteral">"(R)"</span>))
01973     {           
01974         location = <span class="stringliteral">"Remote"</span>;
01975     }
01976     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tabText.StartsWith(<span class="stringliteral">"(L)"</span>))
01977     {
01978         location = <span class="stringliteral">"Local"</span>;
01979     }
01980     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tabText.StartsWith(<span class="stringliteral">"(?)"</span>))
01981     {
01982         filename = <span class="stringliteral">"Unsaved file"</span>;
01983         location = <span class="stringliteral">"N/A"</span>;
01984     }
01985 
01986     <span class="keywordflow">if</span>(filename != <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a>-&gt;GetStatusText(0))
01987     {
01988         <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a>-&gt;SetStatusText(filename, 0);
01989     }
01990 
01991     <span class="keywordflow">if</span>(location != <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a>-&gt;GetStatusText(1))
01992     {
01993         <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a>-&gt;SetStatusText(location, 1);
01994     }
01995 
01996     <span class="keywordtype">bool</span> isEdReadOnly = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a20">GetProject</a>()-&gt;<a class="code" href="class_project_info.html#a17">IsReadOnly</a>();
01997 
01998     wxString editable = isEdReadOnly ? <span class="stringliteral">"Read-only"</span> : <span class="stringliteral">"Read-write"</span>;
01999 
02000     <span class="keywordflow">if</span>(editable != <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a>-&gt;GetStatusText(2))
02001     {
02002         <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a>-&gt;SetStatusText(editable, 2);
02003     }
02004 
02005     <span class="keywordtype">int</span> curLine = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetCurrentLine();
02006     <span class="keywordtype">int</span> curPos = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetCurrentPos() -<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;PositionFromLine (-curLine);
02007     wxString linecol;
02008     linecol.Printf (_(<span class="stringliteral">"Line: %d, Col: %d"</span>), curLine, curPos);
02009     <span class="keywordflow">if</span> (linecol != <a class="code" href="class_chameleon_window.html#r5">m_statusBar</a>-&gt;GetStatusText (4)) 
02010     {
02011         SetStatusText (linecol, 4);
02012     }
02013 }
02014 
<a name="l02023"></a><a class="code" href="class_chameleon_window.html#d6">02023</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d6">ChameleonWindow::OnUpdateSaveUI</a>()<span class="comment">//wxUpdateUIEvent &amp;event)</span>
02024 {
02025     <span class="keywordtype">bool</span> enable = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a6">Modified</a>();
02026 
02027     <span class="keywordtype">int</span> tabNum = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetSelection();
02028     wxString title = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageText(tabNum);
02029 
02030     <span class="keywordflow">if</span>(enable)
02031     {
02032         <span class="keywordtype">int</span> tabNum = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetSelection();
02033         wxString title = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageText(tabNum);
02034 
02035         <span class="keywordflow">if</span>(!title.Contains(<span class="stringliteral">"*"</span>))
02036         {
02037             title += <span class="stringliteral">"*"</span>;
02038             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;SetPageText(tabNum, title);
02039             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
02040         }       
02041     }
02042     <span class="keywordflow">else</span>
02043     {
02044         <span class="keywordflow">if</span>(title.Contains(<span class="stringliteral">"*"</span>))
02045         {
02046             title.RemoveLast(1);
02047             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;SetPageText(tabNum, title);
02048             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
02049         }
02050     }
02051     GetToolBar()-&gt;EnableTool(<a class="code" href="datastructures_8h.html#a149a8">ID_SAVE</a>, enable);
02052     GetMenuBar()-&gt;FindItem(<a class="code" href="datastructures_8h.html#a149a8">ID_SAVE</a>)-&gt;Enable(enable);
02053 }
02054 
<a name="l02063"></a><a class="code" href="class_chameleon_window.html#d10">02063</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d10">ChameleonWindow::OnUpdateProjectUI</a> ()
02064 {
02065     <span class="comment">/*</span>
02066 <span class="comment">    bool enable = (m_book-&gt;GetPageCount() &gt; 1) ||</span>
02067 <span class="comment">        (m_currentEd &amp;&amp; (m_currentEd-&gt;GetLength() &gt; 0));</span>
02068 <span class="comment">    */</span>
02069     <span class="keywordtype">bool</span> projectOpen = (<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>);
02070 
02071     wxMenuBar* mb = GetMenuBar();
02072     mb-&gt;FindItem(<a class="code" href="datastructures_8h.html#a149a19">ID_CLOSE_PROJECT</a>)-&gt;Enable(projectOpen);
02073     mb-&gt;FindItem(<a class="code" href="datastructures_8h.html#a149a56">ID_COMPILE_PROJECT</a>)-&gt;Enable(projectOpen);
02074 }
02075 
02076 <span class="comment">// Gets / sets begin here</span>
02077 
<a name="l02089"></a><a class="code" href="class_chameleon_window.html#a2">02089</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#a2">ChameleonWindow::SetIntVar</a>(<span class="keywordtype">int</span> variableName, <span class="keywordtype">int</span> value)
02090 {
02091     <span class="comment">// figure out which integer I'm setting</span>
02092     <span class="keywordtype">int</span>* target = <a class="code" href="class_chameleon_window.html#d46">SelectIntVar</a>(variableName);
02093 
02094     <span class="comment">// assuming we assigned it properly, Set it </span>
02095     <span class="keywordflow">if</span>(target != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
02096     {
02097         *target = value;
02098     }
02099 }
02100 
<a name="l02111"></a><a class="code" href="class_chameleon_window.html#a3">02111</a> <span class="keywordtype">int</span> <a class="code" href="class_chameleon_window.html#a3">ChameleonWindow::GetIntVar</a>(<span class="keywordtype">int</span> variableName)
02112 {
02113     <span class="keywordtype">int</span>* target = <a class="code" href="class_chameleon_window.html#d46">SelectIntVar</a>(variableName);
02114 
02115     <span class="keywordflow">if</span>(target != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
02116     {
02117         <span class="keywordflow">return</span> *target;
02118     }
02119     <span class="keywordflow">else</span>
02120     {
02121         <span class="keywordflow">return</span> 0;
02122     }
02123 }
02124 
<a name="l02135"></a><a class="code" href="class_chameleon_window.html#d46">02135</a> <span class="keywordtype">int</span>* <a class="code" href="class_chameleon_window.html#d46">ChameleonWindow::SelectIntVar</a>(<span class="keywordtype">int</span> variableName)
02136 {
02137     <span class="keywordflow">switch</span>(variableName)
02138     {
02139     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a147a1">VN_NUMPAGES</a>:
02140         <span class="keywordflow">return</span> &amp;<a class="code" href="class_chameleon_window.html#r29">m_numPages</a>;
02141         <span class="keywordflow">break</span>;
02142     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a147a2">VN_CURRENTPAGE</a>:
02143         <span class="keywordflow">return</span> &amp;<a class="code" href="class_chameleon_window.html#r30">m_currentPage</a>;
02144         <span class="keywordflow">break</span>;
02145     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a147a3">VN_CLICKEDTAB</a>:
02146         <span class="keywordflow">return</span> &amp;<a class="code" href="class_chameleon_window.html#r32">m_clickedTabNum</a>;
02147         <span class="keywordflow">break</span>;
02148     <span class="keywordflow">default</span>:
02149         wxLogDebug(<span class="stringliteral">"Failed to properly set variable.  variableName = %d"</span>, variableName);
02150             <span class="keywordflow">return</span> <a class="code" href="_crc16_8h.html#a0">NULL</a>;
02151     }
02152 }
02153 
<a name="l02164"></a><a class="code" href="class_chameleon_window.html#a6">02164</a> <span class="keywordtype">bool</span> <a class="code" href="class_chameleon_window.html#a6">ChameleonWindow::IsDebugging</a>()
02165 {
02166     <span class="keywordflow">return</span> <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;<a class="code" href="class_debugger.html#a7">isDebugging</a>();
02167 }
02168 
<a name="l02177"></a><a class="code" href="class_chameleon_window.html#a7">02177</a> <span class="keywordtype">bool</span> <a class="code" href="class_chameleon_window.html#a7">ChameleonWindow::IsDebuggerPaused</a>()
02178 {
02179     <span class="keywordflow">return</span> <a class="code" href="class_chameleon_window.html#r28">m_debugger</a>-&gt;<a class="code" href="class_debugger.html#a8">isPaused</a>();
02180 }
02181 
<a name="l02192"></a><a class="code" href="class_chameleon_window.html#a12">02192</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#a12">ChameleonWindow::PassImageList</a>(wxImageList* imagelist)
02193 {
02194     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;AssignImageList(imagelist);
02195 }
02196 
02197 <span class="comment">// Options evaluation and GUI reconfiguration code begins here</span>
02198 
<a name="l02209"></a><a class="code" href="class_chameleon_window.html#d42">02209</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d42">ChameleonWindow::EvaluateOptions</a>()
02210 {
02211     m_network-&gt;<a class="code" href="class_networking.html#a5">PingOptions</a>();
02212 
02213     <a class="code" href="class_permission.html">Permission</a>* perms = m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>();
02214 
02215     <a class="code" href="class_chameleon_window.html#d44">UpdateToolbar</a>();
02216     <a class="code" href="class_chameleon_window.html#d43">UpdateMenuBar</a>();
02217     <a class="code" href="class_chameleon_window.html#d45">UpdateTerminalNotebook</a>();
02218 
02219     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a96">PERM_PROJECTS</a>))
02220     {
02221         <span class="keywordflow">if</span>(!<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;IsShown())
02222         {
02223             <a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>-&gt;SplitVertically(<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>, <a class="code" href="class_chameleon_window.html#r1">m_book</a>, 200);
02224             <a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>-&gt;SetMinimumPaneSize(20);
02225             <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;Show();
02226         }
02227     }
02228     <span class="keywordflow">else</span>
02229     {
02230         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
02231         {
02232             <a class="code" href="class_chameleon_window.html#d35">CloseProjectFile</a>(<span class="keyword">false</span>);
02233         }
02234         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;IsShown())
02235         {
02236             <a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>-&gt;Unsplit(<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>);
02237             <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;Hide();
02238             <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
02239         }
02240     }
02241 
02242     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (<span class="keywordtype">int</span>)<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPageCount(); i++)
02243     {
02244         <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* edit = static_cast&lt;ChameleonEditor*&gt; (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage(i));
02245         edit-&gt;<a class="code" href="class_chameleon_editor.html#a12">UpdateSyntaxHighlighting</a>();
02246     }
02247 
02248     <span class="keywordtype">int</span> newMaxTermSize = m_options-&gt;<a class="code" href="class_options.html#a24">GetTerminalHistorySize</a>();
02249     <a class="code" href="class_chameleon_window.html#r9">m_termContainer</a>-&gt;<a class="code" href="classwx_term_container.html#a12">SetTerminalHistory</a>(newMaxTermSize);
02250 
02251     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Permissions/enabled"</span>, perms-&gt;<a class="code" href="class_permission.html#a10">getGlobalEnabled</a>());
02252     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Network/hostname"</span>, m_options-&gt;<a class="code" href="class_options.html#a17">GetHostname</a>());
02253     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Network/username"</span>, m_options-&gt;<a class="code" href="class_options.html#a16">GetUsername</a>());
02254     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Compiler/mingwpath"</span>, m_options-&gt;<a class="code" href="class_options.html#a15">GetMingwPath</a>());
02255     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Miscellaneous/TerminalHistory"</span>, newMaxTermSize);
02256 
02257     <span class="keywordtype">bool</span> printInColor = (m_options-&gt;<a class="code" href="class_options.html#a22">GetPrintStyle</a>() == <a class="code" href="_options_8h.html#a1">wxSTC_PRINT_COLOURONWHITE</a>);
02258 
02259     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Miscellaneous/PrintInColor"</span>, printInColor ? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span>);
02260     
02261 
02262     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Flush();
02263 }
02264 
<a name="l02273"></a><a class="code" href="class_chameleon_window.html#d43">02273</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d43">ChameleonWindow::UpdateMenuBar</a>()
02274 {
02275     wxMenuBar* menuBar = GetMenuBar();
02276 
02277     <a class="code" href="class_permission.html">Permission</a>* perms = m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>();
02278 
02279     <span class="keywordtype">bool</span> localModeEnabled = perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a95">PERM_LOCALMODE</a>);
02280     <span class="keywordflow">if</span>(menuBar != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
02281     {
02282         SetMenuBar(<a class="code" href="_crc16_8h.html#a0">NULL</a>);
02283         <span class="keyword">delete</span> menuBar;
02284     }
02285 
02286     menuBar = <span class="keyword">new</span> wxMenuBar();
02287     SetMenuBar(menuBar);
02288 
02289     wxMenu* menuFile = <span class="keyword">new</span> wxMenu();
02290 
02291     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a7">ID_NEW_SOURCE</a>, <span class="stringliteral">"&amp;New File\tCtrl-N"</span>, <span class="stringliteral">"Create a new C++ file"</span>);
02292     <span class="keywordflow">if</span>(localModeEnabled)
02293     {
02294         menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a11">ID_OPEN_SOURCE_LOCAL</a>, <span class="stringliteral">"&amp;Open File (Local)"</span>, <span class="stringliteral">"Open an existing C++ file"</span>);
02295     }
02296     
02297     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a12">ID_OPEN_SOURCE_REMOTE</a>, <span class="stringliteral">"&amp;Open File (Remote)"</span>, <span class="stringliteral">"Open an existing C++ file"</span>);
02298     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a13">ID_CLOSEPAGE</a>, <span class="stringliteral">"&amp;Close File"</span>, <span class="stringliteral">"Close the active file"</span>);
02299     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a14">ID_CLOSEALL</a>, <span class="stringliteral">"Close All Files"</span>);
02300     menuFile-&gt;AppendSeparator();
02301     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a8">ID_SAVE</a>, <span class="stringliteral">"&amp;Save File\tCtrl-S"</span>, <span class="stringliteral">"Save the current file"</span>);
02302 
02303     <span class="keywordflow">if</span>(localModeEnabled)
02304     {
02305         menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a9">ID_SAVE_SOURCE_LOCAL</a>, <span class="stringliteral">"Save File &amp;As (Local)"</span>, <span class="stringliteral">"Save the current file as a different name"</span>);
02306     }
02307     
02308     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a10">ID_SAVE_SOURCE_REMOTE</a>, <span class="stringliteral">"Save File &amp;As (Remote)"</span>, <span class="stringliteral">"Save the current file as a different name"</span>);
02309     menuFile-&gt;AppendSeparator();
02310 
02311     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a20">ID_PRINT_PAGE</a>, <span class="stringliteral">"&amp;Print\tCtrl-P"</span>, <span class="stringliteral">"Print the current file"</span>);
02312     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a21">ID_PRINT_PREVIEW</a>, <span class="stringliteral">"Print preview"</span>);
02313     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a22">ID_PRINT_SETUP</a>, <span class="stringliteral">"Print setup"</span>);
02314     
02315     menuFile-&gt;Append(<a class="code" href="datastructures_8h.html#a149a6">ID_QUIT</a>, <span class="stringliteral">"E&amp;xit\tAlt-F4"</span>, <span class="stringliteral">"Quit this program"</span>);
02316 
02317     menuBar-&gt;Append(menuFile, <span class="stringliteral">"&amp;File"</span>);
02318 
02319 
02320     wxMenu* menuEdit = <span class="keyword">new</span> wxMenu();
02321 
02322     menuEdit-&gt;Append(<a class="code" href="datastructures_8h.html#a149a41">ID_UNDO</a>, <span class="stringliteral">"&amp;Undo\tCtrl-Z"</span>);
02323     menuEdit-&gt;Append(<a class="code" href="datastructures_8h.html#a149a42">ID_REDO</a>, <span class="stringliteral">"&amp;Redo\tCtrl-Y"</span>);
02324     menuEdit-&gt;AppendSeparator();
02325     menuEdit-&gt;Append(<a class="code" href="datastructures_8h.html#a149a44">ID_CUT</a>, <span class="stringliteral">"Cu&amp;t\tCtrl-X"</span>);
02326     menuEdit-&gt;Append(<a class="code" href="datastructures_8h.html#a149a43">ID_COPY</a>, <span class="stringliteral">"&amp;Copy\tCtrl-C"</span>);
02327     menuEdit-&gt;Append(<a class="code" href="datastructures_8h.html#a149a45">ID_PASTE</a>, <span class="stringliteral">"&amp;Paste\tCtrl-V"</span>);
02328     menuEdit-&gt;AppendSeparator();
02329     menuEdit-&gt;Append(<a class="code" href="datastructures_8h.html#a149a46">ID_FIND</a>, <span class="stringliteral">"Find\tCtrl-F"</span>);
02330     menuEdit-&gt;Append(<a class="code" href="datastructures_8h.html#a149a47">ID_REPLACE</a>, <span class="stringliteral">"Replace\tCtrl-H"</span>);
02331     
02332     <span class="comment">// TODO Implement these Edit menu items</span>
02333 
02334     <span class="comment">/*</span>
02335 <span class="comment">    menuEdit-&gt;AppendSeparator();</span>
02336 <span class="comment">    menuEdit-&gt;Append(ID_INDENT, "Indent text\tTab");</span>
02337 <span class="comment">    menuEdit-&gt;Append(ID_UNINDENT, "Unindent text\tShift-Tab");</span>
02338 <span class="comment">    menuEdit-&gt;AppendSeparator();</span>
02339 <span class="comment">    menuEdit-&gt;Append(ID_SELECTALL, "Select all\tCtrl-A");</span>
02340 <span class="comment">    menuEdit-&gt;Append(ID_SELECTLINE, "Select line");</span>
02341 <span class="comment">    */</span>
02342 
02343     menuBar-&gt;Append(menuEdit, <span class="stringliteral">"&amp;Edit"</span>);
02344 
02345     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a96">PERM_PROJECTS</a>))
02346     {
02347         wxMenu* menuProject = <span class="keyword">new</span> wxMenu();
02348         menuProject-&gt;Append(<a class="code" href="datastructures_8h.html#a149a16">ID_NEW_PROJECT</a>, <span class="stringliteral">"Create New Project"</span>);
02349 
02350         <span class="keywordflow">if</span>(localModeEnabled)
02351         {
02352             menuProject-&gt;Append(<a class="code" href="datastructures_8h.html#a149a17">ID_OPEN_PROJECT_LOCAL</a>, <span class="stringliteral">"Open Project File (Local)"</span>);
02353         }
02354 
02355         menuProject-&gt;Append(<a class="code" href="datastructures_8h.html#a149a18">ID_OPEN_PROJECT_REMOTE</a>, <span class="stringliteral">"Open Project File (Remote)"</span>);
02356         menuProject-&gt;Append(<a class="code" href="datastructures_8h.html#a149a19">ID_CLOSE_PROJECT</a>, <span class="stringliteral">"Close Project"</span>);
02357 
02358         menuProject-&gt;AppendSeparator();
02359         menuProject-&gt;Append(<a class="code" href="datastructures_8h.html#a149a56">ID_COMPILE_PROJECT</a>, <span class="stringliteral">"Compile Active Project"</span>);
02360 
02361         menuBar-&gt;Append(menuProject, <span class="stringliteral">"&amp;Projects"</span>);
02362     }
02363 
02364     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a97">PERM_COMPILE</a>))
02365     {
02366         wxMenu* compileMenu = <span class="keyword">new</span> wxMenu();
02367         compileMenu-&gt;Append(<a class="code" href="datastructures_8h.html#a149a55">ID_COMPILE</a>, <span class="stringliteral">"Compile File"</span>);
02368         menuBar-&gt;Append(compileMenu, <span class="stringliteral">"&amp;Compile"</span>);
02369     }
02370 
02371 
02372     wxMenu* menuTools = <span class="keyword">new</span> wxMenu();
02373 
02374     menuTools-&gt;Append(<a class="code" href="datastructures_8h.html#a149a52">ID_OPTIONS</a>, <span class="stringliteral">"&amp;Options"</span>);
02375 
02376     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a94">PERM_TERMINAL</a>))
02377     {
02378         menuTools-&gt;AppendSeparator();
02379         menuTools-&gt;Append(<a class="code" href="datastructures_8h.html#a149a53">ID_STARTCONNECT</a>, <span class="stringliteral">"&amp;Connect to server"</span>);
02380         menuTools-&gt;Append(<a class="code" href="datastructures_8h.html#a149a54">ID_DISCONNECT</a>, <span class="stringliteral">"&amp;Disconnect from server"</span>);
02381     }
02382     menuBar-&gt;Append(menuTools, <span class="stringliteral">"&amp;Tools"</span>);
02383 
02384     wxMenu *helpMenu = <span class="keyword">new</span> wxMenu;
02385     helpMenu-&gt;Append(<a class="code" href="datastructures_8h.html#a149a59">ID_HELP</a>, <span class="stringliteral">"Chameleon help contents"</span>);
02386     helpMenu-&gt;Append(<a class="code" href="datastructures_8h.html#a149a58">ID_ABOUT</a>, <span class="stringliteral">"&amp;About Chameleon"</span>, <span class="stringliteral">"Show about dialog"</span>);    
02387     
02388     menuBar-&gt;Append(helpMenu, <span class="stringliteral">"&amp;Help"</span>);
02389 }
02390 
<a name="l02399"></a><a class="code" href="class_chameleon_window.html#d44">02399</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d44">ChameleonWindow::UpdateToolbar</a>()
02400 {
02401     <a class="code" href="class_permission.html">Permission</a>* perms = m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>();
02402 
02403     wxToolBar* t = GetToolBar();
02404     <span class="keyword">delete</span> t;
02405     SetToolBar(<a class="code" href="_crc16_8h.html#a0">NULL</a>);
02406     <span class="keywordtype">int</span> style = wxTB_FLAT | wxTB_HORIZONTAL;
02407 
02408     <span class="keywordtype">bool</span> showText = m_options-&gt;<a class="code" href="class_options.html#a23">GetShowToolbarText</a>();
02409     <span class="keywordflow">if</span>(showText)
02410     {
02411         style |= wxTB_TEXT;
02412     }
02413     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Interface/ShowToolbarText"</span>, showText ? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span>);
02414     t = <span class="keyword">new</span> wxToolBar(<span class="keyword">this</span>, -1, wxDefaultPosition, wxDefaultSize, style);
02415     SetToolBar(t);
02416 
02417     wxBitmap bmNew(newfile_xpm);
02418     t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a7">ID_NEW_SOURCE</a>, <span class="stringliteral">"New"</span>, bmNew, <span class="stringliteral">"New source file"</span>); 
02419     
02420     <span class="comment">//wxBitmap bmOpen((open_xpm);</span>
02421     
02422     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a95">PERM_LOCALMODE</a>))
02423     {
02424         wxBitmap bmOpenLocal(openlocal_xpm);
02425         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a11">ID_OPEN_SOURCE_LOCAL</a>, <span class="stringliteral">"Open (L)"</span>, bmOpenLocal, <span class="stringliteral">"Open a file from the local computer"</span>);
02426     }   
02427     wxBitmap bmOpenRemote(openremote_xpm);
02428     t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a12">ID_OPEN_SOURCE_REMOTE</a>, <span class="stringliteral">"Open (R)"</span>, bmOpenRemote, <span class="stringliteral">"Open a file from the remote server"</span>);
02429 
02430     wxBitmap bmSave(savefile_xpm);
02431     t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a8">ID_SAVE</a>, <span class="stringliteral">"Save"</span>, bmSave, <span class="stringliteral">"Save the current file"</span>);
02432 
02433     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a94">PERM_TERMINAL</a>))
02434     {
02435         t-&gt;AddSeparator();
02436 
02437         wxBitmap bmConnect(connect16_xpm);
02438         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a53">ID_STARTCONNECT</a>, <span class="stringliteral">"Connect"</span>, bmConnect, <span class="stringliteral">"Connect the terminal to the remote server"</span>);
02439 
02440         wxBitmap bmDisconnect(disconnect16_xpm);
02441         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a54">ID_DISCONNECT</a>, <span class="stringliteral">"Disconnect"</span>, bmDisconnect, <span class="stringliteral">"Disconnect the terminal from the remote server"</span>);        
02442     }
02443 
02444 
02445     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a99">PERM_TEST</a>))
02446     {
02447         t-&gt;AddSeparator();  
02448 
02449         wxBitmap bmTest(button_xpm);
02450         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a60">ID_TEST</a>, <span class="stringliteral">"Test"</span>, bmTest);
02451     }
02452 
02453     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a97">PERM_COMPILE</a>))
02454     {
02455         t-&gt;AddSeparator();
02456         wxBitmap bmCompile(build_xpm);
02457         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a55">ID_COMPILE</a>, <span class="stringliteral">"Compile"</span>, bmCompile, <span class="stringliteral">"Compile the current project or file"</span>);
02458     }
02459     
02460     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a93">PERM_DEBUG</a>))
02461     {
02462         t-&gt;AddSeparator();
02463         wxBitmap bmStart(newstart1_xpm);
02464         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a73">ID_DEBUG_START</a>, <span class="stringliteral">"Start"</span>, bmStart, <span class="stringliteral">"Start debugging the current project or file"</span>);
02465 
02466         wxBitmap bmStop(newstop1_xpm);
02467         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a75">ID_DEBUG_STOP</a>, <span class="stringliteral">"Stop"</span>, bmStop, <span class="stringliteral">"Stop debugging"</span>);
02468 
02469         wxBitmap bmContinue(newcontinue1_xpm);
02470         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a74">ID_DEBUG_CONTINUE</a>, <span class="stringliteral">"Continue"</span>, bmContinue, <span class="stringliteral">"Resume when paused at a breakpoint"</span>);
02471 
02472         wxBitmap bmStepNext(stepnext_xpm);
02473         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a76">ID_DEBUG_STEPNEXT</a>, <span class="stringliteral">"Step next"</span>, bmStepNext, 
02474             <span class="stringliteral">"Run the next line of code, stepping into it if it's a function call"</span>);
02475 
02476         wxBitmap bmStepOver(stepover_xpm);
02477         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a77">ID_DEBUG_STEPOVER</a>, <span class="stringliteral">"Step over"</span>, bmStepOver, 
02478             <span class="stringliteral">"Run the next line of code, but don't go inside if it's a function call"</span>);
02479 
02480         wxBitmap bmStepOut(stepout_xpm);
02481         t-&gt;AddTool(<a class="code" href="datastructures_8h.html#a149a78">ID_DEBUG_STEPOUT</a>, <span class="stringliteral">"Step out"</span>, bmStepOut,
02482             <span class="stringliteral">"Run all the code in the current function"</span>);
02483 
02484         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = <a class="code" href="datastructures_8h.html#a149a72">ID_DEBUG_IDS_FIRST</a>; i &lt; <a class="code" href="datastructures_8h.html#a149a79">ID_DEBUG_IDS_LAST</a>; i++)
02485         {
02486             t-&gt;EnableTool(i, <span class="keyword">false</span>);
02487         }
02488     }
02489 
02490     t-&gt;Realize();
02491     
02492 
02493     <a class="code" href="class_chameleon_window.html#r17">m_config</a>-&gt;Write(<span class="stringliteral">"Interface/ShowToolbarText"</span>, showText ? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span>);
02494 }
02495 
<a name="l02504"></a><a class="code" href="class_chameleon_window.html#d45">02504</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d45">ChameleonWindow::UpdateTerminalNotebook</a>()
02505 {
02506     <a class="code" href="class_permission.html">Permission</a>* perms = m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>();
02507     <span class="keywordtype">int</span> splitterLocation = <a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>-&gt;GetSashPosition();
02508 
02509     <span class="keywordtype">int</span> numPages = <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;GetPageCount();
02510     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPages; i++)
02511     {
02512         wxNotebookPage* page = <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;GetPage(0);
02513         page-&gt;Hide();
02514         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;RemovePage(0);
02515     }
02516 
02517     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a94">PERM_TERMINAL</a>))
02518     {
02519         <a class="code" href="class_chameleon_window.html#r9">m_termContainer</a>-&gt;Show();
02520         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;AddPage(<a class="code" href="class_chameleon_window.html#r9">m_termContainer</a>, <span class="stringliteral">"Terminal"</span>);
02521     }
02522     <span class="keywordflow">else</span>
02523     {
02524         <a class="code" href="class_chameleon_window.html#r9">m_termContainer</a>-&gt;Hide();
02525     }
02526 
02527     <span class="keywordtype">bool</span> advCompileEnabled = perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a98">PERM_ADVANCEDCOMPILE</a>);
02528     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a97">PERM_COMPILE</a>))
02529     {
02530         <a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>-&gt;Show();
02531         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;AddPage(<a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>, <span class="stringliteral">"Compiler Output"</span>);
02532         <a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>-&gt;<a class="code" href="class_compiler_output_panel.html#a8">SetAdvanced</a>(advCompileEnabled);
02533     }   
02534     <span class="keywordflow">else</span>
02535     {
02536         <a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>-&gt;Hide();
02537     }
02538 
02539     <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a93">PERM_DEBUG</a>))
02540     {
02541         <a class="code" href="class_chameleon_window.html#r11">m_watchPanel</a>-&gt;Show();
02542         <a class="code" href="class_chameleon_window.html#r10">m_debugTermContainer</a>-&gt;Show();
02543         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;AddPage(<a class="code" href="class_chameleon_window.html#r11">m_watchPanel</a>, <span class="stringliteral">"Variable Watches"</span>);
02544         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;AddPage(<a class="code" href="class_chameleon_window.html#r10">m_debugTermContainer</a>, <span class="stringliteral">"Debug I/O"</span>);
02545     }
02546     <span class="keywordflow">else</span>
02547     {
02548         <a class="code" href="class_chameleon_window.html#r11">m_watchPanel</a>-&gt;Hide();
02549         <a class="code" href="class_chameleon_window.html#r10">m_debugTermContainer</a>-&gt;Hide();
02550     }
02551 
02552     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;GetPageCount() == 0)
02553     {
02554         <a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>-&gt;Unsplit();
02555         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;Hide();
02556     }
02557     <span class="keywordflow">else</span>
02558     {
02559         <span class="keywordflow">if</span>(!<a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>-&gt;IsSplit())
02560         {
02561             <a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>-&gt;SplitHorizontally(<a class="code" href="class_chameleon_window.html#r7">m_splitProjectEditor</a>, <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>, -260);<span class="comment">//-200);</span>
02562             <a class="code" href="class_chameleon_window.html#r6">m_splitEditorOutput</a>-&gt;SetMinimumPaneSize(20);
02563             <a class="code" href="class_chameleon_window.html#r12">m_terminal</a>-&gt;<a class="code" href="classwx_term.html#a18">UpdateSize</a>();
02564             <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;Show(); 
02565         }       
02566         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;SetSelection(0);
02567         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;GetPage(0)-&gt;SetFocus();
02568     }
02569     <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;Refresh();
02570     <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
02571 }
02572 
02573 <span class="comment">// Project code begins here</span>
02574 
<a name="l02586"></a><a class="code" href="class_chameleon_window.html#d17">02586</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d17">ChameleonWindow::OnTreeItemRightClick</a>(wxTreeEvent&amp; event)
02587 {
02588     wxTreeItemId clickedItem = event.GetItem();
02589     <a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a> = clickedItem;
02590     wxMenu popupMenu;
02591 
02592     wxTreeItemId rootItem = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetRootItem();
02593     wxTreeItemId parentItem = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetItemParent(clickedItem);
02594 
02595     <span class="keywordtype">bool</span> rootClicked = (clickedItem == rootItem);
02596 
02597     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> == <a class="code" href="_crc16_8h.html#a0">NULL</a> &amp;&amp; !rootClicked)
02598     {
02599         wxMessageBox(<span class="stringliteral">"You do not currently have a project open."</span>, <span class="stringliteral">"No project open"</span>, 
02600             wxOK | wxCENTRE | wxICON_EXCLAMATION);
02601         <span class="keywordflow">return</span>;
02602     }
02603 
02604     <span class="keywordflow">if</span>(parentItem == rootItem)
02605     {
02606         wxString label = <span class="stringliteral">"Add file"</span>;
02607         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a> == <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[0])
02608         {       
02609             <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a> = <a class="code" href="datastructures_8h.html#a156a132">FILE_SOURCES</a>;
02610             label = <span class="stringliteral">"Add source file"</span>;
02611         }
02612         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a> == m_projectFileFolders[1])
02613         {       
02614             <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a> = <a class="code" href="datastructures_8h.html#a156a133">FILE_HEADERS</a>;
02615             label = <span class="stringliteral">"Add header file"</span>;
02616         }
02617         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a> == m_projectFileFolders[2])
02618         {       
02619             <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a> = <a class="code" href="datastructures_8h.html#a156a131">FILE_LIBRARIES</a>;
02620             label = <span class="stringliteral">"Add library"</span>;
02621         }
02622 
02623         popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a61">ID_PROJECT_ADDFILE</a>, label);
02624     }
02625     <span class="comment">// user right-clicked a file in the project</span>
02626     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(clickedItem == rootItem)
02627     {
02628         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
02629         {
02630             popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a56">ID_COMPILE_PROJECT</a>, <span class="stringliteral">"Compile this project"</span>);
02631             popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a19">ID_CLOSE_PROJECT</a>, <span class="stringliteral">"Close this project"</span>);
02632         }
02633         <span class="keywordflow">else</span>
02634         {
02635             <a class="code" href="class_permission.html">Permission</a>* perms = m_options-&gt;<a class="code" href="class_options.html#a21">GetPerms</a>();
02636             popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a16">ID_NEW_PROJECT</a>, <span class="stringliteral">"Create a new project"</span>);
02637             <span class="keywordflow">if</span>(perms-&gt;<a class="code" href="class_permission.html#a2">isEnabled</a>(<a class="code" href="datastructures_8h.html#a150a95">PERM_LOCALMODE</a>))
02638             {
02639                 popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a17">ID_OPEN_PROJECT_LOCAL</a>, <span class="stringliteral">"Open a local project"</span>);
02640             }
02641             popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a18">ID_OPEN_PROJECT_REMOTE</a>, <span class="stringliteral">"Open a remote project"</span>);          
02642         }       
02643     }
02644     <span class="keywordflow">else</span>
02645     {
02646         <span class="keywordflow">if</span>(parentItem == <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[0])
02647         {
02648             <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a> = <a class="code" href="datastructures_8h.html#a156a132">FILE_SOURCES</a>;
02649         }
02650         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(parentItem == m_projectFileFolders[1])
02651         {
02652             <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a> = <a class="code" href="datastructures_8h.html#a156a133">FILE_HEADERS</a>;
02653         }
02654         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(parentItem == m_projectFileFolders[2])
02655         {
02656             <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a> = <a class="code" href="datastructures_8h.html#a156a131">FILE_LIBRARIES</a>;
02657         }
02658 
02659         popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a62">ID_PROJECT_REMOVEFILE</a>, <span class="stringliteral">"Remove file from project"</span>);
02660 
02661         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a> != <a class="code" href="datastructures_8h.html#a156a131">FILE_LIBRARIES</a>)
02662         {
02663             <a class="code" href="class_file_name_tree_data.html">FileNameTreeData</a>* data = static_cast &lt;FileNameTreeData* &gt; (<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetItemData(clickedItem));
02664             <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a4">FileIncludedInBuild</a>(data-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a>, <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a>))
02665             {
02666                 popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a70">ID_PROJECT_EXCLUDE_FILE</a>, <span class="stringliteral">"Exclude file from compilation"</span>);
02667             }
02668             <span class="keywordflow">else</span>
02669             {
02670                 popupMenu.Append(<a class="code" href="datastructures_8h.html#a149a71">ID_PROJECT_INCLUDE_FILE</a>, <span class="stringliteral">"Include file in compilation"</span>);
02671             }
02672         }       
02673     }
02674 
02675     wxPoint p = event.GetPoint();
02676     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;PopupMenu(&amp;popupMenu, p);
02677 }
02678 
02679 
<a name="l02690"></a><a class="code" href="class_chameleon_window.html#d31">02690</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d31">ChameleonWindow::OpenProjectFile</a>(<span class="keywordtype">bool</span> isRemote)
02691 {   
02692     m_remoteMode = isRemote;
02693     wxPathFormat currentPathFormat = m_remoteMode ? wxPATH_UNIX : wxPATH_DOS;
02694     
02695     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
02696     {
02697         wxString message = <span class="stringliteral">"A project is already open.  Do you want to replace the currently open project"</span>;
02698         message += <span class="stringliteral">" with a different one?"</span>;
02699         <span class="keywordtype">int</span> result = wxMessageBox(message, <span class="stringliteral">"Project already open"</span>, wxOK | wxCANCEL | wxICON_QUESTION);
02700 
02701         <span class="keywordflow">if</span>(result == wxCANCEL)
02702         {
02703             <span class="keywordflow">return</span>;
02704         }
02705     }   
02706 
02707     wxArrayString fileNames = <a class="code" href="class_chameleon_window.html#d22">OpenFile</a>(<a class="code" href="datastructures_8h.html#a156a130">FILE_PROJECT</a>);
02708 
02709     <span class="keywordflow">if</span>(fileNames.Count() &lt; 1)
02710     {
02711         wxLogDebug(<span class="stringliteral">"No files selected when adding to project"</span>);
02712         <span class="keywordflow">return</span>;
02713     }
02714 
02715     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;Freeze();
02716     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
02717     {
02718         <a class="code" href="class_chameleon_window.html#d35">CloseProjectFile</a>();
02719     }   
02720     
02721     <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> = <span class="keyword">new</span> <a class="code" href="class_project_info.html">ProjectInfo</a>(<span class="keyword">false</span>);
02722 
02723     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;DeleteChildren(<a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[0]);
02724     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;DeleteChildren(<a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[1]);
02725     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;DeleteChildren(<a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[2]);
02726 
02727     wxString fileContents;
02728     wxString fileName;
02729 
02730     <a class="code" href="class_chameleon_window.html#d24">GetFileContents</a>(fileNames[0], fileContents, fileName);
02731 
02732 
02733     <span class="comment">// set the current project's base path based on the project file's directory, </span>
02734     <span class="comment">// choosing the path separators based on where the file is stored</span>
02735 
02736     wxFileName projectFileName(fileNames[0]);
02737 
02738     <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a30">SetProjectFile</a>(projectFileName);
02739     <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a25">SetRemote</a>(m_remoteMode);
02740 
02741     wxTreeItemId rootItem = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetRootItem();
02742     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;SetItemText(rootItem, fileName);
02743     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;SetItemBold(rootItem);
02744 
02745     wxMemoryInputStream projectFileStream(fileContents, fileContents.Len());
02746     
02747     wxFileConfig config(projectFileStream);
02748 
02749     <a class="code" href="class_chameleon_window.html#d36">LoadFilesIntoProjectTree</a>(<span class="stringliteral">"/Sources"</span>, <a class="code" href="datastructures_8h.html#a156a132">FILE_SOURCES</a>, <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[0], config, currentPathFormat);
02750     <a class="code" href="class_chameleon_window.html#d36">LoadFilesIntoProjectTree</a>(<span class="stringliteral">"/Headers"</span>, <a class="code" href="datastructures_8h.html#a156a133">FILE_HEADERS</a>, <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[1], config, currentPathFormat);
02751     <a class="code" href="class_chameleon_window.html#d36">LoadFilesIntoProjectTree</a>(<span class="stringliteral">"/Libraries"</span>, <a class="code" href="datastructures_8h.html#a156a131">FILE_LIBRARIES</a>, <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[2], config, currentPathFormat);
02752 
02753     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;Thaw();
02754 }
02755 
<a name="l02770"></a><a class="code" href="class_chameleon_window.html#d32">02770</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d32">ChameleonWindow::AddFileToProject</a>()
02771 {
02772     m_remoteMode = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a13">IsRemote</a>();
02773     wxArrayString fileNames = <a class="code" href="class_chameleon_window.html#d22">OpenFile</a>(<a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a>);
02774 
02775     <span class="keywordflow">if</span>(fileNames.Count() &lt; 1)
02776     {
02777         wxLogDebug(<span class="stringliteral">"No files selected when adding to project"</span>);
02778         <span class="keywordflow">return</span>;
02779     }
02780 
02781     wxString fileToOpen = fileNames[0];
02782 
02783     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a1">FileExistsInProject</a>(fileToOpen))
02784     {
02785         wxString message = <span class="stringliteral">"The file "</span> + fileToOpen + <span class="stringliteral">" already exists in this project, so it was not added."</span>;
02786         wxMessageBox(message, <span class="stringliteral">"File already in project"</span>, wxOK | wxCENTRE | wxICON_EXCLAMATION);
02787         <span class="keywordflow">return</span>;
02788     }
02789 
02790     wxString fileContents;
02791     wxString fileName;
02792 
02793     m_remoteMode = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a13">IsRemote</a>();
02794 
02795     <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a2">AddFileToProject</a>(fileToOpen, <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a>);
02796 
02797     <span class="keywordtype">int</span> iconIndex = iconIndex = <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[wxFileName(fileToOpen).GetExt()];
02798 
02799     <a class="code" href="class_file_name_tree_data.html">FileNameTreeData</a>* data = <span class="keyword">new</span> <a class="code" href="class_file_name_tree_data.html">FileNameTreeData</a>();
02800     data-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a> = fileToOpen;
02801 
02802     wxString simpleName = wxFileName(fileToOpen).GetFullName();
02803     
02804     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;AppendItem(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a>, simpleName, iconIndex, -1, data);
02805     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;SortChildren(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a>);
02806     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;Refresh();   
02807     
02808     wxFileName fn(fileToOpen);
02809     <span class="keywordtype">int</span> pageNum = <a class="code" href="class_chameleon_window.html#d29">GetPageNum</a>(fn);
02810 
02811     <span class="keywordflow">if</span>(pageNum != -1)
02812     {
02813         <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* edit = static_cast&lt;ChameleonEditor*&gt; (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage(pageNum));
02814         edit-&gt;<a class="code" href="class_chameleon_editor.html#a24">SetProject</a>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>);
02815     }
02816 
02817     <a class="code" href="class_chameleon_window.html#d34">SaveProjectFile</a>();
02818 }
02819 
<a name="l02830"></a><a class="code" href="class_chameleon_window.html#d18">02830</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d18">ChameleonWindow::OnTreeItemActivated</a>(wxTreeEvent &amp;event)
02831 {
02832     wxTreeItemId item = event.GetItem();
02833 
02834     wxTreeItemId rootItem = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetRootItem();
02835 
02836     <span class="keywordflow">if</span>( item != rootItem)
02837     {
02838         wxTreeItemId parentItem = <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetItemParent(item);
02839 
02840         <span class="keywordflow">if</span>( (parentItem == <a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[0]) ||
02841             (parentItem == m_projectFileFolders[1]) )
02842         {
02843             <a class="code" href="class_file_name_tree_data.html">FileNameTreeData</a>* data = static_cast &lt;FileNameTreeData* &gt; (<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetItemData(item));
02844             
02845             wxArrayString filesToOpen;
02846             wxString pathname = data-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a>;
02847             filesToOpen.Add(pathname);
02848 
02849             <a class="code" href="class_chameleon_window.html#a10">OpenSourceFile</a>(filesToOpen);
02850         }
02851         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(parentItem == m_projectFileFolders[2])
02852         {
02853             wxMessageBox(<span class="stringliteral">"Only source files can be opened"</span>, <span class="stringliteral">"Chameleon"</span>, wxOK | wxICON_INFORMATION);
02854             <span class="keywordflow">return</span>;
02855         }
02856     }
02857     <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;Refresh();
02858     <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;Refresh();
02859 }
02860 
<a name="l02871"></a><a class="code" href="class_chameleon_window.html#d35">02871</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d35">ChameleonWindow::CloseProjectFile</a>(<span class="keywordtype">bool</span> canUserCancel)
02872 {
02873     <span class="keywordflow">if</span>(!<a class="code" href="class_chameleon_window.html#r34">m_appClosing</a>)
02874     {
02875         EditorPointerArray edList = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a12">GetEditors</a>();
02876 
02877         <span class="keywordflow">if</span>(edList.GetCount() &gt; 0)
02878         {
02879             <span class="keywordtype">int</span> allowedResponse = wxYES_NO;
02880 
02881             <span class="keywordflow">if</span>(canUserCancel)
02882             {
02883                 allowedResponse |= wxCANCEL;
02884             }
02885 
02886             <span class="keywordtype">int</span> response = wxMessageBox(<span class="stringliteral">"Do you want to close all files from this project?"</span>, 
02887                 <span class="stringliteral">"Close Project"</span>, allowedResponse | wxCENTER | wxICON_QUESTION);
02888 
02889             <span class="keywordflow">if</span>(response == wxYES)
02890             {
02891                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (<span class="keywordtype">int</span>)edList.GetCount(); i++)
02892                 {
02893                     <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* ed = edList[i];
02894                     <span class="keywordtype">int</span> tabnum = <a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;<a class="code" href="class_chameleon_notebook.html#a2">FindPagePosition</a>(ed);
02895                     <a class="code" href="class_chameleon_window.html#d25">CloseFile</a>(tabnum);
02896                 }
02897             }
02898             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(response == wxNO)
02899             {
02900                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (<span class="keywordtype">int</span>)edList.GetCount(); i++)
02901                 {
02902                     <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* ed = edList[i];
02903                     <a class="code" href="class_project_info.html">ProjectInfo</a>* proj = <span class="keyword">new</span> <a class="code" href="class_project_info.html">ProjectInfo</a>();
02904                     proj-&gt;<a class="code" href="class_project_info.html#a25">SetRemote</a>(ed-&gt;<a class="code" href="class_chameleon_editor.html#a26">LastSavedRemotely</a>());
02905                     ed-&gt;<a class="code" href="class_chameleon_editor.html#a24">SetProject</a>(proj);
02906                 }
02907             }
02908             <span class="keywordflow">else</span>
02909             {
02910                 <span class="keywordflow">return</span>;
02911             }
02912         }
02913     }
02914 
02915     <a class="code" href="class_chameleon_window.html#d34">SaveProjectFile</a>();
02916     
02917     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;DeleteChildren(<a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[0]);
02918     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;DeleteChildren(<a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[1]);
02919     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;DeleteChildren(<a class="code" href="class_chameleon_window.html#r21">m_projectFileFolders</a>[2]);
02920 
02921     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;SetItemText(<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetRootItem(), <span class="stringliteral">"No project"</span>);
02922 
02923     <span class="keyword">delete</span> <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>;
02924     <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
02925 }
02926 
<a name="l02935"></a><a class="code" href="class_chameleon_window.html#d34">02935</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d34">ChameleonWindow::SaveProjectFile</a>()
02936 {
02937     wxPathFormat currentPathFormat = (<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a13">IsRemote</a>() ? wxPATH_UNIX : wxPATH_DOS);
02938     wxMemoryInputStream mis(<span class="stringliteral">""</span>, 0);
02939     wxFileConfig config(mis);
02940 
02941     config.SetPath(<span class="stringliteral">"/Headers"</span>);
02942     wxArrayString headers = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a9">GetHeaders</a>();
02943     <span class="keywordflow">for</span>(size_t i = 0; i &lt; headers.Count(); i++)
02944     {
02945         wxString headerName;
02946         headerName &lt;&lt; (i + 1);
02947         wxFileName relativeName(headers[i]);
02948         config.Write(headerName, relativeName.GetFullPath(currentPathFormat));
02949     }
02950 
02951     config.SetPath(<span class="stringliteral">"/Sources"</span>);
02952     wxArrayString sources = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a10">GetSources</a>();
02953     <span class="keywordflow">for</span>(size_t i = 0; i &lt; sources.Count(); i++)
02954     {
02955         wxString sourceName;
02956         sourceName &lt;&lt; (i + 1);
02957         wxFileName relativeName(sources[i]);
02958         config.Write(sourceName, relativeName.GetFullPath(currentPathFormat));
02959     }
02960 
02961     config.SetPath(<span class="stringliteral">"/Libraries"</span>);
02962     wxArrayString libraries = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a11">GetLibraries</a>();
02963     <span class="keywordflow">for</span>(size_t i = 0; i &lt; libraries.Count(); i++)
02964     {
02965         wxString libraryName;
02966         libraryName &lt;&lt; (i + 1);
02967         wxFileName relativeName(libraries[i]);
02968         config.Write(libraryName, relativeName.GetFullPath(currentPathFormat));
02969     }
02970 
02971     wxMemoryOutputStream outputStream;
02972     config.FlushToStream(outputStream);
02973 
02974     wxString resultContents;
02975     size_t streamsize = outputStream.GetSize();
02976 
02977     <span class="keywordflow">if</span>(streamsize == 0)
02978     {
02979         resultContents = <span class="stringliteral">"[Headers]\n\n[Sources]\n\n[Libraries]\n"</span>;
02980     }
02981     <span class="keywordflow">else</span>
02982     {
02983         <span class="keywordtype">char</span>* bufptr = resultContents.GetWriteBuf(streamsize);
02984         outputStream.CopyTo(bufptr,streamsize);
02985         resultContents.UngetWriteBuf();
02986     }
02987 
02988     wxString projBasePath = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a21">GetProjectBasePath</a>();
02989     wxString projName = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a20">GetProjectFile</a>().GetFullName();
02990     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a13">IsRemote</a>())
02991     {
02992         wxFileName fn(projBasePath, projName);
02993         m_network-&gt;<a class="code" href="class_networking.html#a8">SendFileContents</a>(resultContents, fn);
02994     }
02995     <span class="keywordflow">else</span>
02996     {
02997         wxString filename = projBasePath + <span class="stringliteral">"\\"</span> + projName;
02998         wxFile projectFile(filename, wxFile::write);
02999         projectFile.Write(resultContents);
03000         projectFile.Close();        
03001     }
03002 }
03003 
<a name="l03018"></a><a class="code" href="class_chameleon_window.html#d36">03018</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d36">ChameleonWindow::LoadFilesIntoProjectTree</a>(wxString configPath,  FileFilterType fileType, wxTreeItemId treeid, 
03019                                            wxFileConfig&amp; config, wxPathFormat currentPathFormat)
03020 {
03021     config.SetPath(configPath);
03022 
03023     <span class="keywordtype">int</span> numEntries = config.GetNumberOfEntries();
03024 
03025     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt;= numEntries; i++)
03026     {
03027         wxString keyname;
03028         keyname &lt;&lt; i;
03029         wxString fileName = config.Read(keyname);       
03030 
03031         <span class="keywordflow">if</span>(fileName != wxEmptyString)
03032         {
03033             wxFileName newFileName(fileName);
03034             <span class="keywordtype">int</span> iconNum = <a class="code" href="class_chameleon_window.html#r19">m_extensionMappings</a>[newFileName.GetExt()];
03035 
03036             <a class="code" href="class_file_name_tree_data.html">FileNameTreeData</a>* data = <span class="keyword">new</span> <a class="code" href="class_file_name_tree_data.html">FileNameTreeData</a>();
03037             data-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a> = newFileName.GetFullPath(currentPathFormat);
03038 
03039             <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;AppendItem(treeid, newFileName.GetFullName(), iconNum, -1, data);
03040 
03041             <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a2">AddFileToProject</a>(data-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a>, fileType);
03042 
03043             <span class="keywordtype">int</span> pageNum = <a class="code" href="class_chameleon_window.html#d29">GetPageNum</a>(newFileName);
03044 
03045             <span class="keywordflow">if</span>(pageNum != -1)
03046             {
03047                 <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* edit = static_cast&lt;ChameleonEditor*&gt; (<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage(pageNum));
03048                 edit-&gt;<a class="code" href="class_chameleon_editor.html#a24">SetProject</a>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>);
03049             }
03050         }
03051     }
03052 
03053     <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;SortChildren(treeid);
03054 }
03055 
<a name="l03064"></a><a class="code" href="class_chameleon_window.html#d33">03064</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d33">ChameleonWindow::RemoveFileFromProject</a>()
03065 {
03066     <a class="code" href="class_file_name_tree_data.html">FileNameTreeData</a>* treeData = static_cast&lt;FileNameTreeData*&gt; (<a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;GetItemData(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a>));
03067 
03068     <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a1">FileExistsInProject</a>(treeData-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a>))
03069     {
03070         <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a3">RemoveFileFromProject</a>(treeData-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a>, <a class="code" href="class_chameleon_window.html#r23">m_projectSelectedFolderType</a>);
03071 
03072         wxFileName fn(treeData-&gt;<a class="code" href="class_file_name_tree_data.html#o0">filename</a>);
03073         <span class="keywordtype">int</span> pageNum = <a class="code" href="class_chameleon_window.html#d29">GetPageNum</a>(fn);
03074 
03075         <span class="keywordflow">if</span>(pageNum != -1)
03076         {
03077             <a class="code" href="class_chameleon_editor.html">ChameleonEditor</a>* pEdit = static_cast &lt;ChameleonEditor* &gt;(<a class="code" href="class_chameleon_window.html#r1">m_book</a>-&gt;GetPage(pageNum));
03078             <a class="code" href="class_project_info.html">ProjectInfo</a>* proj = <span class="keyword">new</span> <a class="code" href="class_project_info.html">ProjectInfo</a>();
03079             pEdit-&gt;<a class="code" href="class_chameleon_editor.html#a24">SetProject</a>(proj);
03080         }
03081 
03082         <a class="code" href="class_chameleon_window.html#r4">m_projectTree</a>-&gt;Delete(<a class="code" href="class_chameleon_window.html#r22">m_clickedTreeItem</a>);
03083 
03084         <a class="code" href="class_chameleon_window.html#d34">SaveProjectFile</a>();
03085     }
03086 }
03087 
03088 <span class="comment">// Other major functions</span>
03089 
<a name="l03101"></a><a class="code" href="class_chameleon_window.html#a9">03101</a> <a class="code" href="datastructures_8h.html#a155">NetworkCallResult</a> <a class="code" href="class_chameleon_window.html#a9">ChameleonWindow::CheckNetworkStatus</a>()
03102 {
03103     <a class="code" href="datastructures_8h.html#a154">NetworkStatus</a> result = m_network-&gt;<a class="code" href="class_networking.html#a2">GetStatus</a>();
03104 
03105     <span class="keywordflow">switch</span>((<span class="keywordtype">int</span>)result)
03106     {
03107     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a154a122">NET_UNKNOWN_HOST</a>:
03108         {           
03109             wxString hostname = m_options-&gt;<a class="code" href="class_options.html#a17">GetHostname</a>();
03110             wxString fingerprint = m_network-&gt;<a class="code" href="class_networking.html#a3">GetStatusDetails</a>();
03111 
03112             wxString message = <span class="stringliteral">"The SSH fingerprint for the server "</span> + hostname + <span class="stringliteral">" was not recognized."</span>;
03113             message += <span class="stringliteral">"\nThe fingerprint was "</span> + fingerprint + <span class="stringliteral">".  \nDo you want to cache it?"</span>;
03114             <span class="keywordtype">int</span> result = wxMessageBox(message, <span class="stringliteral">"Unknown SSH Fingerprint"</span>, wxYES_NO | wxICON_QUESTION);
03115 
03116             <span class="keywordflow">if</span>(result == wxYES)
03117             {
03118                 m_network-&gt;<a class="code" href="class_networking.html#a4">SSHCacheFingerprint</a>();
03119             }
03120             <span class="keywordflow">return</span> <a class="code" href="datastructures_8h.html#a155a128">NETCALL_REDO</a>;
03121             <span class="keywordflow">break</span>;
03122         }
03123     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a154a125">NET_ERROR_MESSAGE</a>:
03124         {       
03125             wxString message = <span class="stringliteral">"An unknown network error has occurred."</span>;
03126             wxString statusDetails = m_network-&gt;<a class="code" href="class_networking.html#a3">GetStatusDetails</a>();;
03127             message += <span class="stringliteral">"\nError details: "</span> + statusDetails;
03128             wxLogDebug(<span class="stringliteral">"NET_ERROR_MESSAGE: %s"</span>, statusDetails);
03129             wxMessageBox(message, <span class="stringliteral">"Unknown network error"</span>, wxOK | wxICON_EXCLAMATION);
03130             <span class="keywordflow">return</span> <a class="code" href="datastructures_8h.html#a155a127">NETCALL_FAILED</a>;
03131             <span class="keywordflow">break</span>;
03132         }
03133     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a154a124">NET_AUTH_FAILED</a>:
03134         {
03135             <span class="keywordflow">if</span>(m_options-&gt;<a class="code" href="class_options.html#a18">GetPassphrase</a>() == <span class="stringliteral">""</span> &amp;&amp;
03136                 m_options-&gt;<a class="code" href="class_options.html#a17">GetHostname</a>() != <span class="stringliteral">"127.0.0.1"</span> &amp;&amp;
03137                 m_options-&gt;<a class="code" href="class_options.html#a16">GetUsername</a>() != <span class="stringliteral">"username"</span>) 
03138             {
03139                 wxTextEntryDialog getPW(<span class="keyword">this</span>, <span class="stringliteral">"Please enter your password and try again."</span>, <span class="stringliteral">"Missing Password"</span>, <span class="stringliteral">""</span>, wxTE_PASSWORD | wxOK | wxCANCEL);
03140                 <span class="keywordtype">int</span> oked = getPW.ShowModal();
03141                 <span class="keywordflow">if</span>(oked == wxID_OK) 
03142                 {
03143                     m_options-&gt;<a class="code" href="class_options.html#a7">SetPassphrase</a>(getPW.GetValue());
03144                     <span class="keywordflow">return</span> <a class="code" href="datastructures_8h.html#a155a127">NETCALL_FAILED</a>;
03145                     <span class="keywordflow">break</span>;
03146                 }
03147             }
03148             wxString message = <span class="stringliteral">"Chameleon was unable to log you in using the current username and password."</span>;
03149             message += <span class="stringliteral">"\nPlease check them in the Options menu and try again."</span>;
03150             wxMessageBox(message, <span class="stringliteral">"Login failed"</span>, wxOK | wxICON_EXCLAMATION);
03151             <span class="keywordflow">return</span> <a class="code" href="datastructures_8h.html#a155a127">NETCALL_FAILED</a>;
03152             <span class="keywordflow">break</span>;
03153         }
03154     <span class="keywordflow">case</span> <a class="code" href="datastructures_8h.html#a154a123">NET_CONN_REFUSED</a>:
03155         {
03156             wxString message = <span class="stringliteral">"Connection to the remote server was refused."</span>;
03157             message += <span class="stringliteral">"\nPlease check the remote hostname in the Options menu and try again."</span>;
03158             wxMessageBox(message, <span class="stringliteral">"Connection Refused"</span>, wxOK | wxICON_EXCLAMATION);
03159             <span class="keywordflow">return</span> <a class="code" href="datastructures_8h.html#a155a127">NETCALL_FAILED</a>;
03160             <span class="keywordflow">break</span>;
03161         }
03162     <span class="keywordflow">default</span>:
03163         <span class="keywordflow">return</span> <a class="code" href="datastructures_8h.html#a155a126">NETCALL_WORKED</a>;
03164         <span class="keywordflow">break</span>;
03165     }
03166 }
03167 
<a name="l03176"></a><a class="code" href="class_chameleon_window.html#d37">03176</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d37">ChameleonWindow::Compile</a>()
03177 {
03178     <span class="keywordtype">bool</span> doCompile = <span class="keyword">true</span>;
03179 
03180     <span class="keywordflow">if</span>(!<a class="code" href="class_chameleon_window.html#r39">m_compileProject</a>)
03181     {
03182         <span class="keywordflow">if</span>(!<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a8">HasBeenSaved</a>())
03183         {
03184             wxMessageBox(<span class="stringliteral">"Please save this file before trying to compile it."</span>, 
03185                 <span class="stringliteral">"Unsaved File"</span>, wxOK | wxICON_INFORMATION);
03186 
03187             doCompile = <span class="keyword">false</span>;
03188         }
03189         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a6">Modified</a>())
03190         {
03191             <span class="comment">// yes, same message... this can later be changed to ask about </span>
03192             <span class="comment">// saving, then do the appropriate thing.</span>
03193             wxMessageBox(<span class="stringliteral">"Please save this file before trying to compile it."</span>, <span class="stringliteral">"Unsaved File"</span>,
03194                 wxOK | wxICON_INFORMATION);
03195 
03196             doCompile = <span class="keyword">false</span>;
03197         }
03198     }   
03199 
03200     <span class="keywordflow">if</span>(doCompile)
03201     {       
03202         <a class="code" href="class_project_info.html">ProjectInfo</a>* projToCompile;
03203         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r39">m_compileProject</a>)
03204         {
03205             projToCompile = <a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>;
03206         }
03207         <span class="keywordflow">else</span>
03208         {
03209             projToCompile = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a20">GetProject</a>();
03210         }
03211 
03212         <span class="keywordflow">if</span>(!projToCompile-&gt;<a class="code" href="class_project_info.html#a13">IsRemote</a>())
03213         {
03214             wxMessageBox(<span class="stringliteral">"Local compiling has not been implemented.\nPlease save this file to a network server\nand try again"</span>,
03215                         <span class="stringliteral">"Can't Compile Locally"</span>, wxOK | wxICON_WARNING);
03216             <span class="keywordflow">return</span>;
03217         }
03218         <a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>-&gt;<a class="code" href="class_compiler_output_panel.html#a7">ClearOutput</a>();
03219 
03220         <a class="code" href="class_chameleon_window.html#r25">m_compiler</a>-&gt;<a class="code" href="class_compiler.html#a2">CompileProject</a>(projToCompile, <a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>);
03221 
03222         <span class="keywordtype">int</span> outputIndex = <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;<a class="code" href="class_chameleon_notebook.html#a2">FindPagePosition</a>(<a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>);
03223         <a class="code" href="class_chameleon_window.html#r2">m_noteTerm</a>-&gt;SetSelection(outputIndex);      
03224         <a class="code" href="class_chameleon_window.html#r8">m_outputPanel</a>-&gt;<a class="code" href="class_compiler_output_panel.html#a4">SetFocus</a>();
03225     }
03226 }
03227 
<a name="l03244"></a><a class="code" href="class_chameleon_window.html#a8">03244</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#a8">ChameleonWindow::FocusOnLine</a>(wxString filename, <span class="keywordtype">int</span> linenumber, <span class="keywordtype">bool</span> showMarker, wxString linecontents <span class="comment">/* = wxEmptyString */</span>)
03245 {
03246     wxFileName fn(filename);
03247 
03248     <span class="keywordtype">int</span> tabNum = <a class="code" href="class_chameleon_window.html#d29">GetPageNum</a>(fn, <span class="keyword">false</span>);
03249 
03250     <span class="keywordflow">if</span>(tabNum == -1)
03251     {
03252         <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a> != <a class="code" href="_crc16_8h.html#a0">NULL</a>)
03253         {
03254             <span class="keywordflow">if</span>(<a class="code" href="class_chameleon_window.html#r27">m_projMultiFiles</a>-&gt;<a class="code" href="class_project_info.html#a1">FileExistsInProject</a>(filename))
03255             {
03256                 wxArrayString filesToOpen;
03257                 filesToOpen.Add(filename);
03258                 <a class="code" href="class_chameleon_window.html#a10">OpenSourceFile</a>(filesToOpen);
03259                 tabNum = <a class="code" href="class_chameleon_window.html#d29">GetPageNum</a>(fn, <span class="keyword">false</span>);
03260             }
03261         }
03262     }
03263 
03264     <span class="keywordflow">if</span>(tabNum != -1)
03265     {
03266         <a class="code" href="class_chameleon_window.html#d28">PageHasChanged</a>(tabNum);
03267 
03268         <span class="comment">// Adjust for Scintilla's zero-based line numbers</span>
03269         <span class="keywordtype">int</span> adjustedLineNum = linenumber - 1;
03270 
03271         <span class="keywordflow">if</span>(linecontents != wxEmptyString)
03272         {
03273             wxString edLineContents = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetLine(adjustedLineNum);
03274         }
03275 
03276         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;<a class="code" href="class_chameleon_editor.html#a13">FocusOnLine</a>(adjustedLineNum, showMarker);
03277     }
03278 }
03279 
03280 <span class="comment">// Find/replace code begins here</span>
03281 
<a name="l03292"></a><a class="code" href="class_chameleon_window.html#d20">03292</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d20">ChameleonWindow::OnFindEvent</a>(wxFindDialogEvent&amp; event)
03293 {
03294     wxEventType type = event.GetEventType();
03295     wxString findString = event.GetFindString();
03296     <span class="keywordtype">long</span> flags = event.GetFlags();
03297     <span class="keywordtype">int</span> pos = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetCurrentPos();
03298 
03299     <span class="keywordflow">if</span> ((type == wxEVT_COMMAND_FIND) || 
03300         (type == wxEVT_COMMAND_FIND_NEXT))
03301     {
03302         pos = <a class="code" href="class_chameleon_window.html#d40">FindString</a>(findString, pos, flags, TRUE);
03303 
03304         <span class="keywordflow">if</span> (pos &gt;= 0)
03305             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetFocus();
03306         <span class="keywordflow">else</span>
03307         {
03308             wxMessageBox(<span class="stringliteral">"No more occurrences of: \""</span> + findString + <span class="stringliteral">"\" in this file"</span>,
03309                 <span class="stringliteral">"Search Ended"</span>, wxOK | wxICON_EXCLAMATION, <span class="keyword">this</span>);           
03310         }
03311     }
03312     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == wxEVT_COMMAND_FIND_REPLACE)
03313     {
03314         <span class="keywordflow">if</span> (<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetSelectedText() != findString)
03315         {
03316             wxBell();
03317             <span class="keywordflow">return</span>;
03318         }
03319 
03320         <span class="keywordtype">int</span> pos = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetSelectionStart();
03321         wxString replaceString = event.GetReplaceString();
03322         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;ReplaceSelection(replaceString);
03323         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;EnsureCaretVisible();
03324         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetSelection(pos, pos + replaceString.Length());
03325 
03326         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetFocus();
03327 
03328         <span class="comment">// TODO Do a Find after this for the next item automatically?</span>
03329     }
03330     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == wxEVT_COMMAND_FIND_REPLACE_ALL)
03331     {
03332         wxString replaceString = event.GetReplaceString();
03333         <span class="keywordflow">if</span> (findString == replaceString)
03334             <span class="keywordflow">return</span>;
03335 
03336         wxBusyCursor busy;
03337         <span class="keywordtype">int</span> count = <a class="code" href="class_chameleon_window.html#d41">ReplaceAllStrings</a>(findString, replaceString, flags);
03338 
03339         wxMessageBox( wxString::Format(<span class="stringliteral">"Replaced %d occurrences of\n'%s' with '%s'."</span>, count, findString.c_str(), 
03340             replaceString.c_str()),     <span class="stringliteral">"Finished replacing"</span>, wxOK, <span class="keyword">this</span>);
03341     }
03342     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == wxEVT_COMMAND_FIND_CLOSE)
03343     {
03344         <span class="keywordflow">if</span> (wxDynamicCast(event.GetEventObject(), wxDialog))
03345         {
03346             ((wxDialog*)event.GetEventObject())-&gt;Destroy();
03347         }
03348         <a class="code" href="class_chameleon_window.html#r16">m_findReplace</a> = <a class="code" href="_crc16_8h.html#a0">NULL</a>;
03349     }
03350 }
03351 
<a name="l03365"></a><a class="code" href="class_chameleon_window.html#d40">03365</a> <span class="keywordtype">int</span> <a class="code" href="class_chameleon_window.html#d40">ChameleonWindow::FindString</a>(<span class="keyword">const</span> wxString &amp;findString, <span class="keywordtype">int</span> start_pos, <span class="keywordtype">int</span> flags, <span class="keywordtype">bool</span> highlight)
03366 {
03367     <span class="keywordflow">if</span> (findString.IsEmpty())
03368         <span class="keywordflow">return</span> wxNOT_FOUND;
03369 
03370     <span class="keywordtype">int</span> stc_flags = 0;
03371     <span class="keywordflow">if</span> ((flags &amp; wxFR_MATCHCASE) != 0) 
03372     {
03373         stc_flags |= wxSTC_FIND_MATCHCASE;
03374     }
03375     <span class="keywordflow">if</span> ((flags &amp; wxFR_WHOLEWORD) != 0)
03376     {
03377         stc_flags |= wxSTC_FIND_WHOLEWORD;
03378     }
03379 
03380     <span class="keywordtype">int</span> pos = start_pos == -1 ? <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetCurrentPos() : start_pos;
03381 
03382     <span class="keywordflow">if</span> ((flags &amp; wxFR_DOWN) != 0)
03383     {
03384         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetTargetStart(wxMax(0, pos));
03385         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetTargetEnd(wxMax(0, <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetTextLength()));
03386     }
03387     <span class="keywordflow">else</span>
03388     {
03389         <span class="keywordflow">if</span> (labs(<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetTargetEnd() - <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetTargetStart()) == long(findString.Length()))
03390         {
03391             pos -= findString.Length() + 1; <span class="comment">// doesn't matter if it matches or not, skip it</span>
03392         }
03393 
03394         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetTargetStart(wxMax(0, pos));
03395         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetTargetEnd(0); 
03396     }
03397 
03398     <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetSearchFlags(stc_flags);
03399     pos = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SearchInTarget(findString);
03400 
03401     <span class="keywordflow">if</span> (pos &gt;= 0)
03402     {
03403         <span class="keywordflow">if</span> (highlight)
03404         {
03405             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;EnsureCaretVisible();
03406             <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;SetSelection(pos, pos + findString.Length());
03407         }
03408     }
03409 
03410     <span class="keywordflow">return</span> pos;
03411 }
03412 
<a name="l03425"></a><a class="code" href="class_chameleon_window.html#d41">03425</a> <span class="keywordtype">int</span> <a class="code" href="class_chameleon_window.html#d41">ChameleonWindow::ReplaceAllStrings</a>(<span class="keyword">const</span> wxString &amp;findString, <span class="keyword">const</span> wxString &amp;replaceString, <span class="keywordtype">int</span> flags)
03426 {    
03427     <span class="keywordtype">int</span> count = 0;
03428 
03429     <span class="keywordflow">if</span> (findString.IsEmpty() || (findString == replaceString))
03430         <span class="keywordflow">return</span> count;
03431 
03432     <span class="keywordtype">int</span> cursor_pos = <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetCurrentPos();  <span class="comment">// return here when done</span>
03433 
03434     <span class="keywordflow">if</span> (<a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetSelectedText() == findString)
03435     {
03436         ++count;
03437         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;ReplaceSelection(replaceString);
03438     }
03439 
03440     <span class="keywordtype">int</span> pos = <a class="code" href="class_chameleon_window.html#d40">FindString</a>(findString, -1, flags, TRUE);
03441 
03442     <span class="keywordflow">while</span> (pos != -1)
03443     {
03444         ++count;
03445         <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;ReplaceSelection(replaceString);
03446         pos = <a class="code" href="class_chameleon_window.html#d40">FindString</a>(findString, -1, flags, TRUE);
03447     }
03448 
03449     <span class="comment">// return to starting pos or as close as possible</span>
03450     <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GotoPos(wxMin(cursor_pos, <a class="code" href="class_chameleon_window.html#r3">m_currentEd</a>-&gt;GetLength()));
03451 
03452     <span class="keywordflow">return</span> count;
03453 }
03454 
03455 <span class="comment">// Various utility functions and random other stuff</span>
03456 
<a name="l03465"></a><a class="code" href="class_chameleon_window.html#d38">03465</a> wxRect <a class="code" href="class_chameleon_window.html#d38">ChameleonWindow::DeterminePrintSize</a> () 
03466 {
03467     wxSize scr = wxGetDisplaySize();
03468 
03469     <span class="comment">// determine position and size (shifting 16 left and down)</span>
03470     wxRect rect = GetRect();
03471     rect.x += 16;
03472     rect.y += 16;
03473     rect.width = wxMin (rect.width, (scr.x - rect.x));
03474     rect.height = wxMin (rect.height, (scr.x - rect.y));
03475 
03476     <span class="keywordflow">return</span> rect;
03477 }
03478 
<a name="l03489"></a><a class="code" href="class_chameleon_window.html#d14">03489</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d14">ChameleonWindow::OnSplitterDoubleClick</a>(wxSplitterEvent &amp;event)
03490 {
03491     event.Veto();
03492 }
03493 
<a name="l03504"></a><a class="code" href="class_chameleon_window.html#d16">03504</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d16">ChameleonWindow::OnSize</a>(wxSizeEvent &amp;event)
03505 {
03506     event.Skip();   
03507 }
03508 
<a name="l03509"></a><a class="code" href="class_chameleon_window.html#d15">03509</a> <span class="keywordtype">void</span> <a class="code" href="class_chameleon_window.html#d15">ChameleonWindow::OnTermResize</a>(wxSplitterEvent &amp;event)
03510 {
03511 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 28 16:45:38 2004 for Chameleon by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
