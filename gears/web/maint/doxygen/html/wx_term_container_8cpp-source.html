<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Chameleon: wxTermContainer.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>wxTermContainer.cpp</h1><a href="wx_term_container_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 <span class="comment">// Name:        wxTermContainer.cpp</span>
00003 <span class="comment">// Purpose:     </span>
00004 <span class="comment">// Author:      </span>
00005 <span class="comment">// Modified by: </span>
00006 <span class="comment">// Created:     03/18/04 01:08:08</span>
00007 <span class="comment">// RCS-ID:      </span>
00008 <span class="comment">// Copyright:   </span>
00009 <span class="comment">// Licence:     </span>
00011 <span class="comment"></span>
00012 <span class="preprocessor">#ifdef __GNUG__</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#pragma implementation "wxTermContainer.cpp"</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00015 <span class="preprocessor"></span>
00016 <span class="comment">// For compilers that support precompilation, includes "wx/wx.h".</span>
00017 <span class="preprocessor">#include "wx/wxprec.h"</span>
00018 
00019 <span class="preprocessor">#ifdef __BORLANDC__</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#pragma hdrstop</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00022 <span class="preprocessor"></span>
00024 <span class="preprocessor">#include "wx/wx.h"</span>
00025 <span class="preprocessor">#include "wx/scrolbar.h"</span>
00027 
00028 <span class="preprocessor">#include "<a class="code" href="wx_term_container_8h.html">wxTermContainer.h</a>"</span>
00029 <span class="preprocessor">#include "../wxTerm.h"</span>
00030 
00031 <span class="preprocessor">#include "../../common/debug.h"</span>
00032 
00033 <span class="preprocessor">#ifdef _DEBUG</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#define new DEBUG_NEW</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00036 <span class="preprocessor"></span>
00038 
00040 
00045 IMPLEMENT_CLASS( <a class="code" href="classwx_term_container.html">wxTermContainer</a>, wxPanel )
00046 
00047 
00051 BEGIN_EVENT_TABLE( <a class="code" href="classwx_term_container.html">wxTermContainer</a>, wxPanel )
00052 
00053 
00054     EVT_COMMAND_SCROLL_LINEUP( ID_SCROLLBAR, wxTermContainer::OnScrollbarScrollLineUp )
00055     EVT_COMMAND_SCROLL_LINEDOWN( ID_SCROLLBAR, wxTermContainer::OnScrollbarScrollLineDown )
00056     EVT_COMMAND_SCROLL_PAGEUP( ID_SCROLLBAR, wxTermContainer::OnScrollbarScrollPageUp )
00057     EVT_COMMAND_SCROLL_PAGEDOWN( ID_SCROLLBAR, wxTermContainer::OnScrollbarScrollPageDown )
00058     EVT_COMMAND_SCROLL_THUMBTRACK( ID_SCROLLBAR, wxTermContainer::OnScrollbarScrollThumbtrack )
00059 
00060 
00061 
00062   EVT_SIZE                      (wxTermContainer::OnSize)
00063   EVT_UPDATE_UI                 (ID_SCROLLBAR, wxTermContainer::OnUpdateUI)
00064 
00065 END_EVENT_TABLE()
00066 
00067 
<a name="l00071"></a><a class="code" href="classwx_term_container.html#a0">00071</a> <a class="code" href="classwx_term_container.html#a0">wxTermContainer::wxTermContainer</a>( )
00072 {
00073 }
00074 
<a name="l00075"></a><a class="code" href="classwx_term_container.html#a1">00075</a> <a class="code" href="classwx_term_container.html#a0">wxTermContainer::wxTermContainer</a>( wxWindow* parent, wxWindowID <span class="keywordtype">id</span>, <span class="keyword">const</span> wxPoint&amp; pos, <span class="keyword">const</span> wxSize&amp; size, <span class="keywordtype">long</span> style )
00076 : m_terminal(<a class="code" href="_crc16_8h.html#a0">NULL</a>)
00077 {
00078     <a class="code" href="classwx_term_container.html#a2">Create</a>(parent, <span class="keywordtype">id</span>, pos, size, style);
00079 
00080     <a class="code" href="classwx_term_container.html#r4">m_lastLinesReceived</a> = 0;
00081     <a class="code" href="classwx_term_container.html#r2">m_lastThumbPosition</a> = 0;
00082     
00083 }
00084 
<a name="l00089"></a><a class="code" href="classwx_term_container.html#a2">00089</a> <span class="keywordtype">bool</span> <a class="code" href="classwx_term_container.html#a2">wxTermContainer::Create</a>( wxWindow* parent, wxWindowID <span class="keywordtype">id</span>, <span class="keyword">const</span> wxPoint&amp; pos, <span class="keyword">const</span> wxSize&amp; size, <span class="keywordtype">long</span> style )
00090 {
00093 
00094 
00096     wxPanel::Create( parent, <span class="keywordtype">id</span>, pos, size, style );
00097 
00098     <a class="code" href="classwx_term_container.html#a3">CreateControls</a>();
00099     Centre();
00101     <span class="keywordflow">return</span> TRUE;
00102 }
00103 
<a name="l00108"></a><a class="code" href="classwx_term_container.html#a3">00108</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a3">wxTermContainer::CreateControls</a>()
00109 {    
00111 
00112     <a class="code" href="classwx_term_container.html">wxTermContainer</a>* item1 = <span class="keyword">this</span>;
00113 
00114     wxBoxSizer* item2 = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
00115     m_sizer = item2;
00116     item1-&gt;SetSizer(item2);
00117     item1-&gt;SetAutoLayout(TRUE);
00118 
00119     <span class="comment">/*</span>
00120 <span class="comment">    wxTerm* item3 = new wxTerm( item1, ID_PANEL, wxDefaultPosition, wxSize(379, 80), wxNO_BORDER|wxTAB_TRAVERSAL );</span>
00121 <span class="comment">    m_terminal = item3;</span>
00122 <span class="comment">    item2-&gt;Add(item3, 1, wxGROW, 5);</span>
00123 <span class="comment">    */</span>
00124 
00125     <span class="comment">//item2-&gt;Add(m_terminal, 1, wxGROW, 0);</span>
00126 
00127     wxScrollBar* item4 = <span class="keyword">new</span> wxScrollBar( item1, <a class="code" href="wx_term_container_8h.html#a1">ID_SCROLLBAR</a>, wxPoint(this-&gt;GetSize().GetX() - 18, 0), wxSize(18, -1), wxSB_VERTICAL );
00128     <a class="code" href="classwx_term_container.html#r1">m_scrollbar</a> = item4;
00129     item4-&gt;SetScrollbar(90, 10, 100, 10);
00130     item2-&gt;Add(item4, 0, wxGROW, 5);
00131 
00133 }
00134 
00139 
00140 
00141 
00142 
00143 
00144 
00145 
00146 
00147 
00148 
<a name="l00149"></a><a class="code" href="classwx_term_container.html#a5">00149</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a5">wxTermContainer::OnScrollbarScrollLineUp</a>( wxScrollEvent&amp; event )
00150 {
00151     <span class="comment">// Insert custom code here</span>
00152     event.Skip();
00153 
00154     <span class="comment">//wxLogDebug("OnScrollbarScrollPageUp()");</span>
00155     m_terminal-&gt;<a class="code" href="classwx_term.html#a13">ScrollTerminal</a>(1, <span class="keyword">true</span>);
00156 }
00157 
00162 
00163 
00164 
00165 
00166 
00167 
00168 
00169 
00170 
00171 
<a name="l00172"></a><a class="code" href="classwx_term_container.html#a6">00172</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a6">wxTermContainer::OnScrollbarScrollLineDown</a>( wxScrollEvent&amp; event )
00173 {
00174     <span class="comment">// Insert custom code here</span>
00175     event.Skip();
00176     m_terminal-&gt;<a class="code" href="classwx_term.html#a13">ScrollTerminal</a>(1, <span class="keyword">false</span>);
00177 
00178 }
00179 
00184 
00185 
00186 
00187 
00188 
00189 
00190 
00191 
00192 
00193 
<a name="l00194"></a><a class="code" href="classwx_term_container.html#a7">00194</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a7">wxTermContainer::OnScrollbarScrollPageUp</a>( wxScrollEvent&amp; event )
00195 {
00196     <span class="comment">// Insert custom code here</span>
00197     event.Skip();
00198     m_terminal-&gt;<a class="code" href="classwx_term.html#a13">ScrollTerminal</a>(10, <span class="keyword">true</span>);
00199 
00200 }
00201 
00206 
00207 
00208 
00209 
00210 
00211 
00212 
00213 
00214 
00215 
<a name="l00216"></a><a class="code" href="classwx_term_container.html#a8">00216</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a8">wxTermContainer::OnScrollbarScrollPageDown</a>( wxScrollEvent&amp; event )
00217 {
00218     <span class="comment">// Insert custom code here</span>
00219     event.Skip();
00220     m_terminal-&gt;<a class="code" href="classwx_term.html#a13">ScrollTerminal</a>(10, <span class="keyword">false</span>);
00221 }
00222 
00227 
00228 
00229 
00230 
00231 
00232 
00233 
00234 
00235 
00236 
<a name="l00237"></a><a class="code" href="classwx_term_container.html#a9">00237</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a9">wxTermContainer::OnScrollbarScrollThumbtrack</a>( wxScrollEvent&amp; event )
00238 {
00239     <span class="comment">// Insert custom code here</span>
00240     event.Skip();
00241     <span class="comment">//wxLogDebug("Scroll event.  Value: %d", event.GetPosition());</span>
00242 
00243     <span class="keywordtype">int</span> newThumbPosition = event.GetPosition();
00244 
00245     <span class="keywordtype">int</span> linesToScroll;
00246     <span class="keywordtype">bool</span> scrollUp = (newThumbPosition &lt; <a class="code" href="classwx_term_container.html#r2">m_lastThumbPosition</a>);
00247 
00248     <span class="keywordflow">if</span>(scrollUp)
00249     {
00250         linesToScroll = <a class="code" href="classwx_term_container.html#r2">m_lastThumbPosition</a> - newThumbPosition;
00251     }
00252     <span class="keywordflow">else</span>
00253     {
00254         linesToScroll = newThumbPosition - <a class="code" href="classwx_term_container.html#r2">m_lastThumbPosition</a>;
00255     }
00256 
00257     <a class="code" href="classwx_term_container.html#r2">m_lastThumbPosition</a> = newThumbPosition;
00258 
00259     m_terminal-&gt;<a class="code" href="classwx_term.html#a13">ScrollTerminal</a>(linesToScroll, scrollUp);
00260 }
00261 
<a name="l00266"></a><a class="code" href="classwx_term_container.html#e0">00266</a> <span class="keywordtype">bool</span> <a class="code" href="classwx_term_container.html#e0">wxTermContainer::ShowToolTips</a>()
00267 {
00268   <span class="keywordflow">return</span> TRUE;
00269 }
00270 
<a name="l00281"></a><a class="code" href="classwx_term_container.html#a4">00281</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a4">wxTermContainer::SetTerminal</a>(<a class="code" href="classwx_term.html">wxTerm</a>* terminal)
00282 {
00283     
00284     m_terminal = terminal;
00285 
00286     m_sizer-&gt;Prepend(m_terminal, 1, wxGROW, 0);
00287 
00288     <span class="keywordtype">int</span> termHeight = m_terminal-&gt;<a class="code" href="class_g_term.html#a6">Height</a>();
00289     <a class="code" href="classwx_term_container.html#r1">m_scrollbar</a>-&gt;SetScrollbar(100 - termHeight, termHeight, 100, 10);
00290     
00291     <span class="comment">//m_scrollbar-&gt;SetScrollbar(90, 10, 100, 10);</span>
00292 }
00293 
<a name="l00294"></a><a class="code" href="classwx_term_container.html#a10">00294</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a10">wxTermContainer::OnSize</a>(wxSizeEvent &amp;event)
00295 {
00296     event.Skip();
00297     
00298     <span class="comment">/*</span>
00299 <span class="comment">    int newHeight = 0;</span>
00300 <span class="comment">    int numLinesReceived = 0;</span>
00301 <span class="comment"></span>
00302 <span class="comment">    if(m_terminal != NULL)</span>
00303 <span class="comment">    {</span>
00304 <span class="comment">        //m_terminal-&gt;UpdateSize(newHeight, numLinesReceived);</span>
00305 <span class="comment">        m_terminal-&gt;UpdateSize();</span>
00306 <span class="comment"></span>
00307 <span class="comment">        int height = m_terminal-&gt;Height();</span>
00308 <span class="comment"></span>
00309 <span class="comment">        int maxSize = m_terminal-&gt;MaxHeight();</span>
00310 <span class="comment">        int pageSize = maxSize / 10;</span>
00311 <span class="comment">        m_scrollbar-&gt;SetScrollbar(maxSize - height, height, maxSize, pageSize);</span>
00312 <span class="comment">    }</span>
00313 <span class="comment">    */</span>
00314 
00315     
00316 
00317 }
00318 
<a name="l00329"></a><a class="code" href="classwx_term_container.html#a11">00329</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a11">wxTermContainer::OnUpdateUI</a>(wxUpdateUIEvent &amp;event)
00330 {
00331     <span class="keywordtype">bool</span> enableScrollbar = <span class="keyword">true</span>;
00332 
00333     <span class="keywordtype">int</span> scrollHeight = m_terminal-&gt;<a class="code" href="class_g_term.html#a12">GetScrollHeight</a>();
00334 
00335     <span class="keywordtype">int</span> thumbSize = m_terminal-&gt;<a class="code" href="class_g_term.html#a6">Height</a>();
00336 
00337     <span class="keywordflow">if</span>(scrollHeight &lt;= thumbSize)
00338     {
00339         <a class="code" href="classwx_term_container.html#r1">m_scrollbar</a>-&gt;Disable();
00340         <span class="keywordflow">return</span>;
00341     }
00342     
00343     <a class="code" href="classwx_term_container.html#r1">m_scrollbar</a>-&gt;Enable();
00344     <span class="keywordtype">int</span> pageSize = scrollHeight / 10;
00345 
00346     <span class="keywordflow">if</span>(pageSize == 0)
00347     {
00348         pageSize = 10;
00349     }
00350     
00351 
00352     <span class="keywordtype">int</span> thumbPosition = scrollHeight - thumbSize - m_terminal-&gt;<a class="code" href="class_g_term.html#a13">GetScrollPosition</a>(); 
00353 
00354     <span class="keywordflow">if</span>(scrollHeight != <a class="code" href="classwx_term_container.html#r4">m_lastLinesReceived</a>)
00355     {
00356         <span class="comment">//wxLogDebug("linesReceived: %d, thumbSize: %d, thumbPosition: %d", scrollHeight, thumbSize, thumbPosition);</span>
00357         <a class="code" href="classwx_term_container.html#r4">m_lastLinesReceived</a> = scrollHeight;
00358         <a class="code" href="classwx_term_container.html#r2">m_lastThumbPosition</a> = thumbPosition;
00359     }
00360 
00361     <span class="keywordflow">if</span>(thumbPosition &lt; 0)
00362     {
00363         thumbPosition = 0;
00364     }
00365 
00366     event.Enable(<span class="keyword">true</span>);
00367     <a class="code" href="classwx_term_container.html#r1">m_scrollbar</a>-&gt;SetScrollbar(thumbPosition, thumbSize, scrollHeight, pageSize);    
00368 }
00369 
<a name="l00370"></a><a class="code" href="classwx_term_container.html#a12">00370</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term_container.html#a12">wxTermContainer::SetTerminalHistory</a>(<span class="keywordtype">int</span> newSize)
00371 {
00372     m_terminal-&gt;<a class="code" href="class_g_term.html#a17">SetTerminalHistory</a>(newSize);
00373     <span class="comment">//m_scrollbar-&gt;SetScrollbar(100 - termHeight, termHeight, 100, 10);</span>
00374 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 28 16:45:39 2004 for Chameleon by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
