<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Chameleon: cham_db.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>cham_db.h</h1><a href="cham__db_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*****************************************************************\</span>
00002 <span class="comment">*Wrapper Header file</span>
00003 <span class="comment">*</span>
00004 <span class="comment">*author: Ben Carhart</span>
00005 <span class="comment">*date started: 1/11/04</span>
00006 <span class="comment">*date finished:</span>
00007 <span class="comment">*</span>
00008 <span class="comment">*description: Code for the implementation of a wrapper for GDB</span>
00009 <span class="comment">*revisions:</span>
00010 <span class="comment">*</span>
00011 <span class="comment">\*****************************************************************/</span>
00012 
00013 <span class="preprocessor">#ifndef CHAMELEON_DEBUGER_H</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#define CHAMELEON_DEBUGER_H</span>
00015 <span class="preprocessor"></span>
00016 <span class="preprocessor">#include &lt;wx/string.h&gt;</span>
00017 <span class="comment">//#include &lt;wx/process.h&gt;</span>
00018 <span class="preprocessor">#include &lt;wx/dynarray.h&gt;</span>
00019 <span class="preprocessor">#include &lt;wx/event.h&gt;</span>
00020 <span class="preprocessor">#include &lt;wx/txtstrm.h&gt;</span>
00021 
00022 <span class="preprocessor">#include "../common/process2.h"</span>
00023 <span class="preprocessor">#include "../common/process2events.h"</span>
00024 
00025 <span class="comment">//global declarations</span>
<a name="l00026"></a><a class="code" href="cham__db_8h.html#a0">00026</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="cham__db_8h.html#a0">MAX_HIST_ITEMS</a> = 50;
<a name="l00027"></a><a class="code" href="cham__db_8h.html#a1">00027</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="cham__db_8h.html#a1">PROMPT_CHAR</a> = <span class="charliteral">'%'</span>;
00028 
00029 <span class="comment">//keywords for parsing output</span>
<a name="l00030"></a><a class="code" href="cham__db_8h.html#a28">00030</a> <span class="keyword">enum</span> <a class="code" href="cham__db_8h.html#a28">DEBUG_KEYS</a> {
00031     <a class="code" href="cham__db_8h.html#a28a2">START</a> = -1,             <span class="comment">//program start</span>
00032     <a class="code" href="cham__db_8h.html#a28a3">CONTINUE</a> = 134242,
00033     <a class="code" href="cham__db_8h.html#a28a4">E_BREAK</a>,                <span class="comment">//enable break</span>
00034     <a class="code" href="cham__db_8h.html#a28a5">D_BREAK</a>,                <span class="comment">//disable break</span>
00035     <a class="code" href="cham__db_8h.html#a28a6">K_BREAK</a>,                <span class="comment">//kill break</span>
00036     <a class="code" href="cham__db_8h.html#a28a7">S_BREAK</a>,                <span class="comment">//set break</span>
00037     <a class="code" href="cham__db_8h.html#a28a8">GO</a>,
00038     <a class="code" href="cham__db_8h.html#a28a9">JUMP</a>,
00039     <a class="code" href="cham__db_8h.html#a28a10">SOFT_RESET</a>,
00040     <a class="code" href="cham__db_8h.html#a28a11">HARD_RESET</a>,
00041     <a class="code" href="cham__db_8h.html#a28a12">NEW_FILE</a>,               <span class="comment">//new file to debug</span>
00042     <a class="code" href="cham__db_8h.html#a28a13">NEW_MODE</a>,               <span class="comment">//change in program mode</span>
00043     <a class="code" href="cham__db_8h.html#a28a14">NEW_PROC</a>,               <span class="comment">//change in process pointer</span>
00044     <a class="code" href="cham__db_8h.html#a28a15">VAR_ASSIGN</a>,
00045     <a class="code" href="cham__db_8h.html#a28a16">WATCH_VAR</a>,
00046     <a class="code" href="cham__db_8h.html#a28a17">STEP</a>,
00047     <a class="code" href="cham__db_8h.html#a28a18">STEP_OUT</a>,
00048     <a class="code" href="cham__db_8h.html#a28a19">STOP</a>,
00049     <a class="code" href="cham__db_8h.html#a28a20">WAITING</a>,
00050 };
00051 
00052 <span class="comment">//status of program</span>
<a name="l00053"></a><a class="code" href="cham__db_8h.html#a29">00053</a> <span class="keyword">enum</span> <a class="code" href="cham__db_8h.html#a29">DEBUG_STATUS</a> {
00054     <a class="code" href="cham__db_8h.html#a29a21">DEBUG_RUNNING</a> = 135401, <span class="comment">//program running / command executing</span>
00055     <a class="code" href="cham__db_8h.html#a29a22">DEBUG_STOPPED</a>,          <span class="comment">//nothing happening right now</span>
00056     <a class="code" href="cham__db_8h.html#a29a23">DEBUG_WAIT</a>,             <span class="comment">//waiting for instruction</span>
00057     <a class="code" href="cham__db_8h.html#a29a24">DEBUG_BREAK</a>,            <span class="comment">//program paused (because of breakpoint)</span>
00058     <a class="code" href="cham__db_8h.html#a29a25">DEBUG_ERROR</a>,            <span class="comment">//problem with debug</span>
00059     <a class="code" href="cham__db_8h.html#a29a26">DEBUG_NEED_FILE</a>,        <span class="comment">//waiting for a file</span>
00060     <a class="code" href="cham__db_8h.html#a29a27">DEBUG_DEAD</a>,             <span class="comment">//there AIN'T no debug!</span>
00061 };
00062 
<a name="l00063"></a><a class="code" href="class_debugger.html">00063</a> <span class="keyword">class </span><a class="code" href="class_debugger.html">Debugger</a> : <span class="keyword">public</span> wxEvtHandler
00064 {
00065     <span class="keyword">public</span>:
00066         <span class="comment">//defaults</span>
00067         <a class="code" href="class_debugger.html#a0">Debugger</a>(<span class="keywordtype">bool</span> mode, wxString fName, wxString execThis);
00068         <a class="code" href="class_debugger.html#a1">~Debugger</a>();                    <span class="comment">//destructor</span>
00069 
00070         <span class="comment">//status modifiers</span>
00071         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a2">setMode</a>(<span class="keywordtype">bool</span> mode);        <span class="comment">//switch between LOCAL and REMOTE mode</span>
00072         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a3">getMode</a>();                 <span class="comment">//get current mode</span>
00073         
00074         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a4">setFile</a>(wxString fName);   <span class="comment">//sets a file for debugging</span>
00075         wxString <a class="code" href="class_debugger.html#a5">getFile</a>();             <span class="comment">//returns current file up for debugging</span>
00076 
00077         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a6">genericStatus</a>();                <span class="comment">//returns current debug status</span>
00078         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a7">programStatus</a>();
00079         wxString <a class="code" href="class_debugger.html#a8">errorMsg</a>();            <span class="comment">//returns error message, if any</span>
00080         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a9">resetStatus</a>();             <span class="comment">//resets from error</span>
00081         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a10">clearError</a>();              <span class="comment">//just resets the status variable</span>
00082         
00083         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a11">setProcess</a>(wxString nExec);<span class="comment">//sets the current process pointer</span>
00084 
00085 
00086         <span class="comment">//breakpoint management</span>
00087         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a12">setBreak</a>(<span class="keywordtype">int</span> lineNum);     <span class="comment">//set breakpoint</span>
00088         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a13">disableBreak</a>(<span class="keywordtype">int</span> lineNum); <span class="comment">//disable breakpoint</span>
00089         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a14">enableBreak</a>(<span class="keywordtype">int</span> lineNum);  <span class="comment">//enable a breakpoint</span>
00090         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a15">killBreak</a>(<span class="keywordtype">int</span> lineNum);    <span class="comment">//delete breakpoint</span>
00091         <span class="comment">//int breakStat(int lineNum);   //hit stats on a breakpoint at line#[int]</span>
00092         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a16">numBreaks</a>();                <span class="comment">//return the # of breakpoints</span>
00093 
00094         <span class="comment">//step management</span>
00095         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a17">step</a>();
00096         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a18">stepOver</a>();                <span class="comment">//execute function lines (don't go into)</span>
00097         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a19">stepOut</a>();                 <span class="comment">//execute current stack frame to finish</span>
00098         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a20">jump</a>(<span class="keywordtype">int</span> lineNum);         <span class="comment">//go to line # and run</span>
00099         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a21">go</a>();                      <span class="comment">//run program</span>
00100         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a22">cont</a>();                    <span class="comment">//continue debugging</span>
00101         <span class="comment">//CODE IN A RUN-TO-CURSOR function</span>
00102 
00103         <span class="comment">/* \/ WHERE I AM \/ */</span>
00104         <span class="comment">//variable management</span>
00105         <span class="comment">//return /set value of a variable</span>
00106         wxString <a class="code" href="class_debugger.html#a23">snoopVar</a>(wxString varName);
00107         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a24">setVar</a>(wxString varName, wxString newValue);
00108 
00109         <span class="comment">//misc management</span>
00110         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a25">stop</a>(<span class="keywordtype">bool</span> pleaseRestart);  <span class="comment">//kills process &amp; reloads it (?)</span>
00111         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a26">getCurrLine</a>();              <span class="comment">//returns current line number on debug</span>
00112         <span class="comment">//use STEPI ^</span>
00113 
00114     <span class="keyword">private</span>:
00115         <span class="comment">//misc functions i thought would be handy</span>
00116         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d0">updateHistory</a>(wxString addMe); <span class="comment">//so I don't have to do it manualy</span>
00117         wxString <a class="code" href="class_debugger.html#d1">getHistoryItem</a>(<span class="keywordtype">int</span> offset);<span class="comment">//ditto</span>
00118         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d2">flushBuffer</a>();                 <span class="comment">//flushes the input-data array</span>
00119  
00120         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d3">sendCommand</a>(wxString send);    <span class="comment">//sends command &amp; updates history</span>
00121         wxString <a class="code" href="class_debugger.html#d4">getResult</a>(<span class="keywordtype">int</span> debugFlag);  <span class="comment">//gets returned output</span>
00122 
00123         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d5">makeGenericError</a>(wxString comment);
00124         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d6">addErrorHist</a>(wxString comment);<span class="comment">//updates error history</span>
00125 
00126         <span class="comment">//ASYNC Event Triggered Functions</span>
00127         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d7">onProcessOutputEvent</a>(<a class="code" href="classwx_process2_std_out_event.html">wxProcess2StdOutEvent</a> &amp;e);
00128         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d8">onProcessErrOutEvent</a>(<a class="code" href="classwx_process2_std_err_event.html">wxProcess2StdErrEvent</a> &amp;e);
00129         <span class="comment">//void onProcessTermEvent(wxProcessEvent &amp;e);</span>
00130         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d9">onProcessTermEvent</a>(<a class="code" href="classwx_process2_ended_event.html">wxProcess2EndedEvent</a> &amp;e);
00131 
00132         <span class="comment">//private elements [grouped according to function]</span>
<a name="l00133"></a><a class="code" href="class_debugger.html#r0">00133</a>         <span class="keywordtype">bool</span> isRemote;              <span class="comment">//stores current mode: false = local</span>
<a name="l00134"></a><a class="code" href="class_debugger.html#r1">00134</a>         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#r1">procLives</a>;             <span class="comment">//stores status of async process</span>
<a name="l00135"></a><a class="code" href="class_debugger.html#r2">00135</a>         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#r2">fileIsSet</a>;             <span class="comment">//stores whether a file is loaded</span>
<a name="l00136"></a><a class="code" href="class_debugger.html#r3">00136</a>         wxString <a class="code" href="class_debugger.html#r3">currFile</a>;          <span class="comment">//stores current filename for debugging</span>
00137 
<a name="l00138"></a><a class="code" href="class_debugger.html#r4">00138</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r4">status</a>;                 <span class="comment">//status of debugger</span>
<a name="l00139"></a><a class="code" href="class_debugger.html#r5">00139</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r5">classStatus</a>;            <span class="comment">//holds the last function called</span>
<a name="l00140"></a><a class="code" href="class_debugger.html#r6">00140</a>         <span class="keywordtype">long</span> <a class="code" href="class_debugger.html#r6">pid</a>;                   <span class="comment">//process ID of GDB (if running)</span>
<a name="l00141"></a><a class="code" href="class_debugger.html#r7">00141</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r7">currDebugLine</a>;          <span class="comment">//holds line number program is on</span>
00142         
<a name="l00143"></a><a class="code" href="class_debugger.html#r8">00143</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r8">breakpointCount</a>;        <span class="comment">//counts breakpoints</span>
<a name="l00144"></a><a class="code" href="class_debugger.html#r9">00144</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r9">deadBreakpoints</a>;        <span class="comment">//counts deleted breakpoints</span>
<a name="l00145"></a><a class="code" href="class_debugger.html#r10">00145</a>         wxArrayInt <a class="code" href="class_debugger.html#r10">breakpointLoc</a>;   <span class="comment">//hold breakpoint line #'s</span>
00146         
<a name="l00147"></a><a class="code" href="class_debugger.html#r11">00147</a>         wxString <a class="code" href="class_debugger.html#r11">commandHistory</a>[<a class="code" href="cham__db_8h.html#a0">MAX_HIST_ITEMS</a>];    <span class="comment">//stores command history</span>
<a name="l00148"></a><a class="code" href="class_debugger.html#r12">00148</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r12">histPointer</a>;            <span class="comment">//points to current command history</span>
00149         
<a name="l00150"></a><a class="code" href="class_debugger.html#r13">00150</a>         wxString <a class="code" href="class_debugger.html#r13">error</a>;             <span class="comment">//holds error messages</span>
<a name="l00151"></a><a class="code" href="class_debugger.html#r14">00151</a>         wxArrayString <a class="code" href="class_debugger.html#r14">errorHist</a>;    <span class="comment">//holds ALL error messages ^_^</span>
<a name="l00152"></a><a class="code" href="class_debugger.html#r15">00152</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r15">errorCount</a>;             <span class="comment">//counts the errors</span>
00153         
<a name="l00154"></a><a class="code" href="class_debugger.html#r16">00154</a>         wxString <a class="code" href="class_debugger.html#r16">command</a>;           <span class="comment">//holds current / last GDB command</span>
<a name="l00155"></a><a class="code" href="class_debugger.html#r17">00155</a>         wxString <a class="code" href="class_debugger.html#r17">returnChar</a>;        <span class="comment">//contains the \n or \r for each command</span>
<a name="l00156"></a><a class="code" href="class_debugger.html#r18">00156</a>         wxArrayString <a class="code" href="class_debugger.html#r18">data</a>;         <span class="comment">//holds data from GDB</span>
00157 
<a name="l00158"></a><a class="code" href="class_debugger.html#r19">00158</a>         wxArrayString <a class="code" href="class_debugger.html#r19">varNames</a>;     <span class="comment">//holds variables being watched</span>
<a name="l00159"></a><a class="code" href="class_debugger.html#r20">00159</a>         wxArrayString <a class="code" href="class_debugger.html#r20">varValue</a>;     <span class="comment">//holds variable values</span>
<a name="l00160"></a><a class="code" href="class_debugger.html#r21">00160</a>         wxArrayInt <a class="code" href="class_debugger.html#r21">varDispIndex</a>;    <span class="comment">//holds variable "display#" assigned by GDB</span>
<a name="l00161"></a><a class="code" href="class_debugger.html#r22">00161</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r22">topVarIndex</a>;            <span class="comment">//holds array position to insert next var</span>
<a name="l00162"></a><a class="code" href="class_debugger.html#r23">00162</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r23">varCount</a>;               <span class="comment">//holds next GDB display #</span>
00163         
<a name="l00164"></a><a class="code" href="class_debugger.html#r24">00164</a>         wxString <a class="code" href="class_debugger.html#r24">firstExecString</a>;   <span class="comment">//holds the first executed string</span>
<a name="l00165"></a><a class="code" href="class_debugger.html#r25">00165</a>         <a class="code" href="classwx_process2.html">wxProcess2</a> *<a class="code" href="class_debugger.html#r25">debugProc</a>;      <span class="comment">//holds pointer to process pipe</span>
<a name="l00166"></a><a class="code" href="class_debugger.html#r26">00166</a>         wxInputStream *<a class="code" href="class_debugger.html#r26">streamIn</a>;        <span class="comment">//GDB to me</span>
<a name="l00167"></a><a class="code" href="class_debugger.html#r27">00167</a>         wxInputStream *<a class="code" href="class_debugger.html#r27">streamError</a>;     <span class="comment">//problems</span>
00168 
00169         DECLARE_EVENT_TABLE()
00170 };
00171 
00172 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Apr 6 20:03:58 2004 for Chameleon by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
