<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Chameleon: cham_db.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>cham_db.h</h1><a href="cham__db_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*****************************************************************\</span>
00002 <span class="comment">*Wrapper Header file</span>
00003 <span class="comment">*</span>
00004 <span class="comment">*author: Ben Carhart</span>
00005 <span class="comment">*date started: 1/11/04</span>
00006 <span class="comment">*date finished: 4/20/04</span>
00007 <span class="comment">*</span>
00008 <span class="comment">*description: Code for the implementation of a wrapper for GDB</span>
00009 <span class="comment">*revisions: *see cham_db.cpp*</span>
00010 <span class="comment">*</span>
00011 <span class="comment">\*****************************************************************/</span>
00012 
00013 <span class="preprocessor">#ifndef CHAMELEON_DEBUGER_H</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#define CHAMELEON_DEBUGER_H</span>
00015 <span class="preprocessor"></span>
00016 <span class="preprocessor">#include &lt;wx/string.h&gt;</span>
00017 <span class="preprocessor">#include &lt;wx/dynarray.h&gt;</span>
00018 <span class="preprocessor">#include &lt;wx/event.h&gt;</span>
00019 <span class="preprocessor">#include &lt;wx/txtstrm.h&gt;</span>
00020 
00021 <span class="preprocessor">#include "../common/chameleonprocessevent.h"</span>
00022 <span class="preprocessor">#include "../common/debugevent.h"</span>
00023 <span class="preprocessor">#include "../network/networking.h"</span>
00024 <span class="preprocessor">#include "../common/datastructures.h"</span>
00025 
00026 <span class="keyword">class </span><a class="code" href="class_project_info.html">ProjectInfo</a>;
00027 
00028 <span class="comment">//global declarations</span>
<a name="l00029"></a><a class="code" href="cham__db_8h.html#a0">00029</a> <span class="keyword">const</span> wxString <a class="code" href="cham__db_8h.html#a0">PROMPT_CHAR</a> = <span class="stringliteral">"%"</span>;
00030 
00031 <span class="comment">//keywords for parsing output</span>
<a name="l00032"></a><a class="code" href="cham__db_8h.html#a31">00032</a> <span class="keyword">enum</span> <a class="code" href="cham__db_8h.html#a31">DEBUG_KEYS</a> {
00033     <a class="code" href="cham__db_8h.html#a31a1">START</a> = -1,             <span class="comment">//program start</span>
00034     <a class="code" href="cham__db_8h.html#a31a2">CONTINUE</a> = 134242,
00035     <a class="code" href="cham__db_8h.html#a31a3">E_BREAK</a>,                <span class="comment">//enable break</span>
00036     <a class="code" href="cham__db_8h.html#a31a4">D_BREAK</a>,                <span class="comment">//disable break</span>
00037     <a class="code" href="cham__db_8h.html#a31a5">K_BREAK</a>,                <span class="comment">//kill break</span>
00038     <a class="code" href="cham__db_8h.html#a31a6">S_BREAK</a>,                <span class="comment">//set break</span>
00039     <a class="code" href="cham__db_8h.html#a31a7">GO</a>,
00040     <a class="code" href="cham__db_8h.html#a31a8">JUMP</a>,
00041     <a class="code" href="cham__db_8h.html#a31a9">SOFT_RESET</a>,
00042     <a class="code" href="cham__db_8h.html#a31a10">HARD_RESET</a>,
00043     <a class="code" href="cham__db_8h.html#a31a11">NEW_FILE</a>,               <span class="comment">//new file to debug</span>
00044     <a class="code" href="cham__db_8h.html#a31a12">NEW_MODE</a>,               <span class="comment">//change in program mode</span>
00045     <a class="code" href="cham__db_8h.html#a31a13">NEW_PROC</a>,               <span class="comment">//change in process pointer</span>
00046     <a class="code" href="cham__db_8h.html#a31a14">VAR_ASSIGN</a>,
00047     <a class="code" href="cham__db_8h.html#a31a15">WATCH_VAR</a>,
00048     <a class="code" href="cham__db_8h.html#a31a16">STEP</a>,
00049     <a class="code" href="cham__db_8h.html#a31a17">STEP_OVER</a>,
00050     <a class="code" href="cham__db_8h.html#a31a18">STEP_OUT</a>,
00051     <a class="code" href="cham__db_8h.html#a31a19">STOP</a>,
00052     <a class="code" href="cham__db_8h.html#a31a20">GET_WHAT</a>,
00053     <a class="code" href="cham__db_8h.html#a31a21">GET_PRINT</a>,
00054     <a class="code" href="cham__db_8h.html#a31a22">RUN_TO_CURSOR</a>,
00055 
00056     <a class="code" href="cham__db_8h.html#a31a23">WAITING</a>,    <span class="comment">//134260</span>
00057 };
00058 
00059 <span class="comment">//status of program</span>
<a name="l00060"></a><a class="code" href="cham__db_8h.html#a32">00060</a> <span class="keyword">enum</span> <a class="code" href="cham__db_8h.html#a32">DEBUG_STATUS</a> {
00061     <a class="code" href="cham__db_8h.html#a32a24">DEBUG_RUNNING</a> = 135401, <span class="comment">//program running / command executing</span>
00062     <a class="code" href="cham__db_8h.html#a32a25">DEBUG_STOPPED</a>,          <span class="comment">//nothing happening right now</span>
00063     <a class="code" href="cham__db_8h.html#a32a26">DEBUG_WAIT</a>,             <span class="comment">//waiting for instruction</span>
00064     <a class="code" href="cham__db_8h.html#a32a27">DEBUG_BREAK</a>,            <span class="comment">//program paused (because of breakpoint)</span>
00065     <a class="code" href="cham__db_8h.html#a32a28">DEBUG_ERROR</a>,            <span class="comment">//problem with debug</span>
00066     <a class="code" href="cham__db_8h.html#a32a29">DEBUG_NEED_FILE</a>,        <span class="comment">//waiting for a file</span>
00067     <a class="code" href="cham__db_8h.html#a32a30">DEBUG_DEAD</a>,             <span class="comment">//there AIN'T no debug!</span>
00068 };
00069 
<a name="l00070"></a><a class="code" href="class_debugger.html">00070</a> <span class="keyword">class </span><a class="code" href="class_debugger.html">Debugger</a> : <span class="keyword">public</span> wxEvtHandler
00071 {
00072     <span class="keyword">public</span>:
00073         <span class="comment">//defaults</span>
00074         <a class="code" href="class_debugger.html#a0">Debugger</a>(<a class="code" href="class_networking.html">Networking</a>* networking, wxEvtHandler* pointer);
00075         <a class="code" href="class_debugger.html#a1">~Debugger</a>();                    <span class="comment">//destructor</span>
00076 
00077         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a2">onDebugEvent</a>(<a class="code" href="classwx_debug_event.html">wxDebugEvent</a> &amp;event);
00078 
00079         <span class="comment">//status modifiers</span>
00080         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a3">getMode</a>();                 <span class="comment">//get current mode</span>
00081         wxString <a class="code" href="class_debugger.html#a4">getFile</a>();             <span class="comment">//returns current file up for debugging</span>
00082 
00083         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a5">genericStatus</a>();            <span class="comment">//returns current debug status</span>
00084         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a6">programStatus</a>();            <span class="comment">//returns EXACT class status</span>
00085 
00086         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a7">isDebugging</a>();             <span class="comment">//returns whether i'm running or not</span>
00087         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a8">isPaused</a>();                <span class="comment">//returns status == DEBUG_WAIT more or less</span>
00088         <a class="code" href="class_project_info.html">ProjectInfo</a>* <a class="code" href="class_debugger.html#a9">getCurrentProject</a>(); <span class="comment">// returns the project being debugged</span>
00089 
00090         wxString <a class="code" href="class_debugger.html#a10">errorMsg</a>();            <span class="comment">//returns error message, if any</span>
00091         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#a11">resetStatus</a>();             <span class="comment">//hard reset * USE CAUTIOUSLY *</span>
00092         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a12">clearError</a>();              <span class="comment">//just resets the status variable</span>
00093         
00094         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a13">setProcess</a>(<span class="keywordtype">bool</span> newIsRemote, wxString newFname, wxString nExec);
00095 
00096         <span class="comment">//breakpoint management</span>
00097         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a14">setBreak</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum);       <span class="comment">//set breakpoint</span>
00098         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a15">disableBreak</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum);   <span class="comment">//disable breakpoint</span>
00099         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a16">enableBreak</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum);    <span class="comment">//enable a breakpoint</span>
00100         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a17">killBreak</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum);      <span class="comment">//delete breakpoint</span>
00101         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#a18">numBreak</a>();                                     <span class="comment">//return the # of breakpoints</span>
00102 
00103         <span class="comment">//step management</span>
00104         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a19">step</a>();
00105         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a20">stepOver</a>();                <span class="comment">//execute function lines (don't go into)</span>
00106         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a21">stepOut</a>();                 <span class="comment">//execute current stack frame to finish</span>
00107         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a22">go</a>();                      <span class="comment">//run program</span>
00108         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a23">cont</a>();                    <span class="comment">//continue debugging</span>
00109         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a24">runToCursor</a>(wxString srcFile, <span class="keywordtype">int</span> lineNum);
00110 
00111         <span class="comment">//variable management</span>
00112         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a25">snoopVar</a>(wxString varName, wxString funcName, wxString className, <span class="keywordtype">bool</span> oneShot = <span class="keyword">true</span>);
00113         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a26">setVar</a>(wxString varName, wxString newValue, wxString funcName, wxString className);
00114         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a27">removeVar</a>(wxString varName, wxString funcName, wxString className);
00115 
00116         <span class="comment">//misc management</span>
00117         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a28">stop</a>(<span class="keywordtype">bool</span> pleaseRestart);  <span class="comment">//kills process &amp; reloads it (?)</span>
00118         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a29">kill</a>();                    <span class="comment">//simple?</span>
00119         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#a30">sendCustomCommand</a>(wxString cust);  <span class="comment">//send a custom command to the process</span>
00120         wxString <a class="code" href="class_debugger.html#a31">getProcOutput</a>(<span class="keywordtype">int</span> numEntries); <span class="comment">//get the process's output to X entries back</span>
00121 
00122     <span class="keyword">private</span>:
00123         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d0">startProcess</a>(<span class="keywordtype">bool</span> fullRestart, <span class="keywordtype">bool</span> mode, wxString fName, wxString execThis);
00124 
00125         <span class="comment">//misc functions i thought would be handy</span>
00126         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d1">updateHistory</a>(wxString addMe); <span class="comment">//so I don't have to do it manualy</span>
00127         wxString <a class="code" href="class_debugger.html#d2">getHistoryItem</a>(<span class="keywordtype">int</span> offset);<span class="comment">//ditto</span>
00128         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d3">flushBuffer</a>();                 <span class="comment">//flushes the input-data array</span>
00129         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d4">flushPrivateVar</a>();             <span class="comment">//flushes all private variables</span>
00130 
00131         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d5">sendWhat</a>();                    <span class="comment">//for use with snoopVar</span>
00132         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d6">sendPrint</a>(wxString fromGDB);   <span class="comment">//for use with snoopVar as well</span>
00133         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#d7">parsePrintOutput</a>(wxString fromGDB, wxArrayString &amp;varValue);
00134         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#d8">findBreakpoint</a>(wxString fName, <span class="keywordtype">int</span> lineNum, <span class="keywordtype">bool</span> andRemove = <span class="keyword">false</span>);
00135         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#d9">checkOutputStream</a>(wxString stream);    <span class="comment">//true = okay to parse further</span>
00136  
00137         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d10">sendCommand</a>(wxString send);    <span class="comment">//sends command &amp; updates history</span>
00138 
00139         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d11">makeGenericError</a>(wxString comment);
00140         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d12">addErrorHist</a>(wxString comment);<span class="comment">//updates error history</span>
00141 
00142         <span class="comment">//ASYNC Event Triggered Functions</span>
00143         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d13">onProcessOutputEvent</a>(<a class="code" href="class_chameleon_process_event.html">ChameleonProcessEvent</a> &amp;e);
00144         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d14">onProcessErrOutEvent</a>(<a class="code" href="class_chameleon_process_event.html">ChameleonProcessEvent</a> &amp;e);
00145         <span class="keywordtype">void</span> <a class="code" href="class_debugger.html#d15">onProcessTermEvent</a>(<a class="code" href="class_chameleon_process_event.html">ChameleonProcessEvent</a> &amp;e);
00146 
00147         <span class="comment">//private elements [grouped according to function]</span>
<a name="l00148"></a><a class="code" href="class_debugger.html#r0">00148</a>         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#r0">isRemote</a>;              <span class="comment">//stores current mode: false = local</span>
<a name="l00149"></a><a class="code" href="class_debugger.html#r1">00149</a>         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#r1">procLives</a>;             <span class="comment">//stores status of async process</span>
<a name="l00150"></a><a class="code" href="class_debugger.html#r2">00150</a>         <span class="keywordtype">bool</span> <a class="code" href="class_debugger.html#r2">fileIsSet</a>;             <span class="comment">//stores whether a file is loaded</span>
<a name="l00151"></a><a class="code" href="class_debugger.html#r3">00151</a>         wxString <a class="code" href="class_debugger.html#r3">currFile</a>;          <span class="comment">//stores current filename for debugging</span>
00152 
<a name="l00153"></a><a class="code" href="class_debugger.html#r4">00153</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r4">status</a>;                 <span class="comment">//status of debugger</span>
<a name="l00154"></a><a class="code" href="class_debugger.html#r5">00154</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r5">classStatus</a>;            <span class="comment">//holds the last function called</span>
<a name="l00155"></a><a class="code" href="class_debugger.html#r6">00155</a>         <span class="keywordtype">long</span> pid;                   <span class="comment">//process ID of GDB (if running)</span>
00156                 
<a name="l00157"></a><a class="code" href="class_debugger.html#r7">00157</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r7">gdbBreakpointNum</a>;       <span class="comment">//keeps track of GDB's #ing system</span>
<a name="l00158"></a><a class="code" href="class_debugger.html#r8">00158</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r8">numBreakpoints</a>;         <span class="comment">//keeps track of actual number of live ones</span>
<a name="l00159"></a><a class="code" href="class_debugger.html#r9">00159</a>         DebugBreakHash <a class="code" href="class_debugger.html#r9">lineToNum</a>;
00160         
<a name="l00161"></a><a class="code" href="class_debugger.html#r10">00161</a>         wxArrayString <a class="code" href="class_debugger.html#r10">commandHistory</a>;   <span class="comment">//stores command history</span>
<a name="l00162"></a><a class="code" href="class_debugger.html#r11">00162</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r11">histCount</a>;              <span class="comment">//points to current top command</span>
00163         
<a name="l00164"></a><a class="code" href="class_debugger.html#r12">00164</a>         wxString <a class="code" href="class_debugger.html#r12">error</a>;             <span class="comment">//holds error messages</span>
<a name="l00165"></a><a class="code" href="class_debugger.html#r13">00165</a>         wxArrayString <a class="code" href="class_debugger.html#r13">errorHist</a>;    <span class="comment">//holds ALL error messages ^_^</span>
<a name="l00166"></a><a class="code" href="class_debugger.html#r14">00166</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r14">errorCount</a>;             <span class="comment">//counts the errors</span>
00167         
<a name="l00168"></a><a class="code" href="class_debugger.html#r15">00168</a>         wxString <a class="code" href="class_debugger.html#r15">command</a>;           <span class="comment">//holds current / last GDB command</span>
<a name="l00169"></a><a class="code" href="class_debugger.html#r16">00169</a>         wxString <a class="code" href="class_debugger.html#r16">returnChar</a>;        <span class="comment">//contains the \n or \r for each command</span>
<a name="l00170"></a><a class="code" href="class_debugger.html#r17">00170</a>         wxArrayString <a class="code" href="class_debugger.html#r17">data</a>;         <span class="comment">//holds data from GDB</span>
<a name="l00171"></a><a class="code" href="class_debugger.html#r18">00171</a>         wxArrayString <a class="code" href="class_debugger.html#r18">fullOutput</a>;   <span class="comment">//holds ALL data back from the process</span>
00172 
<a name="l00173"></a><a class="code" href="class_debugger.html#r19">00173</a>         StringStringHashmap <a class="code" href="class_debugger.html#r19">varRegExes</a>;
<a name="l00174"></a><a class="code" href="class_debugger.html#r21">00174</a>         wxString <a class="code" href="class_debugger.html#r20">Filename</a>, <a class="code" href="class_debugger.html#r21">Linenumber</a>, <a class="code" href="class_debugger.html#r22">FuncName</a>;    <span class="comment">//globals for use in parse</span>
00175 
<a name="l00176"></a><a class="code" href="class_debugger.html#r23">00176</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r23">varCount</a>;               <span class="comment">//holds array position to insert next var</span>
00177 
<a name="l00178"></a><a class="code" href="class_debugger.html#r24">00178</a>         VariableInfoArray <a class="code" href="class_debugger.html#r24">m_varInfo</a>;<span class="comment">//same as VariableInfoHash... only an array</span>
00179 
<a name="l00180"></a><a class="code" href="class_debugger.html#r25">00180</a>         wxString <a class="code" href="class_debugger.html#r25">firstExecString</a>;   <span class="comment">//holds the first executed string</span>
<a name="l00181"></a><a class="code" href="class_debugger.html#r26">00181</a>         wxString <a class="code" href="class_debugger.html#r26">currentSourceName</a>; <span class="comment">//holds filename source</span>
00182 
<a name="l00183"></a><a class="code" href="class_debugger.html#r27">00183</a>         <a class="code" href="class_networking.html">Networking</a> *<a class="code" href="class_debugger.html#r27">myConnection</a>;   <span class="comment">//the networking object for remote</span>
<a name="l00184"></a><a class="code" href="class_debugger.html#r28">00184</a>         wxTextOutputStream* <a class="code" href="class_debugger.html#r28">streamOut</a>;  <span class="comment">//output to GDB</span>
<a name="l00185"></a><a class="code" href="class_debugger.html#r29">00185</a>         <a class="code" href="classwx_debug_event.html">wxDebugEvent</a>* <a class="code" href="class_debugger.html#r29">myEvent</a>;      <span class="comment">//how i communicate</span>
00186 
00187         <span class="comment">//GUI connectivity</span>
<a name="l00188"></a><a class="code" href="class_debugger.html#r30">00188</a>         wxEvtHandler* <a class="code" href="class_debugger.html#r30">guiPointer</a>;
<a name="l00189"></a><a class="code" href="class_debugger.html#r31">00189</a>         <a class="code" href="class_project_info.html">ProjectInfo</a>* <a class="code" href="class_debugger.html#r31">projectBeingDebugged</a>;
00190 
<a name="l00191"></a><a class="code" href="class_debugger.html#r32">00191</a>         <span class="keywordtype">int</span> <a class="code" href="class_debugger.html#r32">m_numberOfDebugEvents</a>;
00192 
00193         DECLARE_EVENT_TABLE()
00194 };
00195 
00196 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 28 16:45:37 2004 for Chameleon by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
