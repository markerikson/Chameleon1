<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Chameleon: wxterm.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>wxterm.cpp</h1><a href="wxterm_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 
00003 
00004 <span class="comment">/*</span>
00005 <span class="comment">    taTelnet - A cross-platform telnet program.</span>
00006 <span class="comment">    Copyright (c) 2000 Derry Bryson.</span>
00007 <span class="comment"></span>
00008 <span class="comment">    This program is free software; you can redistribute it and/or modify</span>
00009 <span class="comment">    it under the terms of the GNU General Public License as published by</span>
00010 <span class="comment">    the Free Software Foundation; either version 2 of the License, or</span>
00011 <span class="comment">    (at your option) any later version.</span>
00012 <span class="comment"></span>
00013 <span class="comment">    This program is distributed in the hope that it will be useful,</span>
00014 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00015 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00016 <span class="comment">    GNU General Public License for more details.</span>
00017 <span class="comment"></span>
00018 <span class="comment">    You should have received a copy of the GNU General Public License</span>
00019 <span class="comment">    along with this program; if not, write to the Free Software</span>
00020 <span class="comment">    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00021 <span class="comment"></span>
00022 <span class="comment">    Contact Information:</span>
00023 <span class="comment"></span>
00024 <span class="comment">       Technology Associates, Inc.</span>
00025 <span class="comment">       Attn:  Derry Bryson</span>
00026 <span class="comment">       959 W. 5th Street</span>
00027 <span class="comment">       Reno, NV  89503</span>
00028 <span class="comment">       USA</span>
00029 <span class="comment"></span>
00030 <span class="comment">       derry@techass.com</span>
00031 <span class="comment">*/</span>
00032 
00033 <span class="preprocessor">#ifdef __GNUG__</span>
00034 <span class="preprocessor"></span><span class="preprocessor">    #pragma implementation "wxterm.h"</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00036 <span class="preprocessor"></span>
00037 <span class="comment">// For compilers that support precompilation, includes "wx/wx.h".</span>
00038 <span class="preprocessor">#include "wx/wxprec.h"</span>
00039 
00040 <span class="preprocessor">#ifdef __BORLANDC__</span>
00041 <span class="preprocessor"></span><span class="preprocessor">    #pragma hdrstop</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00043 <span class="preprocessor"></span>
00044 <span class="comment">// for all others, include the necessary headers (this file is usually all you</span>
00045 <span class="comment">// need because it includes almost all "standard" wxWindows headers</span>
00046 <span class="preprocessor">#ifndef WX_PRECOMP</span>
00047 <span class="preprocessor"></span><span class="preprocessor">    #include "wx/wx.h"</span>
00048 <span class="preprocessor">#endif</span>
00049 <span class="preprocessor"></span>
00050 <span class="preprocessor">#include &lt;wx/timer.h&gt;</span>
00051 
00052 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
00053 
00054 <span class="preprocessor">#include "../network/gterm.hpp"</span>
00055 <span class="preprocessor">#include "../network/gtelnet.hpp"</span>
00056 <span class="preprocessor">#include "<a class="code" href="wxterm_8h.html">wxterm.h</a>"</span>
00057 
00058 <span class="preprocessor">#include "../common/debug.h"</span>
00059 
00060 <span class="preprocessor">#ifdef _DEBUG</span>
00061 <span class="preprocessor"></span><span class="preprocessor">#define new DEBUG_NEW</span>
00062 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00063 <span class="preprocessor"></span>
00064 
00065 <span class="keywordtype">void</span> <a class="code" href="wxterm_8cpp.html#a3">WinMessageBeep</a>();
00066 
<a name="l00067"></a><a class="code" href="wxterm_8cpp.html#a0">00067</a> <span class="preprocessor">#define CURSOR_BLINK_DEFAULT_TIMEOUT    300</span>
<a name="l00068"></a><a class="code" href="wxterm_8cpp.html#a1">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define CURSOR_BLINK_MAX_TIMEOUT    2000</span>
00069 <span class="preprocessor"></span>
00070 <span class="comment">/*</span>
00071 <span class="comment">**  Keycode translation tables</span>
00072 <span class="comment">*/</span>
<a name="l00073"></a><a class="code" href="classwx_term.html#v0">00073</a> <a class="code" href="structwx_term_1_1_term_key_map.html">wxTerm::TermKeyMap</a> <a class="code" href="classwx_term.html#v0">wxTerm::keyMapTable</a>[] =
00074 {
00075   { WXK_BACK, GTelnet::KEY_BACK },
00076   { WXK_TAB, GTelnet::KEY_TAB },
00077   { WXK_RETURN, GTelnet::KEY_RETURN },
00078   { WXK_ESCAPE, GTelnet::KEY_ESCAPE },
00079   { WXK_SPACE, GTelnet::KEY_SPACE },
00080   { WXK_LEFT, GTelnet::KEY_LEFT },
00081   { WXK_UP, GTelnet::KEY_UP },
00082   { WXK_RIGHT, GTelnet::KEY_RIGHT },
00083   { WXK_DOWN, GTelnet::KEY_DOWN },
00084 <span class="comment">//  { WXK_DIVIDE, GTelnet::KEY_DIVIDE },</span>
00085 <span class="comment">//  { WXK_MULTIPLY, GTelnet::KEY_MULTIPLY },</span>
00086 <span class="comment">//  { WXK_SUBTRACT, GTelnet::KEY_SUBTRACT },</span>
00087 <span class="comment">//  { WXK_ADD, GTelnet::KEY_ADD },</span>
00088   { WXK_HOME, GTelnet::KEY_HOME },
00089   { WXK_END, GTelnet::KEY_END },
00090   { WXK_PAGEUP, GTelnet::KEY_PAGEUP },
00091   { WXK_PAGEDOWN, GTelnet::KEY_PAGEDOWN },
00092   { WXK_INSERT, GTelnet::KEY_INSERT },
00093   { WXK_DELETE, GTelnet::KEY_DELETE },
00094   { WXK_NEXT, GTelnet::KEY_NEXT },
00095   { WXK_PRIOR, GTelnet::KEY_PRIOR },
00096 <span class="comment">//  { WXK_NUMPAD0, GTelnet::KEY_NUMPAD0 },</span>
00097 <span class="comment">//  { WXK_NUMPAD1, GTelnet::KEY_NUMPAD1 },</span>
00098 <span class="comment">//  { WXK_NUMPAD2, GTelnet::KEY_NUMPAD2 },</span>
00099 <span class="comment">//  { WXK_NUMPAD3, GTelnet::KEY_NUMPAD3 },</span>
00100 <span class="comment">//  { WXK_NUMPAD4, GTelnet::KEY_NUMPAD4 },</span>
00101 <span class="comment">//  { WXK_NUMPAD5, GTelnet::KEY_NUMPAD5 },</span>
00102 <span class="comment">//  { WXK_NUMPAD6, GTelnet::KEY_NUMPAD6 },</span>
00103 <span class="comment">//  { WXK_NUMPAD7, GTelnet::KEY_NUMPAD7 },</span>
00104 <span class="comment">//  { WXK_NUMPAD8, GTelnet::KEY_NUMPAD8 },</span>
00105 <span class="comment">//  { WXK_NUMPAD9, GTelnet::KEY_NUMPAD9 },</span>
00106 <span class="comment">//  { WXK_DECIMAL, GTelnet::KEY_NUMPAD_DECIMAL },</span>
00107   { WXK_F1, GTelnet::KEY_F1 },
00108   { WXK_F2, GTelnet::KEY_F2 },
00109   { WXK_F3, GTelnet::KEY_F3 },
00110   { WXK_F4, GTelnet::KEY_F4 },
00111   { WXK_F5, GTelnet::KEY_F5 },
00112   { WXK_F6, GTelnet::KEY_F6 },
00113   { WXK_F7, GTelnet::KEY_F7 },
00114   { WXK_F8, GTelnet::KEY_F8 },
00115   { WXK_F9, GTelnet::KEY_F9 },
00116   { WXK_F10, GTelnet::KEY_F10 },
00117   { WXK_F11, GTelnet::KEY_F11 },
00118   { WXK_F12, GTelnet::KEY_F12 },
00119   { (wxKeyCode)0, GTelnet::KEY_NULL }
00120 };
00121 
00122 <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>
00123   xCharMap[] =
00124   {
00125     0, <span class="comment">// 0</span>
00126     1, <span class="comment">// 1</span>
00127     2, <span class="comment">// 2</span>
00128     3, <span class="comment">// 3</span>
00129     1, <span class="comment">// 4</span>
00130     5, <span class="comment">// 5</span>
00131     6, <span class="comment">// 6</span>
00132     7, <span class="comment">// 7</span>
00133     8, <span class="comment">// 8</span>
00134     9, <span class="comment">// 9</span>
00135     10, <span class="comment">// 10</span>
00136     11, <span class="comment">// 11</span>
00137     12, <span class="comment">// 12</span>
00138     13, <span class="comment">// 13</span>
00139     14, <span class="comment">// 14</span>
00140     15, <span class="comment">// 15</span>
00141     62, <span class="comment">// 16</span>
00142     60, <span class="comment">// 17</span>
00143     18, <span class="comment">// 18</span>
00144     19, <span class="comment">// 19</span>
00145     20, <span class="comment">// 20</span>
00146     21, <span class="comment">// 21</span>
00147     22, <span class="comment">// 22</span>
00148     23, <span class="comment">// 23</span>
00149     24, <span class="comment">// 24</span>
00150     25, <span class="comment">// 25</span>
00151     26, <span class="comment">// 26</span>
00152     27, <span class="comment">// 27</span>
00153     28, <span class="comment">// 28</span>
00154     29, <span class="comment">// 29</span>
00155     94, <span class="comment">// 30</span>
00156     31, <span class="comment">// 31</span>
00157     32, <span class="comment">// 32</span>
00158     33, <span class="comment">// 33</span>
00159     34, <span class="comment">// 34</span>
00160     35, <span class="comment">// 35</span>
00161     36, <span class="comment">// 36</span>
00162     37, <span class="comment">// 37</span>
00163     38, <span class="comment">// 38</span>
00164     39, <span class="comment">// 39</span>
00165     40, <span class="comment">// 40</span>
00166     41, <span class="comment">// 41</span>
00167     42, <span class="comment">// 42</span>
00168     43, <span class="comment">// 43</span>
00169     44, <span class="comment">// 44</span>
00170     45, <span class="comment">// 45</span>
00171     46, <span class="comment">// 46</span>
00172     47, <span class="comment">// 47</span>
00173     48, <span class="comment">// 48</span>
00174     49, <span class="comment">// 49</span>
00175     50, <span class="comment">// 50</span>
00176     51, <span class="comment">// 51</span>
00177     52, <span class="comment">// 52</span>
00178     53, <span class="comment">// 53</span>
00179     54, <span class="comment">// 54</span>
00180     55, <span class="comment">// 55</span>
00181     56, <span class="comment">// 56</span>
00182     57, <span class="comment">// 57</span>
00183     58, <span class="comment">// 58</span>
00184     59, <span class="comment">// 59</span>
00185     60, <span class="comment">// 60</span>
00186     61, <span class="comment">// 61</span>
00187     62, <span class="comment">// 62</span>
00188     63, <span class="comment">// 63</span>
00189     64, <span class="comment">// 64</span>
00190     65, <span class="comment">// 65</span>
00191     66, <span class="comment">// 66</span>
00192     67, <span class="comment">// 67</span>
00193     68, <span class="comment">// 68</span>
00194     69, <span class="comment">// 69</span>
00195     70, <span class="comment">// 70</span>
00196     71, <span class="comment">// 71</span>
00197     72, <span class="comment">// 72</span>
00198     73, <span class="comment">// 73</span>
00199     74, <span class="comment">// 74</span>
00200     75, <span class="comment">// 75</span>
00201     76, <span class="comment">// 76</span>
00202     77, <span class="comment">// 77</span>
00203     78, <span class="comment">// 78</span>
00204     79, <span class="comment">// 79</span>
00205     80, <span class="comment">// 80</span>
00206     81, <span class="comment">// 81</span>
00207     82, <span class="comment">// 82</span>
00208     83, <span class="comment">// 83</span>
00209     84, <span class="comment">// 84</span>
00210     85, <span class="comment">// 85</span>
00211     86, <span class="comment">// 86</span>
00212     87, <span class="comment">// 87</span>
00213     88, <span class="comment">// 88</span>
00214     89, <span class="comment">// 89</span>
00215     90, <span class="comment">// 90</span>
00216     91, <span class="comment">// 91</span>
00217     92, <span class="comment">// 92</span>
00218     93, <span class="comment">// 93</span>
00219     94, <span class="comment">// 94</span>
00220     95, <span class="comment">// 95</span>
00221     96, <span class="comment">// 96</span>
00222     97, <span class="comment">// 97</span>
00223     98, <span class="comment">// 98</span>
00224     99, <span class="comment">// 99</span>
00225     100, <span class="comment">// 100</span>
00226     101, <span class="comment">// 101</span>
00227     102, <span class="comment">// 102</span>
00228     103, <span class="comment">// 103</span>
00229     104, <span class="comment">// 104</span>
00230     105, <span class="comment">// 105</span>
00231     106, <span class="comment">// 106</span>
00232     107, <span class="comment">// 107</span>
00233     108, <span class="comment">// 108</span>
00234     109, <span class="comment">// 109</span>
00235     110, <span class="comment">// 110</span>
00236     111, <span class="comment">// 111</span>
00237     112, <span class="comment">// 112</span>
00238     113, <span class="comment">// 113</span>
00239     114, <span class="comment">// 114</span>
00240     115, <span class="comment">// 115</span>
00241     116, <span class="comment">// 116</span>
00242     117, <span class="comment">// 117</span>
00243     118, <span class="comment">// 118</span>
00244     119, <span class="comment">// 119</span>
00245     120, <span class="comment">// 120</span>
00246     121, <span class="comment">// 121</span>
00247     122, <span class="comment">// 122</span>
00248     123, <span class="comment">// 123</span>
00249     124, <span class="comment">// 124</span>
00250     125, <span class="comment">// 125</span>
00251     126, <span class="comment">// 126</span>
00252     127, <span class="comment">// 127</span>
00253     128, <span class="comment">// 128</span>
00254     129, <span class="comment">// 129</span>
00255     130, <span class="comment">// 130</span>
00256     131, <span class="comment">// 131</span>
00257     132, <span class="comment">// 132</span>
00258     133, <span class="comment">// 133</span>
00259     134, <span class="comment">// 134</span>
00260     135, <span class="comment">// 135</span>
00261     136, <span class="comment">// 136</span>
00262     137, <span class="comment">// 137</span>
00263     138, <span class="comment">// 138</span>
00264     139, <span class="comment">// 139</span>
00265     140, <span class="comment">// 140</span>
00266     141, <span class="comment">// 141</span>
00267     142, <span class="comment">// 142</span>
00268     143, <span class="comment">// 143</span>
00269     144, <span class="comment">// 144</span>
00270     145, <span class="comment">// 145</span>
00271     146, <span class="comment">// 146</span>
00272     147, <span class="comment">// 147</span>
00273     148, <span class="comment">// 148</span>
00274     149, <span class="comment">// 149</span>
00275     150, <span class="comment">// 150</span>
00276     151, <span class="comment">// 151</span>
00277     152, <span class="comment">// 152</span>
00278     153, <span class="comment">// 153</span>
00279     154, <span class="comment">// 154</span>
00280     155, <span class="comment">// 155</span>
00281     156, <span class="comment">// 156</span>
00282     157, <span class="comment">// 157</span>
00283     158, <span class="comment">// 158</span>
00284     159, <span class="comment">// 159</span>
00285     160, <span class="comment">// 160</span>
00286     161, <span class="comment">// 161</span>
00287     162, <span class="comment">// 162</span>
00288     163, <span class="comment">// 163</span>
00289     164, <span class="comment">// 164</span>
00290     165, <span class="comment">// 165</span>
00291     166, <span class="comment">// 166</span>
00292     167, <span class="comment">// 167</span>
00293     168, <span class="comment">// 168</span>
00294     169, <span class="comment">// 169</span>
00295     170, <span class="comment">// 170</span>
00296     171, <span class="comment">// 171</span>
00297     172, <span class="comment">// 172</span>
00298     173, <span class="comment">// 173</span>
00299     174, <span class="comment">// 174</span>
00300     175, <span class="comment">// 175</span>
00301     2, <span class="comment">// 176</span>
00302     2, <span class="comment">// 177</span>
00303     2, <span class="comment">// 178</span>
00304     25, <span class="comment">// 179</span>
00305     22, <span class="comment">// 180</span>
00306     22, <span class="comment">// 181</span>
00307     22, <span class="comment">// 182</span>
00308     12, <span class="comment">// 183</span>
00309     12, <span class="comment">// 184</span>
00310     22, <span class="comment">// 185</span>
00311     25, <span class="comment">// 186</span>
00312     12, <span class="comment">// 187</span>
00313     11, <span class="comment">// 188</span>
00314     11, <span class="comment">// 189</span>
00315     11, <span class="comment">// 190</span>
00316     12, <span class="comment">// 191</span>
00317     14, <span class="comment">// 192</span>
00318     23, <span class="comment">// 193</span>
00319     24, <span class="comment">// 194</span>
00320     21, <span class="comment">// 195</span>
00321     18, <span class="comment">// 196</span>
00322     15, <span class="comment">// 197</span>
00323     21, <span class="comment">// 198</span>
00324     21, <span class="comment">// 199</span>
00325     14, <span class="comment">// 200</span>
00326     13, <span class="comment">// 201</span>
00327     23, <span class="comment">// 202</span>
00328     24, <span class="comment">// 203</span>
00329     21, <span class="comment">// 204</span>
00330     18, <span class="comment">// 205</span>
00331     15, <span class="comment">// 206</span>
00332     23, <span class="comment">// 207</span>
00333     23, <span class="comment">// 208</span>
00334     24, <span class="comment">// 209</span>
00335     24, <span class="comment">// 210</span>
00336     14, <span class="comment">// 211</span>
00337     14, <span class="comment">// 212</span>
00338     13, <span class="comment">// 213</span>
00339     13, <span class="comment">// 214</span>
00340     15, <span class="comment">// 215</span>
00341     15, <span class="comment">// 216</span>
00342     11, <span class="comment">// 217</span>
00343     13, <span class="comment">// 218</span>
00344     0, <span class="comment">// 219</span>
00345     220, <span class="comment">// 220</span>
00346     221, <span class="comment">// 221</span>
00347     222, <span class="comment">// 222</span>
00348     223, <span class="comment">// 223</span>
00349     224, <span class="comment">// 224</span>
00350     225, <span class="comment">// 225</span>
00351     226, <span class="comment">// 226</span>
00352     227, <span class="comment">// 227</span>
00353     228, <span class="comment">// 228</span>
00354     229, <span class="comment">// 229</span>
00355     230, <span class="comment">// 230</span>
00356     231, <span class="comment">// 231</span>
00357     232, <span class="comment">// 232</span>
00358     233, <span class="comment">// 233</span>
00359     234, <span class="comment">// 234</span>
00360     235, <span class="comment">// 235</span>
00361     236, <span class="comment">// 236</span>
00362     237, <span class="comment">// 237</span>
00363     238, <span class="comment">// 238</span>
00364     239, <span class="comment">// 239</span>
00365     240, <span class="comment">// 240</span>
00366     241, <span class="comment">// 241</span>
00367     242, <span class="comment">// 242</span>
00368     243, <span class="comment">// 243</span>
00369     244, <span class="comment">// 244</span>
00370     245, <span class="comment">// 245</span>
00371     246, <span class="comment">// 246</span>
00372     247, <span class="comment">// 247</span>
00373     248, <span class="comment">// 248</span>
00374     249, <span class="comment">// 249</span>
00375     250, <span class="comment">// 250</span>
00376     251, <span class="comment">// 251</span>
00377     252, <span class="comment">// 252</span>
00378     253, <span class="comment">// 253</span>
00379     254, <span class="comment">// 254</span>
00380     255  <span class="comment">// 255</span>
00381   };
00382 
00383 BEGIN_EVENT_TABLE(<a class="code" href="classwx_term.html">wxTerm</a>, wxWindow)
00384   EVT_PAINT                     (wxTerm::OnPaint)
00385   EVT_CHAR                      (wxTerm::OnChar)
00386   EVT_LEFT_DOWN                 (wxTerm::OnLeftDown)
00387   EVT_LEFT_UP                   (wxTerm::OnLeftUp)
00388   EVT_MOTION                    (wxTerm::OnMouseMove)
00389   EVT_TIMER                     (-1, wxTerm::OnTimer)
00390 #<span class="keywordflow">if</span> 0
00391   EVT_KEY_DOWN(wxTerm::OnKeyDown)
00392 #endif
00393 
00394   EVT_SIZE                      (wxTerm::OnSize)
00395   EVT_SET_FOCUS                 (wxTerm::OnGainFocus)
00396   EVT_KILL_FOCUS                (wxTerm::OnLoseFocus)
00397 END_EVENT_TABLE()
00398 
<a name="l00399"></a><a class="code" href="classwx_term.html#a0">00399</a> <a class="code" href="classwx_term.html#a0">wxTerm::wxTerm</a>(wxWindow* parent, wxWindowID <span class="keywordtype">id</span>,
00400                <span class="keyword">const</span> wxPoint&amp; pos,
00401                <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,
00402                <span class="keyword">const</span> wxString&amp; name) :
00403   wxWindow(parent, id, pos, wxSize(-1, -1), wxWANTS_CHARS, name),
00404   <a class="code" href="class_g_term.html">GTerm</a>(width, height)
00405 {
00406   <span class="keywordtype">int</span>
00407     i;
00408 
00409   <a class="code" href="classwx_term.html#r22">m_inUpdateSize</a> = <span class="keyword">false</span>;
00410   <a class="code" href="classwx_term.html#r23">m_isActive</a> = <span class="keyword">false</span>;
00411   <a class="code" href="classwx_term.html#r16">m_scrollBarWidth</a> = wxSystemSettings::GetMetric(wxSYS_VSCROLL_ARROW_X);
00412 
00413   <a class="code" href="classwx_term.html#r2">m_init</a> = 1;
00414 
00415   <a class="code" href="classwx_term.html#r34">m_curDC</a> = 0;
00416 
00417   <a class="code" href="classwx_term.html#r17">m_charsInLine</a> = width;
00418   <a class="code" href="classwx_term.html#r18">m_linesDisplayed</a> = height;
00419 
00420   <a class="code" href="classwx_term.html#r20">m_selecting</a> = FALSE;
00421   <a class="code" href="classwx_term.html#r5">m_selx1</a> = <a class="code" href="classwx_term.html#r6">m_sely1</a> = <a class="code" href="classwx_term.html#r7">m_selx2</a> = <a class="code" href="classwx_term.html#r8">m_sely2</a> = 0;
00422   <a class="code" href="classwx_term.html#r21">m_marking</a> = FALSE;
00423   <a class="code" href="classwx_term.html#r9">m_curX</a> = -1;
00424   <a class="code" href="classwx_term.html#r10">m_curY</a> = -1;
00425   <a class="code" href="classwx_term.html#r15">m_curBlinkRate</a> = <a class="code" href="wxterm_8cpp.html#a0">CURSOR_BLINK_DEFAULT_TIMEOUT</a>;
00426   <a class="code" href="classwx_term.html#r39">m_timer</a>.SetOwner(<span class="keyword">this</span>);
00427   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r15">m_curBlinkRate</a>)
00428     <a class="code" href="classwx_term.html#r39">m_timer</a>.Start(<a class="code" href="classwx_term.html#r15">m_curBlinkRate</a>);
00429 
00430   <a class="code" href="classwx_term.html#r40">m_boldStyle</a> = <a class="code" href="classwx_term.html#w4w1">COLOR</a>;
00431 
00432   <a class="code" href="classwx_term.html#a3">GetDefVTColors</a>(<a class="code" href="classwx_term.html#r24">m_vt_colors</a>);
00433   <a class="code" href="classwx_term.html#a6">GetDefPCColors</a>(<a class="code" href="classwx_term.html#r25">m_pc_colors</a>);
00434 
00435   <a class="code" href="classwx_term.html#r26">m_colors</a> = <a class="code" href="classwx_term.html#r24">m_vt_colors</a>;
00436 
00437   SetBackgroundColour(<a class="code" href="classwx_term.html#r26">m_colors</a>[0]);
00438 
00439   <span class="keywordflow">for</span>(i = 0; i &lt; 16; i++)
00440     <a class="code" href="classwx_term.html#r27">m_vt_colorPens</a>[i] = wxPen(m_vt_colors[i], 1, wxSOLID);
00441 
00442   <span class="keywordflow">for</span>(i = 0; i &lt; 16; i++)
00443     <a class="code" href="classwx_term.html#r28">m_pc_colorPens</a>[i] = wxPen(<a class="code" href="classwx_term.html#r25">m_pc_colors</a>[i], 1, wxSOLID);
00444 
00445   <a class="code" href="classwx_term.html#r29">m_colorPens</a> = <a class="code" href="classwx_term.html#r27">m_vt_colorPens</a>;
00446 
00447   <a class="code" href="classwx_term.html#r3">m_width</a> = width;
00448   <a class="code" href="classwx_term.html#r4">m_height</a> = height;
00449 
00450   <a class="code" href="classwx_term.html#r37">m_printerFN</a> = 0;
00451   <a class="code" href="classwx_term.html#r38">m_printerName</a> = 0;
00452 
00453  
00454 
00455   <a class="code" href="classwx_term.html#r30">m_normalFont</a> = GetFont();
00456   <a class="code" href="classwx_term.html#r31">m_underlinedFont</a> = GetFont();
00457   <a class="code" href="classwx_term.html#r31">m_underlinedFont</a>.SetUnderlined(TRUE);
00458   <a class="code" href="classwx_term.html#r32">m_boldFont</a> = GetFont();
00459   <a class="code" href="classwx_term.html#r32">m_boldFont</a>.SetWeight(wxBOLD);
00460   <a class="code" href="classwx_term.html#r33">m_boldUnderlinedFont</a> = <a class="code" href="classwx_term.html#r32">m_boldFont</a>;
00461   <a class="code" href="classwx_term.html#r33">m_boldUnderlinedFont</a>.SetUnderlined(TRUE);
00462 
00463   <a class="code" href="classwx_term.html#r36">m_bitmap</a> = 0;
00464 
00465   
00466   <span class="comment">//ResizeTerminal(width, height);</span>
00467 
00468   
00469   <span class="comment">//SetVirtualSize(m_charWidth * 80, m_charHeight * 100);</span>
00470   <span class="comment">//SetScrollRate(m_charWidth, m_charHeight);</span>
00471 
00472   <a class="code" href="classwx_term.html#r2">m_init</a> = 0;
00473 
00474   SetCursor(wxCursor(wxCURSOR_IBEAM));
00475 
00476   wxFont monospacedFont(10, wxMODERN, wxNORMAL, wxNORMAL, <span class="keyword">false</span>, <span class="stringliteral">"Courier New"</span>);
00477   <a class="code" href="classwx_term.html#a2">SetFont</a>(monospacedFont);
00478 
00479 
00480   <span class="comment">// 10pt Courier New is 8 pixels wide and 16 pixels high... set up</span>
00481   <span class="comment">// a default client size to match</span>
00482   SetClientSize(<a class="code" href="classwx_term.html#r17">m_charsInLine</a> * 8, <a class="code" href="classwx_term.html#r18">m_linesDisplayed</a> * 16);
00483   <a class="code" href="classwx_term.html#a18">UpdateSize</a>();
00484 }
00485 
<a name="l00486"></a><a class="code" href="classwx_term.html#a1">00486</a> <a class="code" href="classwx_term.html#a1">wxTerm::~wxTerm</a>()
00487 {
00488   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r36">m_bitmap</a>)
00489   {
00490     <a class="code" href="classwx_term.html#r35">m_memDC</a>.SelectObject(wxNullBitmap);
00491     <span class="keyword">delete</span> <a class="code" href="classwx_term.html#r36">m_bitmap</a>;
00492   }
00493 }
00494 
00505 <span class="keywordtype">void</span>
<a name="l00506"></a><a class="code" href="classwx_term.html#a11">00506</a> <a class="code" href="classwx_term.html#a11">wxTerm::SetBoldStyle</a>(wxTerm::BOLDSTYLE boldStyle)
00507 {
00508   wxColour
00509     colors[16];
00510 
00511   <span class="keywordflow">if</span>(boldStyle == <a class="code" href="classwx_term.html#w4w0">DEFAULT</a>)
00512     boldStyle = <a class="code" href="classwx_term.html#w4w1">COLOR</a>;
00513 
00514   <a class="code" href="classwx_term.html#r40">m_boldStyle</a> = boldStyle;
00515 <span class="comment">//  GetDefVTColors(colors, m_boldStyle);</span>
00516 <span class="comment">//  SetVTColors(colors);</span>
00517   Refresh();
00518 }
00519 
00530 <span class="keywordtype">bool</span>
<a name="l00531"></a><a class="code" href="classwx_term.html#a2">00531</a> <a class="code" href="classwx_term.html#a2">wxTerm::SetFont</a>(<span class="keyword">const</span> wxFont&amp; font)
00532 {
00533   <a class="code" href="classwx_term.html#r2">m_init</a> = 1;
00534   
00535   wxWindow::SetFont(font);
00536   <a class="code" href="classwx_term.html#r30">m_normalFont</a> = font;
00537   <a class="code" href="classwx_term.html#r31">m_underlinedFont</a> = font;
00538   <a class="code" href="classwx_term.html#r31">m_underlinedFont</a>.SetUnderlined(TRUE);
00539   <a class="code" href="classwx_term.html#r32">m_boldFont</a> = GetFont();
00540   <a class="code" href="classwx_term.html#r32">m_boldFont</a>.SetWeight(wxBOLD);
00541   <a class="code" href="classwx_term.html#r33">m_boldUnderlinedFont</a> = <a class="code" href="classwx_term.html#r32">m_boldFont</a>;
00542   <a class="code" href="classwx_term.html#r33">m_boldUnderlinedFont</a>.SetUnderlined(TRUE);
00543   <a class="code" href="classwx_term.html#r2">m_init</a> = 0;
00544   
00545   <a class="code" href="classwx_term.html#a25">ResizeTerminal</a>(<a class="code" href="classwx_term.html#r3">m_width</a>, <a class="code" href="classwx_term.html#r4">m_height</a>);
00546   Refresh();
00547   
00548   <span class="keywordflow">return</span> TRUE;
00549 }
00550 
00562 <span class="keywordtype">void</span>
00563 <a class="code" href="classwx_term.html#a3">wxTerm::GetDefVTColors</a>(wxColour colors[16], wxTerm::BOLDSTYLE boldStyle)
00564 {
00565   <span class="keywordflow">if</span>(boldStyle == DEFAULT)
00566     boldStyle = m_boldStyle;
00567 
00568   <span class="keywordflow">if</span>(boldStyle != COLOR)
00569   {
00570     colors[0] = wxColour(0, 0, 0);                             <span class="comment">// black</span>
00571     colors[1] = wxColour(255, 0, 0);                           <span class="comment">// red</span>
00572     colors[2] = wxColour(0, 255, 0);                           <span class="comment">// green</span>
00573     colors[3] = wxColour(255, 0, 255);                         <span class="comment">// yellow</span>
00574     colors[4] = wxColour(0, 0, 255);                           <span class="comment">// blue</span>
00575     colors[5] = wxColour(255, 255, 0);                         <span class="comment">// magenta</span>
00576     colors[6] = wxColour(0, 255, 255);                         <span class="comment">// cyan</span>
00577     colors[7] = wxColour(255, 255, 255);                       <span class="comment">// white</span>
00578     colors[8] = wxColour(0, 0, 0);                             <span class="comment">// black</span>
00579     colors[9] = wxColour(255, 0, 0);                           <span class="comment">// red</span>
00580     colors[10] = wxColour(0, 255, 0);                          <span class="comment">// green</span>
00581     colors[11] = wxColour(255, 0, 255);                        <span class="comment">// yellow</span>
00582     colors[12] = wxColour(0, 0, 255);                          <span class="comment">// blue</span>
00583     colors[13] = wxColour(255, 255, 0);                        <span class="comment">// magenta</span>
00584     colors[14] = wxColour(0, 255, 255);                        <span class="comment">// cyan</span>
00585     colors[15] = wxColour(255, 255, 255);                      <span class="comment">// white</span>
00586   }
00587   <span class="keywordflow">else</span>
00588   {
00589     colors[0] = wxColour(0, 0, 0);                             <span class="comment">// black</span>
00590     colors[1] = wxColour(170, 0, 0);                           <span class="comment">// red</span>
00591     colors[2] = wxColour(0, 170, 0);                           <span class="comment">// green</span>
00592     colors[3] = wxColour(170, 0, 170);                         <span class="comment">// yellow</span>
00593     colors[4] = wxColour(0, 0, 170);                           <span class="comment">// blue</span>
00594     colors[5] = wxColour(170, 170, 0);                         <span class="comment">// magenta</span>
00595     colors[6] = wxColour(0, 170, 170);                         <span class="comment">// cyan</span>
00596     colors[7] = wxColour(192, 192, 192);                       <span class="comment">// white</span>
00597 <span class="comment">//    colors[7] = wxColour(170, 170, 170);                       // white</span>
00598 <span class="preprocessor">#if 0</span>
00599 <span class="preprocessor"></span>    colors[8] = wxColour(85, 85, 85);                          <span class="comment">// bold black</span>
00600     colors[9] = wxColour(255, 85, 85);                         <span class="comment">// bold red</span>
00601     colors[10] = wxColour(85, 255, 85);                        <span class="comment">// bold green</span>
00602     colors[11] = wxColour(255, 85, 255);                       <span class="comment">// bold yellow</span>
00603     colors[12] = wxColour(85, 85, 255);                        <span class="comment">// bold blue</span>
00604     colors[13] = wxColour(255, 255, 85);                       <span class="comment">// bold magenta</span>
00605     colors[14] = wxColour(85, 255, 255);                       <span class="comment">// bold cyan</span>
00606     colors[15] = wxColour(255, 255, 255);                      <span class="comment">// bold white</span>
00607 <span class="preprocessor">#else</span>
00608 <span class="preprocessor"></span>    colors[8] = wxColour(85, 85, 85);                          <span class="comment">// bold black</span>
00609     colors[9] = wxColour(255, 0, 0);                         <span class="comment">// bold red</span>
00610     colors[10] = wxColour(0, 255, 0);                        <span class="comment">// bold green</span>
00611     colors[11] = wxColour(255, 0, 255);                       <span class="comment">// bold yellow</span>
00612     colors[12] = wxColour(0, 0, 255);                        <span class="comment">// bold blue</span>
00613     colors[13] = wxColour(255, 255, 0);                       <span class="comment">// bold magenta</span>
00614     colors[14] = wxColour(0, 255, 255);                       <span class="comment">// bold cyan</span>
00615     colors[15] = wxColour(255, 255, 255);                      <span class="comment">// bold white</span>
00616 <span class="preprocessor">#endif    </span>
00617 <span class="preprocessor"></span>  }
00618 }
00619 
00630 <span class="keywordtype">void</span>
<a name="l00631"></a><a class="code" href="classwx_term.html#a4">00631</a> <a class="code" href="classwx_term.html#a4">wxTerm::GetVTColors</a>(wxColour colors[16])
00632 {
00633   <span class="keywordtype">int</span>
00634     i;
00635 
00636   <span class="keywordflow">for</span>(i = 0; i &lt; 16; i++)
00637     colors[i] = <a class="code" href="classwx_term.html#r24">m_vt_colors</a>[i];
00638 }
00639 
00650 <span class="keywordtype">void</span>
<a name="l00651"></a><a class="code" href="classwx_term.html#a5">00651</a> <a class="code" href="classwx_term.html#a5">wxTerm::SetVTColors</a>(wxColour colors[16])
00652 {
00653   <span class="keywordtype">int</span>
00654     i;
00655 
00656   <a class="code" href="classwx_term.html#r2">m_init</a> = 1;
00657   <span class="keywordflow">for</span>(i = 0; i &lt; 16; i++)
00658     <a class="code" href="classwx_term.html#r24">m_vt_colors</a>[i] = colors[i];
00659 
00660   <span class="keywordflow">if</span>(!(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC))
00661     SetBackgroundColour(<a class="code" href="classwx_term.html#r24">m_vt_colors</a>[0]);
00662 
00663   <span class="keywordflow">for</span>(i = 0; i &lt; 16; i++)
00664     <a class="code" href="classwx_term.html#r27">m_vt_colorPens</a>[i] = wxPen(<a class="code" href="classwx_term.html#r24">m_vt_colors</a>[i], 1, wxSOLID);
00665   <a class="code" href="classwx_term.html#r2">m_init</a> = 0;
00666 
00667   Refresh();
00668 }
00669 
00680 <span class="keywordtype">void</span>
<a name="l00681"></a><a class="code" href="classwx_term.html#a6">00681</a> <a class="code" href="classwx_term.html#a6">wxTerm::GetDefPCColors</a>(wxColour colors[16])
00682 {
00683 <span class="preprocessor">#if 0</span>
00684 <span class="preprocessor"></span>  <span class="comment">/*</span>
00685 <span class="comment">  **  These colors need tweaking.  I'm sure they are not correct.</span>
00686 <span class="comment">  */</span>
00687   colors[0] = wxColour(0, 0, 0);                             <span class="comment">// black</span>
00688   colors[1] = wxColour(0, 0, 128);                           <span class="comment">// blue</span>
00689   colors[2] = wxColour(0, 128, 0);                           <span class="comment">// green</span>
00690   colors[3] = wxColour(0, 128, 128);                         <span class="comment">// cyan</span>
00691   colors[4] = wxColour(128, 0, 0);                           <span class="comment">// red</span>
00692   colors[5] = wxColour(128, 0, 128);                         <span class="comment">// magenta</span>
00693   colors[6] = wxColour(128, 128, 0);                         <span class="comment">// brown</span>
00694   colors[7] = wxColour(128, 128, 128);                       <span class="comment">// white</span>
00695   colors[8] = wxColour(64, 64, 64);                          <span class="comment">// gray</span>
00696   colors[9] = wxColour(0, 0, 255);                           <span class="comment">// lt blue</span>
00697   colors[10] = wxColour(0, 255, 0);                          <span class="comment">// lt green</span>
00698   colors[11] = wxColour(0, 255, 255);                        <span class="comment">// lt cyan</span>
00699   colors[12] = wxColour(255, 0, 0);                          <span class="comment">// lt red</span>
00700   colors[13] = wxColour(255, 0, 255);                        <span class="comment">// lt magenta</span>
00701   colors[14] = wxColour(255, 255, 0);                        <span class="comment">// yellow</span>
00702   colors[15] = wxColour(255, 255, 255);                      <span class="comment">// white</span>
00703 <span class="preprocessor">#else</span>
00704 <span class="preprocessor"></span>  <span class="comment">/*</span>
00705 <span class="comment">  **  These are much better</span>
00706 <span class="comment">  */</span>
00707   colors[0] = wxColour(0, 0, 0);                             <span class="comment">// black</span>
00708   colors[1] = wxColour(0, 0, 170);                           <span class="comment">// blue</span>
00709   colors[2] = wxColour(0, 170, 0);                           <span class="comment">// green</span>
00710   colors[3] = wxColour(0, 170, 170);                         <span class="comment">// cyan</span>
00711   colors[4] = wxColour(170, 0, 0);                           <span class="comment">// red</span>
00712   colors[5] = wxColour(170, 0, 170);                         <span class="comment">// magenta</span>
00713   colors[6] = wxColour(170, 170, 0);                         <span class="comment">// brown</span>
00714   colors[7] = wxColour(170, 170, 170);                       <span class="comment">// white</span>
00715 <span class="preprocessor">#if 0</span>
00716 <span class="preprocessor"></span>  colors[8] = wxColour(85, 85, 85);                          <span class="comment">// gray</span>
00717   colors[9] = wxColour(85, 85, 255);                         <span class="comment">// lt blue</span>
00718   colors[10] = wxColour(85, 255, 85);                        <span class="comment">// lt green</span>
00719   colors[11] = wxColour(85, 255, 255);                       <span class="comment">// lt cyan</span>
00720   colors[12] = wxColour(255, 85, 85);                        <span class="comment">// lt red</span>
00721   colors[13] = wxColour(255, 85, 255);                       <span class="comment">// lt magenta</span>
00722   colors[14] = wxColour(255, 255, 85);                       <span class="comment">// yellow</span>
00723   colors[15] = wxColour(255, 255, 255);                      <span class="comment">// white</span>
00724 <span class="preprocessor">#else</span>
00725 <span class="preprocessor"></span>  colors[8] = wxColour(50, 50, 50);                          <span class="comment">// gray</span>
00726   colors[9] = wxColour(0, 0, 255);                         <span class="comment">// lt blue</span>
00727   colors[10] = wxColour(0, 255, 0);                        <span class="comment">// lt green</span>
00728   colors[11] = wxColour(0, 255, 255);                       <span class="comment">// lt cyan</span>
00729   colors[12] = wxColour(255, 0, 0);                        <span class="comment">// lt red</span>
00730   colors[13] = wxColour(255, 0, 255);                       <span class="comment">// lt magenta</span>
00731   colors[14] = wxColour(255, 255, 0);                       <span class="comment">// yellow</span>
00732   colors[15] = wxColour(255, 255, 255);                      <span class="comment">// white</span>
00733 <span class="preprocessor">#endif  </span>
00734 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00735 <span class="preprocessor"></span>}
00736 
00747 <span class="keywordtype">void</span>
<a name="l00748"></a><a class="code" href="classwx_term.html#a7">00748</a> <a class="code" href="classwx_term.html#a7">wxTerm::GetPCColors</a>(wxColour colors[16])
00749 {
00750   <span class="keywordtype">int</span>
00751     i;
00752 
00753   <span class="keywordflow">for</span>(i = 0; i &lt; 16; i++)
00754     colors[i] = <a class="code" href="classwx_term.html#r25">m_pc_colors</a>[i];
00755 }
00756 
00767 <span class="keywordtype">void</span>
<a name="l00768"></a><a class="code" href="classwx_term.html#a8">00768</a> <a class="code" href="classwx_term.html#a8">wxTerm::SetPCColors</a>(wxColour colors[16])
00769 {
00770   <span class="keywordtype">int</span>
00771     i;
00772 
00773   <a class="code" href="classwx_term.html#r2">m_init</a> = 1;
00774   <span class="keywordflow">for</span>(i = 0; i &lt; 16; i++)
00775     <a class="code" href="classwx_term.html#r25">m_pc_colors</a>[i] = colors[i];
00776 
00777   <span class="keywordflow">if</span>(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC)
00778     SetBackgroundColour(<a class="code" href="classwx_term.html#r25">m_pc_colors</a>[0]);
00779 
00780   <span class="keywordflow">for</span>(i = 0; i &lt; 16; i++)
00781     <a class="code" href="classwx_term.html#r28">m_pc_colorPens</a>[i] = wxPen(<a class="code" href="classwx_term.html#r25">m_pc_colors</a>[i], 1, wxSOLID);
00782   <a class="code" href="classwx_term.html#r2">m_init</a> = 0;
00783 
00784   Refresh();
00785 }
00786 
00797 <span class="keywordtype">void</span>
<a name="l00798"></a><a class="code" href="classwx_term.html#a10">00798</a> <a class="code" href="classwx_term.html#a10">wxTerm::SetCursorBlinkRate</a>(<span class="keywordtype">int</span> rate)
00799 {
00800   <span class="keywordflow">if</span>(rate &lt; 0 || rate &gt; <a class="code" href="wxterm_8cpp.html#a1">CURSOR_BLINK_MAX_TIMEOUT</a>)
00801     <span class="keywordflow">return</span>;
00802 
00803   <a class="code" href="classwx_term.html#r2">m_init</a> = 1;
00804   <span class="keywordflow">if</span>(rate != <a class="code" href="classwx_term.html#r15">m_curBlinkRate</a>)
00805   {
00806     <a class="code" href="classwx_term.html#r15">m_curBlinkRate</a> = rate;
00807     <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r15">m_curBlinkRate</a>)
00808       <a class="code" href="classwx_term.html#r39">m_timer</a>.Stop();
00809     <span class="keywordflow">else</span>
00810       <a class="code" href="classwx_term.html#r39">m_timer</a>.Start(<a class="code" href="classwx_term.html#r15">m_curBlinkRate</a>);
00811   }
00812   <a class="code" href="classwx_term.html#r2">m_init</a> = 0;
00813 }
00814 
00825 <span class="keywordtype">void</span>
<a name="l00826"></a><a class="code" href="classwx_term.html#d3">00826</a> <a class="code" href="classwx_term.html#d3">wxTerm::OnChar</a>(wxKeyEvent&amp; event)
00827 {
00828   <span class="keywordflow">if</span>(!(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC) &amp;&amp; event.AltDown())
00829     event.Skip();
00830   <span class="keywordflow">else</span>
00831   {
00832       <span class="comment">// if the user is scrolled up and they typed something, scroll</span>
00833       <span class="comment">// all the way to the bottom</span>
00834       <span class="keywordflow">if</span>(<a class="code" href="class_g_term.html#a18">GTerm::IsScrolledUp</a>())
00835       {
00836           <a class="code" href="class_g_term.html#a11">GTerm::Scroll</a>(<a class="code" href="gterm_8hpp.html#a1">MAXHEIGHT</a>, <span class="keyword">false</span>);
00837           <a class="code" href="class_g_term.html#a8">GTerm::Update</a>();
00838           Refresh();
00839       }
00840 
00841     <span class="keywordtype">int</span>
00842       rc,
00843       keyCode = 0,
00844       len;
00845 
00846     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>
00847       buf[10];
00848 
00849     <span class="comment">/*</span>
00850 <span class="comment">    **  Map control characters</span>
00851 <span class="comment">    */</span>
00852     <span class="keywordflow">if</span>(event.ControlDown())
00853     {
00854       <span class="keywordflow">if</span>(event.GetKeyCode() &gt;= <span class="charliteral">'a'</span> &amp;&amp; event.GetKeyCode() &lt;= <span class="charliteral">'z'</span>)
00855         keyCode = event.GetKeyCode() - <span class="charliteral">'a'</span> + 1;
00856       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(event.GetKeyCode() &gt;= <span class="charliteral">'['</span> &amp;&amp; event.GetKeyCode() &lt;= <span class="charliteral">'_'</span>)
00857         keyCode = event.GetKeyCode() - <span class="charliteral">'['</span> + 0x1b;
00858       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(event.GetKeyCode() == <span class="charliteral">'6'</span>)
00859         keyCode = 0x1e;
00860       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(event.GetKeyCode() == <span class="charliteral">'-'</span>)
00861         keyCode = 0x1f;
00862     }
00863     
00864     <span class="keywordflow">if</span>(!keyCode &amp;&amp; !(keyCode = <a class="code" href="classwx_term.html#d0">MapKeyCode</a>((<span class="keywordtype">int</span>)event.GetKeyCode())))
00865     {
00866       <span class="comment">/*</span>
00867 <span class="comment">      **  If the keycode wasn't mapped in the table and it is a special</span>
00868 <span class="comment">      **  key, then we just ignore it.</span>
00869 <span class="comment">      */</span>
00870       <span class="keywordflow">if</span>(event.GetKeyCode() &gt;= WXK_START)
00871       {
00872         event.Skip();
00873         <span class="keywordflow">return</span>;
00874       }
00875       <span class="comment">/*</span>
00876 <span class="comment">      **  Otherwise, it must just be an ascii character</span>
00877 <span class="comment">      */</span>
00878       keyCode = (<span class="keywordtype">int</span>)event.GetKeyCode();
00879     }
00880 
00881     <span class="keywordflow">if</span>(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC)
00882       rc = <a class="code" href="class_g_term.html#a32">TranslateKeyCode</a>(keyCode, &amp;len, (<span class="keywordtype">char</span> *)buf, event.ShiftDown(),
00883                         event.ControlDown(), event.AltDown());
00884     <span class="keywordflow">else</span>
00885       rc = <a class="code" href="class_g_term.html#a32">TranslateKeyCode</a>(keyCode, &amp;len, (<span class="keywordtype">char</span> *)buf);
00886 
00887     <span class="keywordflow">if</span>(rc)
00888     {
00889       <span class="keywordflow">if</span>((<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; NEWLINE) &amp;&amp; !(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC) &amp;&amp; (buf[len - 1] == 10))
00890       {
00891         buf[len - 1] = 13;
00892         buf[len] = 10;
00893         len++;
00894       }
00895       <a class="code" href="class_g_term.html#a3">ProcessOutput</a>(len, buf);
00896       <span class="keywordflow">if</span>((<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; LOCALECHO) &amp;&amp; !(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC))
00897         <a class="code" href="classwx_term.html#a27">ProcessInput</a>(len, buf);
00898     }
00899     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC))
00900     {
00901       <span class="keywordflow">if</span>((<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; NEWLINE) &amp;&amp; !(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC) &amp;&amp; (keyCode == 10))
00902       {
00903         len = 2;
00904         buf[0] = 13;
00905         buf[1] = keyCode;
00906       }
00907       <span class="keywordflow">else</span>
00908       {
00909         len = 1;
00910         buf[0] = keyCode;
00911       }
00912       <a class="code" href="class_g_term.html#a3">ProcessOutput</a>(len, buf);
00913       <span class="keywordflow">if</span>((<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; LOCALECHO) &amp;&amp; !(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC))
00914         <a class="code" href="classwx_term.html#a27">ProcessInput</a>(len, buf);
00915     }
00916     <span class="keywordflow">else</span>
00917       event.Skip();
00918   }
00919 }
00920 
00931 <span class="keywordtype">void</span>
<a name="l00932"></a><a class="code" href="classwx_term.html#d4">00932</a> <a class="code" href="classwx_term.html#d4">wxTerm::OnKeyDown</a>(wxKeyEvent&amp; event)
00933 {
00934   <span class="keywordflow">if</span>(!(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; PC) &amp;&amp; event.AltDown())
00935     event.Skip();
00936   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(event.AltDown())
00937   {
00938 <span class="comment">//    wxLogMessage("OnKeyDown() got KeyCode = %d", event.KeyCode());</span>
00939 <span class="comment">//    if(event.KeyCode() != 309)</span>
00940 <span class="comment">//      OnChar(event);</span>
00941   }
00942   <span class="keywordflow">else</span>
00943     event.Skip();
00944 }
00945 
00956 <span class="keywordtype">void</span>
00957 <a class="code" href="classwx_term.html#d5">wxTerm::OnPaint</a>(wxPaintEvent&amp; WXUNUSED(event))
00958 {
00959   wxPaintDC
00960     dc(<span class="keyword">this</span>);
00961 
00962   m_curDC = &amp;dc;
00963   <a class="code" href="class_g_term.html#a9">ExposeArea</a>(0, 0, m_width, m_height);
00964   m_curDC = 0;
00965 }
00966 
00977 <span class="keywordtype">void</span>
<a name="l00978"></a><a class="code" href="classwx_term.html#d6">00978</a> <a class="code" href="classwx_term.html#d6">wxTerm::OnLeftDown</a>(wxMouseEvent&amp; event)
00979 {
00980     
00981   <a class="code" href="classwx_term.html#a14">ClearSelection</a>();
00982   <a class="code" href="classwx_term.html#r5">m_selx1</a> = <a class="code" href="classwx_term.html#r7">m_selx2</a> = event.GetX() / <a class="code" href="classwx_term.html#r0">m_charWidth</a>;
00983   <a class="code" href="classwx_term.html#r6">m_sely1</a> = <a class="code" href="classwx_term.html#r8">m_sely2</a> = event.GetY() / <a class="code" href="classwx_term.html#r1">m_charHeight</a>;
00984   <a class="code" href="classwx_term.html#r20">m_selecting</a> = TRUE;
00985   CaptureMouse();
00986   
00987 }
00988 
00999 <span class="keywordtype">void</span>
<a name="l01000"></a><a class="code" href="classwx_term.html#d7">01000</a> <a class="code" href="classwx_term.html#d7">wxTerm::OnLeftUp</a>(wxMouseEvent&amp; event)
01001 {
01002     
01003   <a class="code" href="classwx_term.html#r20">m_selecting</a> = FALSE;
01004   <span class="keywordflow">if</span>(GetCapture() == <span class="keyword">this</span>)
01005   {
01006     ReleaseMouse();
01007   }
01008   
01009   
01010 }
01011 
01022 <span class="keywordtype">void</span>
<a name="l01023"></a><a class="code" href="classwx_term.html#d8">01023</a> <a class="code" href="classwx_term.html#d8">wxTerm::OnMouseMove</a>(wxMouseEvent&amp; event)
01024 {
01025   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r20">m_selecting</a>)
01026   {
01027     <a class="code" href="classwx_term.html#r7">m_selx2</a> = event.GetX() / <a class="code" href="classwx_term.html#r0">m_charWidth</a>;
01028     <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r7">m_selx2</a> &gt;= <a class="code" href="class_g_term.html#a5">Width</a>())
01029       <a class="code" href="classwx_term.html#r7">m_selx2</a> = <a class="code" href="class_g_term.html#a5">Width</a>() - 1;
01030     <a class="code" href="classwx_term.html#r8">m_sely2</a> = event.GetY() / <a class="code" href="classwx_term.html#r1">m_charHeight</a>;
01031     <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r8">m_sely2</a> &gt;= <a class="code" href="class_g_term.html#a6">Height</a>())
01032       <a class="code" href="classwx_term.html#r8">m_sely2</a> = <a class="code" href="class_g_term.html#a6">Height</a>() - 1;
01033 
01034     <a class="code" href="classwx_term.html#d1">MarkSelection</a>();
01035   }
01036 }
01037 
01046 <span class="keywordtype">void</span>
<a name="l01047"></a><a class="code" href="classwx_term.html#a14">01047</a> <a class="code" href="classwx_term.html#a14">wxTerm::ClearSelection</a>()
01048 {
01049   <span class="keywordtype">int</span>
01050     x,
01051     y;
01052 
01053   wxClientDC
01054     *dc = 0;
01055 
01056   <a class="code" href="classwx_term.html#r5">m_selx1</a> = <a class="code" href="classwx_term.html#r6">m_sely1</a> = <a class="code" href="classwx_term.html#r7">m_selx2</a> = <a class="code" href="classwx_term.html#r8">m_sely2</a> = 0;
01057 
01058   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r34">m_curDC</a>)
01059   {
01060     dc = <span class="keyword">new</span> wxClientDC(<span class="keyword">this</span>);
01061     <a class="code" href="classwx_term.html#r34">m_curDC</a> = dc;
01062   }
01063 
01064   <span class="keywordflow">for</span>(y = 0; y &lt; <a class="code" href="class_g_term.html#a6">Height</a>(); y++)
01065     <span class="keywordflow">for</span>(x = 0; x &lt; <a class="code" href="class_g_term.html#a5">Width</a>(); x++)
01066       <a class="code" href="class_g_term.html#a38">Select</a>(x, y, 0);
01067 
01068   <span class="keywordflow">if</span>(dc)
01069   {
01070       this-&gt;wxWindow::Update();
01071       
01072     <a class="code" href="classwx_term.html#r34">m_curDC</a> = 0;
01073     <span class="keyword">delete</span> dc;
01074   }
01075 }
01076 
01085 <span class="keywordtype">void</span>
<a name="l01086"></a><a class="code" href="classwx_term.html#d1">01086</a> <a class="code" href="classwx_term.html#d1">wxTerm::MarkSelection</a>()
01087 {
01088   <span class="keywordtype">int</span>
01089     x,
01090     y;
01091 
01092   wxClientDC
01093     *dc = 0;
01094 
01095   <a class="code" href="classwx_term.html#r21">m_marking</a> = TRUE;
01096 
01097   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r34">m_curDC</a>)
01098   {
01099     dc = <span class="keyword">new</span> wxClientDC(<span class="keyword">this</span>);
01100     <a class="code" href="classwx_term.html#r34">m_curDC</a> = dc;
01101   }
01102 
01103   <span class="keywordflow">for</span>(y = 0; y &lt; <a class="code" href="class_g_term.html#a6">Height</a>(); y++)
01104     <span class="keywordflow">for</span>(x = 0; x &lt; <a class="code" href="class_g_term.html#a5">Width</a>(); x++)
01105       <a class="code" href="class_g_term.html#a38">Select</a>(x, y, 0);
01106 
01107   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r6">m_sely1</a> == <a class="code" href="classwx_term.html#r8">m_sely2</a>)
01108   {
01109     <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r5">m_selx1</a> &gt;= <a class="code" href="classwx_term.html#r7">m_selx2</a>)
01110       <span class="keywordflow">for</span>(x = <a class="code" href="classwx_term.html#r5">m_selx1</a>; x &lt;= <a class="code" href="classwx_term.html#r7">m_selx2</a>; x++)
01111         <a class="code" href="class_g_term.html#a38">Select</a>(x, <a class="code" href="classwx_term.html#r6">m_sely1</a>, 1);
01112     <span class="keywordflow">else</span>
01113       <span class="keywordflow">for</span>(x = m_selx2; x &gt;= m_selx1; x--)
01114         <a class="code" href="class_g_term.html#a38">Select</a>(x, <a class="code" href="classwx_term.html#r6">m_sely1</a>, 1);
01115   }
01116   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r6">m_sely1</a> &lt; <a class="code" href="classwx_term.html#r8">m_sely2</a>)
01117   {
01118     <span class="keywordflow">for</span>(x = <a class="code" href="classwx_term.html#r5">m_selx1</a>; x &lt; <a class="code" href="class_g_term.html#a5">Width</a>(); x++)
01119       <a class="code" href="class_g_term.html#a38">Select</a>(x, <a class="code" href="classwx_term.html#r6">m_sely1</a>, 1);
01120 
01121     <span class="keywordflow">for</span>(y = <a class="code" href="classwx_term.html#r6">m_sely1</a> + 1; y &lt; <a class="code" href="classwx_term.html#r8">m_sely2</a>; y++)
01122       <span class="keywordflow">for</span>(x = 0; x &lt; <a class="code" href="class_g_term.html#a5">Width</a>(); x++)
01123         <a class="code" href="class_g_term.html#a38">Select</a>(x, y, 1);
01124 
01125     <span class="keywordflow">for</span>(x = 0; x &lt;= <a class="code" href="classwx_term.html#r7">m_selx2</a>; x++)
01126       <a class="code" href="class_g_term.html#a38">Select</a>(x, m_sely2, 1);
01127   }
01128   <span class="keywordflow">else</span>
01129   {
01130     <span class="keywordflow">for</span>(x = 0; x &lt;= <a class="code" href="classwx_term.html#r5">m_selx1</a>; x++)
01131       <a class="code" href="class_g_term.html#a38">Select</a>(x, <a class="code" href="classwx_term.html#r6">m_sely1</a>, 1);
01132 
01133     <span class="keywordflow">for</span>(y = <a class="code" href="classwx_term.html#r8">m_sely2</a> + 1; y &lt; <a class="code" href="classwx_term.html#r6">m_sely1</a>; y++)
01134       <span class="keywordflow">for</span>(x = 0; x &lt; <a class="code" href="class_g_term.html#a5">Width</a>(); x++)
01135         <a class="code" href="class_g_term.html#a38">Select</a>(x, y, 1);
01136 
01137     <span class="keywordflow">for</span>(x = <a class="code" href="classwx_term.html#r7">m_selx2</a>; x &lt; <a class="code" href="class_g_term.html#a5">Width</a>(); x++)
01138       <a class="code" href="class_g_term.html#a38">Select</a>(x, <a class="code" href="classwx_term.html#r8">m_sely2</a>, 1);
01139   }
01140 
01141   this-&gt;wxWindow::Update();
01142 
01143   <span class="keywordflow">if</span>(dc)
01144   {
01145     <a class="code" href="classwx_term.html#r34">m_curDC</a> = 0;
01146     <span class="keyword">delete</span> dc;
01147   }
01148 
01149   <a class="code" href="classwx_term.html#r21">m_marking</a> = FALSE;
01150 }
01151 
01160 <span class="keywordtype">bool</span>
<a name="l01161"></a><a class="code" href="classwx_term.html#a15">01161</a> <a class="code" href="classwx_term.html#a15">wxTerm::HasSelection</a>()
01162 {
01163   <span class="keywordflow">return</span>(<a class="code" href="classwx_term.html#r5">m_selx1</a> != <a class="code" href="classwx_term.html#r7">m_selx2</a> || <a class="code" href="classwx_term.html#r6">m_sely1</a> != <a class="code" href="classwx_term.html#r8">m_sely2</a>);
01164 }
01165 
01166 wxString
<a name="l01175"></a><a class="code" href="classwx_term.html#a16">01175</a> <a class="code" href="classwx_term.html#a16">wxTerm::GetSelection</a>()
01176 {
01177   <span class="keywordtype">int</span>
01178     x1,
01179     y1,
01180     x2,
01181     y2;
01182 
01183   wxString
01184     sel;
01185 
01186   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r6">m_sely1</a> &lt;= <a class="code" href="classwx_term.html#r8">m_sely2</a>)
01187   {
01188     x1 = <a class="code" href="classwx_term.html#r5">m_selx1</a>;
01189     y1 = <a class="code" href="classwx_term.html#r6">m_sely1</a>;
01190     x2 = <a class="code" href="classwx_term.html#r7">m_selx2</a>;
01191     y2 = <a class="code" href="classwx_term.html#r8">m_sely2</a>;
01192   }
01193   <span class="keywordflow">else</span>
01194   {
01195     x1 = <a class="code" href="classwx_term.html#r7">m_selx2</a>;
01196     y1 = <a class="code" href="classwx_term.html#r8">m_sely2</a>;
01197     x2 = <a class="code" href="classwx_term.html#r5">m_selx1</a>;
01198     y2 = <a class="code" href="classwx_term.html#r6">m_sely1</a>;
01199   }
01200 
01201   <span class="keywordflow">while</span>(x1 != x2 || y1 != y2)
01202   {
01203     <span class="keywordflow">if</span>(<a class="code" href="class_g_term.html#a39">GetChar</a>(x1, y1))
01204       sel.Append(<a class="code" href="class_g_term.html#a39">GetChar</a>(x1, y1));
01205 
01206     x1++;
01207     <span class="keywordflow">if</span>(x1 == <a class="code" href="class_g_term.html#a5">Width</a>())
01208     {
01209       sel.Append(<span class="charliteral">'\n'</span>);
01210       x1 = 0;
01211       y1++;
01212     }
01213   }
01214   <span class="keywordflow">if</span>(<a class="code" href="class_g_term.html#a39">GetChar</a>(x1, y1))
01215     sel.Append(<a class="code" href="class_g_term.html#a39">GetChar</a>(x1, y1));
01216 
01217   <span class="keywordflow">return</span> sel;
01218 }
01219 
01228 <span class="keywordtype">void</span>
<a name="l01229"></a><a class="code" href="classwx_term.html#a17">01229</a> <a class="code" href="classwx_term.html#a17">wxTerm::SelectAll</a>()
01230 {
01231   <a class="code" href="classwx_term.html#r5">m_selx1</a> = 0;
01232   <a class="code" href="classwx_term.html#r6">m_sely1</a> = 0;
01233   <a class="code" href="classwx_term.html#r7">m_selx2</a> = <a class="code" href="class_g_term.html#a5">Width</a>() - 1;
01234   <a class="code" href="classwx_term.html#r8">m_sely2</a> = <a class="code" href="class_g_term.html#a6">Height</a>() - 1;
01235   <a class="code" href="classwx_term.html#d1">MarkSelection</a>();
01236 }
01237 
01238 <span class="comment">/*</span>
01239 <span class="comment">**  GTelnet stuff</span>
01240 <span class="comment">*/</span>
01258 <span class="keywordtype">void</span>
<a name="l01259"></a><a class="code" href="classwx_term.html#a19">01259</a> <a class="code" href="classwx_term.html#a19">wxTerm::DrawText</a>(<span class="keywordtype">int</span> fg_color, <span class="keywordtype">int</span> bg_color, <span class="keywordtype">int</span> flags,
01260                  <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> len, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *string)
01261 {
01262   <span class="keywordtype">int</span>
01263     t;
01264 
01265   <span class="keywordflow">if</span>(flags &amp; BOLD &amp;&amp; <a class="code" href="classwx_term.html#r40">m_boldStyle</a> == <a class="code" href="classwx_term.html#w4w1">COLOR</a>)
01266     fg_color = (fg_color % 8) + 8;
01267 
01268   <span class="keywordflow">if</span>(flags &amp; SELECTED)
01269   {
01270     fg_color = 0;
01271     bg_color = 15;
01272   }
01273 
01274   <span class="keywordflow">if</span>(flags &amp; INVERSE)
01275   {
01276     t = fg_color;
01277     fg_color = bg_color;
01278     bg_color = t;
01279   }
01280 
01281   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r34">m_curDC</a>)
01282     <span class="keywordflow">return</span>;
01283 
01284 <span class="preprocessor">#if defined(__WXGTK__) || defined(__WXMOTIF__)</span>
01285 <span class="preprocessor"></span>  <span class="keywordtype">int</span>
01286     i;
01287 
01288   <span class="keywordflow">for</span>(i = 0; string[i]; i++)
01289     string[i] = xCharMap[string[i]];
01290 <span class="preprocessor">#endif</span>
01291 <span class="preprocessor"></span>
01292   wxString
01293     str(string, len);
01294 
01295   <span class="keywordflow">if</span>(m_boldStyle != <a class="code" href="classwx_term.html#w4w3">FONT</a>)
01296   {
01297     <span class="keywordflow">if</span>(flags &amp; UNDERLINE)
01298       <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r31">m_underlinedFont</a>);
01299     <span class="keywordflow">else</span>
01300       <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r30">m_normalFont</a>);
01301   }
01302   <span class="keywordflow">else</span>
01303   {
01304     <span class="keywordflow">if</span>(flags &amp; BOLD)
01305     {
01306       <span class="keywordflow">if</span>(flags &amp; UNDERLINE)
01307         <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r33">m_boldUnderlinedFont</a>);
01308       <span class="keywordflow">else</span>
01309         <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r32">m_boldFont</a>);
01310     }
01311     <span class="keywordflow">else</span>
01312     {
01313       <span class="keywordflow">if</span>(flags &amp; UNDERLINE)
01314         <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r31">m_underlinedFont</a>);
01315       <span class="keywordflow">else</span>
01316         <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r30">m_normalFont</a>);
01317     }
01318   }
01319 
01320   x = x * <a class="code" href="classwx_term.html#r0">m_charWidth</a>;
01321   y = y * <a class="code" href="classwx_term.html#r1">m_charHeight</a>;
01322   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetBackgroundMode(wxSOLID);
01323   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetTextBackground(<a class="code" href="classwx_term.html#r26">m_colors</a>[bg_color]);
01324   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetTextForeground(<a class="code" href="classwx_term.html#r26">m_colors</a>[fg_color]);
01325   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;DrawText(str, x, y);
01326   <span class="keywordflow">if</span>(flags &amp; BOLD &amp;&amp; m_boldStyle == <a class="code" href="classwx_term.html#w4w2">OVERSTRIKE</a>)
01327     <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;DrawText(str, x + 1, y);
01328 }
01329 
01345 <span class="keywordtype">void</span>
<a name="l01346"></a><a class="code" href="classwx_term.html#d2">01346</a> <a class="code" href="classwx_term.html#d2">wxTerm::DoDrawCursor</a>(<span class="keywordtype">int</span> fg_color, <span class="keywordtype">int</span> bg_color, <span class="keywordtype">int</span> flags,
01347                    <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c)
01348 {
01349     <span class="keywordflow">if</span>(<a class="code" href="class_g_term.html#a18">GTerm::IsScrolledUp</a>())
01350     {
01351         <span class="keywordflow">return</span>;
01352     }
01353   <span class="keywordtype">int</span>
01354     t;
01355 
01356   <span class="keywordflow">if</span>(flags &amp; BOLD &amp;&amp; <a class="code" href="classwx_term.html#r40">m_boldStyle</a> == <a class="code" href="classwx_term.html#w4w1">COLOR</a>)
01357     fg_color = (fg_color % 8) + 8;
01358 
01359   <span class="keywordflow">if</span>(flags &amp; INVERSE)
01360   {
01361     t = fg_color;
01362     fg_color = bg_color;
01363     bg_color = t;
01364   }
01365 
01366   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r34">m_curDC</a>)
01367     <span class="keywordflow">return</span>;
01368 
01369 <span class="preprocessor">#if defined(__WXGTK__) || defined(__WXMOTIF__)</span>
01370 <span class="preprocessor"></span>  c = xCharMap[c];
01371 <span class="preprocessor">#endif</span>
01372 <span class="preprocessor"></span>
01373   wxString
01374     str((<span class="keywordtype">char</span>)c);
01375 
01376   <span class="keywordflow">if</span>(m_boldStyle != <a class="code" href="classwx_term.html#w4w3">FONT</a>)
01377   {
01378     <span class="keywordflow">if</span>(flags &amp; UNDERLINE)
01379       <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r31">m_underlinedFont</a>);
01380     <span class="keywordflow">else</span>
01381       <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r30">m_normalFont</a>);
01382   }
01383   <span class="keywordflow">else</span>
01384   {
01385     <span class="keywordflow">if</span>(flags &amp; BOLD)
01386     {
01387       <span class="keywordflow">if</span>(flags &amp; UNDERLINE)
01388         <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r33">m_boldUnderlinedFont</a>);
01389       <span class="keywordflow">else</span>
01390         <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r32">m_boldFont</a>);
01391     }
01392     <span class="keywordflow">else</span>
01393     {
01394       <span class="keywordflow">if</span>(flags &amp; UNDERLINE)
01395         <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r31">m_underlinedFont</a>);
01396       <span class="keywordflow">else</span>
01397         <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetFont(<a class="code" href="classwx_term.html#r30">m_normalFont</a>);
01398     }
01399   }
01400 
01401   x = x * <a class="code" href="classwx_term.html#r0">m_charWidth</a>;
01402   y = y * <a class="code" href="classwx_term.html#r1">m_charHeight</a>;
01403   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetBackgroundMode(wxSOLID);
01404   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetTextBackground(<a class="code" href="classwx_term.html#r26">m_colors</a>[fg_color]);
01405   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetTextForeground(<a class="code" href="classwx_term.html#r26">m_colors</a>[bg_color]);
01406   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;DrawText(str, x, y);
01407   <span class="keywordflow">if</span>(flags &amp; BOLD &amp;&amp; m_boldStyle == <a class="code" href="classwx_term.html#w4w2">OVERSTRIKE</a>)
01408     <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;DrawText(str, x + 1, y);
01409 }
01410 
01427 <span class="keywordtype">void</span>
<a name="l01428"></a><a class="code" href="classwx_term.html#a20">01428</a> <a class="code" href="classwx_term.html#a20">wxTerm::DrawCursor</a>(<span class="keywordtype">int</span> fg_color, <span class="keywordtype">int</span> bg_color, <span class="keywordtype">int</span> flags,
01429                    <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c)
01430 {
01431   <a class="code" href="classwx_term.html#r9">m_curX</a> = x;
01432   <a class="code" href="classwx_term.html#r10">m_curY</a> = y;
01433   <a class="code" href="classwx_term.html#r11">m_curFG</a> = fg_color;
01434   <a class="code" href="classwx_term.html#r12">m_curBG</a> = bg_color,
01435   <a class="code" href="classwx_term.html#r13">m_curFlags</a> = flags;
01436   <a class="code" href="classwx_term.html#r19">m_curChar</a> = c;
01437 
01438 
01439 
01440   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r39">m_timer</a>.IsRunning())
01441     <a class="code" href="classwx_term.html#r39">m_timer</a>.Stop();
01442   <a class="code" href="classwx_term.html#d2">DoDrawCursor</a>(fg_color, bg_color, flags, x, y, c);
01443   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r15">m_curBlinkRate</a>)
01444   {
01445     <a class="code" href="classwx_term.html#r39">m_timer</a>.Start(<a class="code" href="classwx_term.html#r15">m_curBlinkRate</a>);
01446     <a class="code" href="classwx_term.html#r14">m_curState</a> = 1;
01447   }
01448 }
01449 
01460 <span class="keywordtype">void</span>
01461 <a class="code" href="classwx_term.html#d9">wxTerm::OnTimer</a>(wxTimerEvent&amp; WXUNUSED(event))
01462 {
01463   wxClientDC
01464     *dc = 0;
01465 
01466   <span class="keywordflow">if</span>(m_init)
01467     <span class="keywordflow">return</span>;
01468     
01469   <span class="keywordflow">if</span>(m_curX == -1 || m_curY == -1)
01470     <span class="keywordflow">return</span>;
01471     
01472   <span class="keywordflow">if</span>(<a class="code" href="class_g_term.html#a19">GetMode</a>() &amp; CURSORINVISIBLE)
01473   {
01474       <span class="comment">//wxLogDebug("Skipping cursor");</span>
01475     <span class="keywordflow">return</span>;
01476   }
01477   <span class="comment">//wxLogDebug("Drawing cursor");</span>
01478   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r34">m_curDC</a>)
01479   {
01480     dc = <span class="keyword">new</span> wxClientDC(<span class="keyword">this</span>);
01481     <a class="code" href="classwx_term.html#r34">m_curDC</a> = dc;
01482   }
01483 
01484   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r15">m_curBlinkRate</a>)
01485   {
01486     <a class="code" href="classwx_term.html#r14">m_curState</a>++;
01487     <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r14">m_curState</a> &amp; 1 &amp;&amp; <a class="code" href="classwx_term.html#r9">m_curX</a> != -1 &amp;&amp; <a class="code" href="classwx_term.html#r10">m_curY</a> != -1)
01488       <a class="code" href="classwx_term.html#d2">DoDrawCursor</a>(m_curFG, m_curBG, m_curFlags, m_curX, m_curY, m_curChar);
01489     <span class="keywordflow">else</span>
01490       <a class="code" href="classwx_term.html#d2">DoDrawCursor</a>(m_curBG, m_curFG, m_curFlags, m_curX, m_curY, m_curChar);
01491   }
01492 
01493   <span class="keywordflow">if</span>(dc)
01494   {
01495     <span class="keyword">delete</span> dc;
01496     <a class="code" href="classwx_term.html#r34">m_curDC</a> = 0;
01497   }
01498 }
01499 
01516 <span class="keywordtype">void</span>
<a name="l01517"></a><a class="code" href="classwx_term.html#a21">01517</a> <a class="code" href="classwx_term.html#a21">wxTerm::MoveChars</a>(<span class="keywordtype">int</span> sx, <span class="keywordtype">int</span> sy, <span class="keywordtype">int</span> dx, <span class="keywordtype">int</span> dy, <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h)
01518 {
01519   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r21">m_marking</a>)
01520     <a class="code" href="classwx_term.html#a14">ClearSelection</a>();
01521 
01522   sx = sx * <a class="code" href="classwx_term.html#r0">m_charWidth</a>;
01523   sy = sy * <a class="code" href="classwx_term.html#r1">m_charHeight</a>;
01524   dx = dx * m_charWidth;
01525   dy = dy * m_charHeight;
01526   w = w * m_charWidth;
01527   h = h * m_charHeight;
01528 
01529   <a class="code" href="classwx_term.html#r35">m_memDC</a>.Blit(0, 0, w, h, <a class="code" href="classwx_term.html#r34">m_curDC</a>, sx, sy);
01530   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;Blit(dx, dy, w, h, &amp;<a class="code" href="classwx_term.html#r35">m_memDC</a>, 0, 0);
01531 }
01532 
01548 <span class="keywordtype">void</span>
<a name="l01549"></a><a class="code" href="classwx_term.html#a22">01549</a> <a class="code" href="classwx_term.html#a22">wxTerm::ClearChars</a>(<span class="keywordtype">int</span> bg_color, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h)
01550 {
01551 <span class="comment">//  if(!m_marking)</span>
01552 <span class="comment">//    ClearSelection();</span>
01553 
01554   x = x * <a class="code" href="classwx_term.html#r0">m_charWidth</a>;
01555   y = y * <a class="code" href="classwx_term.html#r1">m_charHeight</a>;
01556   w = w * m_charWidth;
01557   h = h * m_charHeight;
01558 
01559   <span class="keywordtype">bool</span> deleteDC = <span class="keyword">false</span>;
01560   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r34">m_curDC</a>)
01561   {
01562       <a class="code" href="classwx_term.html#r34">m_curDC</a> = <span class="keyword">new</span> wxClientDC(<span class="keyword">this</span>);
01563       deleteDC = <span class="keyword">true</span>;
01564   }
01565   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetPen(<a class="code" href="classwx_term.html#r29">m_colorPens</a>[bg_color]);
01566   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;SetBrush(wxBrush(<a class="code" href="classwx_term.html#r26">m_colors</a>[bg_color], wxSOLID));
01567   <a class="code" href="classwx_term.html#r34">m_curDC</a>-&gt;DrawRectangle(x, y, w <span class="comment">/* + 1*/</span>, h <span class="comment">/*+ 1*/</span>);
01568 
01569   <span class="keywordflow">if</span>(deleteDC)
01570   {
01571       <span class="keyword">delete</span> <a class="code" href="classwx_term.html#r34">m_curDC</a>;
01572       <a class="code" href="classwx_term.html#r34">m_curDC</a> = 0;
01573   }
01574 }
01575 
01586 <span class="keywordtype">void</span>
<a name="l01587"></a><a class="code" href="classwx_term.html#a23">01587</a> <a class="code" href="classwx_term.html#a23">wxTerm::ModeChange</a>(<span class="keywordtype">int</span> state)
01588 {
01589   <a class="code" href="classwx_term.html#a14">ClearSelection</a>();
01590 
01591   <span class="keywordflow">if</span>(state &amp; GTelnet::PC)
01592   {
01593     <a class="code" href="classwx_term.html#r26">m_colors</a> = <a class="code" href="classwx_term.html#r25">m_pc_colors</a>;
01594     <a class="code" href="classwx_term.html#r29">m_colorPens</a> = <a class="code" href="classwx_term.html#r28">m_pc_colorPens</a>;
01595   }
01596   <span class="keywordflow">else</span>
01597   {
01598     <a class="code" href="classwx_term.html#r26">m_colors</a> = <a class="code" href="classwx_term.html#r24">m_vt_colors</a>;
01599     <a class="code" href="classwx_term.html#r29">m_colorPens</a> = <a class="code" href="classwx_term.html#r27">m_vt_colorPens</a>;
01600   }
01601   <a class="code" href="class_g_term.html">GTerm</a><span class="comment">/*lnet*/</span>::ModeChange(state);
01602 }
01603 
01612 <span class="keywordtype">void</span>
<a name="l01613"></a><a class="code" href="classwx_term.html#a24">01613</a> <a class="code" href="classwx_term.html#a24">wxTerm::Bell</a>()
01614 {
01615 <span class="preprocessor">#ifdef __WIN32__</span>
01616 <span class="preprocessor"></span>  <a class="code" href="wxterm_8cpp.html#a3">WinMessageBeep</a>();
01617 <span class="preprocessor">#else</span>
01618 <span class="preprocessor"></span>  wxBell();
01619 <span class="preprocessor">#endif</span>
01620 <span class="preprocessor"></span>}
01621 
<a name="l01630"></a><a class="code" href="classwx_term.html#a18">01630</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term.html#a18">wxTerm::UpdateSize</a>()
01631 {
01632     <span class="comment">// prevent any nasty recursion</span>
01633     <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r22">m_inUpdateSize</a>)
01634     {       
01635         <span class="keywordflow">return</span>;
01636     }
01637 
01638     <a class="code" href="classwx_term.html#r22">m_inUpdateSize</a> = <span class="keyword">true</span>;
01639     <span class="keywordtype">int</span> charWidth, charHeight;
01640 
01641     wxClientDC* dc = <span class="keyword">new</span> wxClientDC(<span class="keyword">this</span>);
01642 
01643     <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r34">m_curDC</a>)
01644     {           
01645         <a class="code" href="classwx_term.html#r34">m_curDC</a> = dc;
01646     }
01647     
01648     dc-&gt;SetFont(<a class="code" href="classwx_term.html#r30">m_normalFont</a>);
01649     dc-&gt;GetTextExtent(<span class="stringliteral">"M"</span>, &amp;charWidth, &amp;charHeight);
01650     wxSize currentClientSize = GetClientSize();
01651     <span class="keywordtype">int</span> numCharsInLine = currentClientSize.GetX() / charWidth;
01652     <span class="keywordtype">int</span> numLinesShown = currentClientSize.GetY() / charHeight;
01653 
01654     
01655 
01656     <span class="keywordflow">if</span>( (numCharsInLine != <a class="code" href="classwx_term.html#r17">m_charsInLine</a>) || (numLinesShown != <a class="code" href="classwx_term.html#r18">m_linesDisplayed</a>))
01657     {
01658         wxString message;
01659 
01660         <span class="comment">// FINALLY!  Finally killed the memory leak!  The problem is that somehow a size event</span>
01661         <span class="comment">// was generating negative numbers for these values, which led to weird things happening.</span>
01662         <span class="keywordflow">if</span>( (numCharsInLine &gt; 0) &amp;&amp; (numLinesShown &gt; 0))
01663         {
01664             <a class="code" href="classwx_term.html#r17">m_charsInLine</a> = numCharsInLine;
01665             <a class="code" href="classwx_term.html#r18">m_linesDisplayed</a> = numLinesShown;
01666             <span class="comment">// tell the GTerm core to resize itself</span>
01667             <a class="code" href="classwx_term.html#a25">ResizeTerminal</a>(numCharsInLine, numLinesShown);  
01668         }
01669     }
01670 
01671     <a class="code" href="classwx_term.html#r22">m_inUpdateSize</a> = <span class="keyword">false</span>;
01672 
01673     <span class="keywordflow">if</span>(dc)
01674     {
01675         <span class="keyword">delete</span> dc;
01676         <a class="code" href="classwx_term.html#r34">m_curDC</a> = 0;
01677     }
01678 }
01679 
01691 <span class="keywordtype">void</span>
<a name="l01692"></a><a class="code" href="classwx_term.html#a25">01692</a> <a class="code" href="classwx_term.html#a25">wxTerm::ResizeTerminal</a>(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height)
01693 {
01694   <span class="keywordtype">int</span>
01695     w,
01696     h;
01697 
01698   <a class="code" href="classwx_term.html#a14">ClearSelection</a>();
01699 
01700   <span class="comment">/*</span>
01701 <span class="comment">  **  Determine window size from current font</span>
01702 <span class="comment">  */</span>
01703   wxClientDC
01704     dc(<span class="keyword">this</span>);
01705 
01706   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r40">m_boldStyle</a> != <a class="code" href="classwx_term.html#w4w3">FONT</a>)
01707     dc.SetFont(<a class="code" href="classwx_term.html#r30">m_normalFont</a>);
01708   <span class="keywordflow">else</span>
01709     dc.SetFont(<a class="code" href="classwx_term.html#r32">m_boldFont</a>);
01710   dc.GetTextExtent(<span class="stringliteral">"M"</span>, &amp;<a class="code" href="classwx_term.html#r0">m_charWidth</a>, &amp;<a class="code" href="classwx_term.html#r1">m_charHeight</a>);
01711   w = width * <a class="code" href="classwx_term.html#r0">m_charWidth</a>;
01712   h = height * <a class="code" href="classwx_term.html#r1">m_charHeight</a>;
01713 
01714   <span class="comment">/*</span>
01715 <span class="comment">  **  Create our bitmap for copying</span>
01716 <span class="comment">  */</span>
01717   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r36">m_bitmap</a>)
01718   {
01719     <a class="code" href="classwx_term.html#r35">m_memDC</a>.SelectObject(wxNullBitmap);
01720     <span class="keyword">delete</span> <a class="code" href="classwx_term.html#r36">m_bitmap</a>;
01721   }
01722   <a class="code" href="classwx_term.html#r36">m_bitmap</a> = <span class="keyword">new</span> wxBitmap(w, h);
01723   <a class="code" href="classwx_term.html#r35">m_memDC</a>.SelectObject(*<a class="code" href="classwx_term.html#r36">m_bitmap</a>);
01724 
01725   <span class="comment">/*</span>
01726 <span class="comment">  **  Set window size</span>
01727 <span class="comment">  */</span>
01728 <span class="preprocessor">#if defined(__WXGTK__) || defined(__WXMOTIF__)</span>
01729 <span class="preprocessor"></span>  SetSize(w, h + 4);
01730 <span class="preprocessor">#else</span>
01731 <span class="preprocessor"></span>  SetSize(w, h);
01732 <span class="preprocessor">#endif</span>
01733 <span class="preprocessor"></span>
01734   <span class="comment">/*</span>
01735 <span class="comment">  **  Set terminal size</span>
01736 <span class="comment">  */</span>
01737   <a class="code" href="class_g_term.html#a4">GTerm::ResizeTerminal</a>(width, height);
01738   <a class="code" href="classwx_term.html#r3">m_width</a> = width;
01739   <a class="code" href="classwx_term.html#r4">m_height</a> = height;
01740 
01741   <span class="comment">/*</span>
01742 <span class="comment">  **  Send event</span>
01743 <span class="comment">  */</span>
01744   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r2">m_init</a>)
01745   {
01746     wxCommandEvent e(<a class="code" href="wxterm_8h.html#a0">wxEVT_COMMAND_TERM_RESIZE</a>, GetId());
01747     e.SetEventObject(<span class="keyword">this</span>);
01748     GetParent()-&gt;GetEventHandler()-&gt;ProcessEvent(e);
01749   }
01750 }
01751 
01763 <span class="keywordtype">void</span>
<a name="l01764"></a><a class="code" href="classwx_term.html#a26">01764</a> <a class="code" href="classwx_term.html#a26">wxTerm::RequestSizeChange</a>(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h)
01765 {
01766   <a class="code" href="classwx_term.html#a25">ResizeTerminal</a>(w, h);
01767 }
01768 
01780 <span class="keywordtype">void</span>
<a name="l01781"></a><a class="code" href="classwx_term.html#a27">01781</a> <a class="code" href="classwx_term.html#a27">wxTerm::ProcessInput</a>(<span class="keywordtype">int</span> len, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data)
01782 {
01783   wxClientDC
01784     dc(<span class="keyword">this</span>);
01785 
01786   <a class="code" href="classwx_term.html#a14">ClearSelection</a>();
01787   <a class="code" href="classwx_term.html#r34">m_curDC</a> = &amp;dc;
01788   <a class="code" href="class_g_term.html#a2">GTerm::ProcessInput</a>(len, data);
01789   <a class="code" href="classwx_term.html#r34">m_curDC</a> = 0;
01790 }
01791 
01802 <span class="keywordtype">int</span>
<a name="l01803"></a><a class="code" href="classwx_term.html#d0">01803</a> <a class="code" href="classwx_term.html#d0">wxTerm::MapKeyCode</a>(<span class="keywordtype">int</span> keyCode)
01804 {
01805   <span class="keywordtype">int</span>
01806     i;
01807 
01808   <span class="keywordflow">for</span>(i = 0; <a class="code" href="classwx_term.html#v0">keyMapTable</a>[i].<a class="code" href="structwx_term_1_1_term_key_map.html#o0">keyCode</a>; i++)
01809     <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#v0">keyMapTable</a>[i].<a class="code" href="structwx_term_1_1_term_key_map.html#o0">keyCode</a> == keyCode)
01810       <span class="keywordflow">return</span> <a class="code" href="classwx_term.html#v0">keyMapTable</a>[i].<a class="code" href="structwx_term_1_1_term_key_map.html#o1">VTKeyCode</a>;
01811   <span class="keywordflow">return</span> 0;
01812 }
01813 
01824 <span class="keywordtype">void</span>
<a name="l01825"></a><a class="code" href="classwx_term.html#a28">01825</a> <a class="code" href="classwx_term.html#a28">wxTerm::SelectPrinter</a>(<span class="keywordtype">char</span> *PrinterName)
01826 {
01827   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r37">m_printerFN</a>)
01828   {
01829     <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r38">m_printerName</a>[0] == <span class="charliteral">'#'</span>)
01830       fclose(<a class="code" href="classwx_term.html#r37">m_printerFN</a>);
01831     <span class="keywordflow">else</span>
01832 <span class="preprocessor">#if defined(__WXGTK__) || defined(__WXMOTIF__)</span>
01833 <span class="preprocessor"></span>      pclose(<a class="code" href="classwx_term.html#r37">m_printerFN</a>);
01834 <span class="preprocessor">#endif</span>
01835 <span class="preprocessor"></span><span class="preprocessor">#if defined(__WXMSW__)</span>
01836 <span class="preprocessor"></span>      fclose(<a class="code" href="classwx_term.html#r37">m_printerFN</a>);
01837 <span class="preprocessor">#endif</span>
01838 <span class="preprocessor"></span>
01839     <a class="code" href="classwx_term.html#r37">m_printerFN</a> = 0;
01840   }
01841 
01842   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r38">m_printerName</a>)
01843   {
01844     free(<a class="code" href="classwx_term.html#r38">m_printerName</a>);
01845     <a class="code" href="classwx_term.html#r38">m_printerName</a> = 0;
01846   }
01847 
01848   <span class="keywordflow">if</span>(strlen(PrinterName))
01849   {
01850     <a class="code" href="classwx_term.html#r38">m_printerName</a> = strdup(PrinterName);
01851   }
01852 }
01853 
01865 <span class="keywordtype">void</span>
<a name="l01866"></a><a class="code" href="classwx_term.html#a29">01866</a> <a class="code" href="classwx_term.html#a29">wxTerm::PrintChars</a>(<span class="keywordtype">int</span> len, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data)
01867 {
01868   <span class="keywordtype">char</span>
01869     pname[100];
01870 
01871   <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r37">m_printerFN</a>)
01872   {
01873     <span class="keywordflow">if</span>(!<a class="code" href="classwx_term.html#r38">m_printerName</a>)
01874       <span class="keywordflow">return</span>;
01875 
01876     <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r38">m_printerName</a>[0] == <span class="charliteral">'#'</span>)
01877     {
01878 <span class="preprocessor">#if defined(__WXGTK__) || defined(__WXMOTIF__)</span>
01879 <span class="preprocessor"></span>      sprintf(pname, <span class="stringliteral">"/dev/lp%d"</span>, <a class="code" href="classwx_term.html#r38">m_printerName</a>[1] - <span class="charliteral">'0'</span>);
01880 <span class="preprocessor">#endif</span>
01881 <span class="preprocessor"></span><span class="preprocessor">#if defined(__WXMSW__)</span>
01882 <span class="preprocessor"></span>      sprintf(pname, <span class="stringliteral">"lpt%d"</span>, <a class="code" href="classwx_term.html#r38">m_printerName</a>[1] - <span class="charliteral">'0'</span> + 1);
01883 <span class="preprocessor">#endif</span>
01884 <span class="preprocessor"></span>      <a class="code" href="classwx_term.html#r37">m_printerFN</a> = fopen(pname, <span class="stringliteral">"wb"</span>);
01885     }
01886     <span class="keywordflow">else</span>
01887     {
01888 <span class="preprocessor">#if defined(__WXGTK__) || defined(__WXMOTIF__)</span>
01889 <span class="preprocessor"></span>      sprintf(pname, <span class="stringliteral">"lpr -P%s"</span>, <a class="code" href="classwx_term.html#r38">m_printerName</a>);
01890       <a class="code" href="classwx_term.html#r37">m_printerFN</a> = popen(pname, <span class="stringliteral">"w"</span>);
01891 <span class="preprocessor">#endif</span>
01892 <span class="preprocessor"></span><span class="preprocessor">#if defined(__WXMSW__)</span>
01893 <span class="preprocessor"></span>      <a class="code" href="classwx_term.html#r37">m_printerFN</a> = fopen(<a class="code" href="classwx_term.html#r38">m_printerName</a>, <span class="stringliteral">"wb"</span>);
01894 <span class="preprocessor">#endif</span>
01895 <span class="preprocessor"></span>    }
01896   }
01897   
01898   <span class="keywordflow">if</span>(<a class="code" href="classwx_term.html#r37">m_printerFN</a>)
01899   {
01900     fwrite(data, len, 1, <a class="code" href="classwx_term.html#r37">m_printerFN</a>);
01901   }
01902 }
01903 
<a name="l01914"></a><a class="code" href="classwx_term.html#d10">01914</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term.html#d10">wxTerm::OnActivate</a>(wxActivateEvent &amp;event)
01915 {
01916     <a class="code" href="classwx_term.html#r23">m_isActive</a> = event.GetActive();
01917 }
01918 
<a name="l01929"></a><a class="code" href="classwx_term.html#d12">01929</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term.html#d12">wxTerm::OnGainFocus</a>(wxFocusEvent &amp;event)
01930 {
01931     this-&gt;<a class="code" href="class_g_term.html#a22">clear_mode_flag</a>(CURSORINVISIBLE);
01932     <span class="comment">//wxLogDebug("Gained focus");</span>
01933     <a class="code" href="class_g_term.html#a8">GTerm::Update</a>();
01934 }
01935 
<a name="l01946"></a><a class="code" href="classwx_term.html#d13">01946</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term.html#d13">wxTerm::OnLoseFocus</a>(wxFocusEvent &amp;event)
01947 {
01948     this-&gt;<a class="code" href="class_g_term.html#a21">set_mode_flag</a>(CURSORINVISIBLE);
01949     <span class="comment">//wxLogDebug("Lost focus");</span>
01950     <a class="code" href="class_g_term.html#a8">GTerm::Update</a>();
01951 }
01952 
<a name="l01964"></a><a class="code" href="classwx_term.html#a13">01964</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term.html#a13">wxTerm::ScrollTerminal</a>(<span class="keywordtype">int</span> numLines, <span class="keywordtype">bool</span> scrollUp <span class="comment">/* = true */</span>)
01965 {
01966     <a class="code" href="class_g_term.html#a11">GTerm::Scroll</a>(numLines, scrollUp);
01967     Refresh();
01968 
01969 }
01970 
<a name="l01981"></a><a class="code" href="classwx_term.html#d11">01981</a> <span class="keywordtype">void</span> <a class="code" href="classwx_term.html#d11">wxTerm::OnSize</a>(wxSizeEvent &amp;event)
01982 {
01983     <a class="code" href="classwx_term.html#a18">UpdateSize</a>();
01984 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 28 16:45:39 2004 for Chameleon by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
